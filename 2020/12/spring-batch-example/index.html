<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>Simple Spring Batch with Quartz Scheduling | PiinAlpin</title><meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="robots" content="noodp" />
<meta name="Description" content="How to create spring batch with quartz scheduling and MySQL database from scratch.">
<link rel="prev" href="https://blog.piinalpin.com/2020/12/create-sequence-like-oracle-in-mysql/" />
<link rel="next" href="https://blog.piinalpin.com/2020/12/sql-generator/" />
<link rel="canonical" href="https://blog.piinalpin.com/2020/12/spring-batch-example/" />
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Simple Spring Batch with Quartz Scheduling"/>
<meta name="twitter:description" content="How to create spring batch with quartz scheduling and MySQL database from scratch."/>
<script type="application/ld+json">
    {
    "@context": "http://schema.org",
    "@type": "BlogPosting",
    "headline": "Simple Spring Batch with Quartz Scheduling",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "https:\/\/blog.piinalpin.com\/2020\/12\/spring-batch-example\/"
    },
    
        "image": {
            "@type": "ImageObject",
            "url": "https:\/\/blog.piinalpin.com\/cover.png",
            "width":  800 ,
            "height":  600 
        },
    
    "genre": "posts",
    
        "keywords": "Java, Spring Batch, Spring Boot, MySQL",
    
    "wordcount":  1999 ,
    "url": "https:\/\/blog.piinalpin.com\/2020\/12\/spring-batch-example\/",
    
        "datePublished": "2020-12-08T14:08:21\x2b07:00",
    
    
        "dateModified": "2020-12-08T14:08:21\x2b07:00",
    
    
        "license": "This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.",
    
    
        "publisher": {
            "@type": "Organization",
            "name": "Alvinditya Saputra",
            "logo": {
            "@type": "ImageObject",
            "url": "https:\/\/blog.piinalpin.com\/logo.png",
            "width":  127 ,
            "height":  40 
            }
        },
    
    
    "description": "How to create spring batch with quartz scheduling and MySQL database from scratch."
    }
    </script>
<link rel="stylesheet" href="/css/style.min.css">
<link rel="stylesheet" href="/css/lib/fontawesome-free/all.min.min.css">

<link rel="stylesheet" href="/css/lib/animate/animate.min.min.css">


<script>
  if('serviceWorker' in navigator) {
      navigator.serviceWorker
          .register('/service-worker.js', { scope: '/' })
          .then(function(registration) {
              
          });

      navigator.serviceWorker
          .ready
          .then(function(registration) {
              
          });
  }
</script>
    </head>
    <body>
        <script>
            window.localStorage.getItem('theme') === 'dark';
            document.body.classList.add('dark-theme');
        </script>
        <div class="wrapper">
            <nav class="navbar">
    <div class="navbar-container">
        <div class="navbar-header animated bounceIn">
            <a href="https://blog.piinalpin.com/">PiinAlpin</a>
        </div>
        <div class="navbar-menu">
            
            
                <a class="menu-item" href="https://blog.piinalpin.com/posts" title="">Posts</a>
            
                <a class="menu-item" href="https://blog.piinalpin.com/tags" title="">Tags</a>
            
                <a class="menu-item" href="https://blog.piinalpin.com/categories" title="">Categories</a>
            
                <a class="menu-item" href="https://blog.piinalpin.com/about" title="">About</a>
            
        </div>
    </div>
</nav>
<nav class="navbar-mobile">
     <div class="navbar-container">
        <div class="navbar-header">
            <div class="navbar-header-title animated bounceIn">
                <a href="https://blog.piinalpin.com/">PiinAlpin</a>
            </div>
            <div class="menu-toggle" id="menu-toggle">
                <span></span><span></span><span></span>
            </div>
        </div>
    </div>
</nav><main class="main">
                <div class="container">
                    
    
    
    

    <article class="post-warp">
        <h1 class="post-title animated flipInX">Simple Spring Batch with Quartz Scheduling</h1>

        <div class="post-meta">
            <div class="post-meta-main">
                <a class="author" href="https://blog.piinalpin.com/" rel="author"><i class="fas fa-user-circle fa-fw"></i>piinalpin&nbsp;</a>
                <span class="post-category">
                        included in
                        <i class="far fa-folder fa-fw"></i><a href="https://blog.piinalpin.com/categories/documentation/">Documentation</a>
                            
                    </span>
            </div>
            <div class="post-meta-other">
                <i class="far fa-calendar-alt fa-fw"></i><time datetime=2020-12-08>2020-12-08</time>&nbsp;
                <i class="fas fa-pencil-alt fa-fw"></i>about 1999 words&nbsp;
                <i class="far fa-clock fa-fw"></i>10 min&nbsp;</div>
        </div>

        

        <div class="post-toc" id="post-toc">
                <h2 class="post-toc-title">Table of Contents</h2>
                <div class="post-toc-content">
                    <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#prerequisites">Prerequisites</a></li>
        <li><a href="#what-is-spring-batch">What is Spring Batch?</a></li>
        <li><a href="#step-to-create-spring-batch">Step to create spring batch</a></li>
      </ul>
    </li>
    <li><a href="#clone-or-download">Clone or Download</a>
      <ul>
        <li><a href="#thankyou">Thankyou</a></li>
      </ul>
    </li>
  </ul>
</nav>
                </div>
            </div>
            <div class="post-toc-mobile" id="post-toc-mobile">
                <details>
                    <summary><div class="post-toc-title"><span>Table of Contents</span><span><i class="details icon fas fa-angle-down"></i></span></div></summary>
                    <div class="post-toc-content">
                        
                        
                        <nav id="TableOfContentsMobile">
  <ul>
    <li>
      <ul>
        <li><a href="#prerequisites">Prerequisites</a></li>
        <li><a href="#what-is-spring-batch">What is Spring Batch?</a></li>
        <li><a href="#step-to-create-spring-batch">Step to create spring batch</a></li>
      </ul>
    </li>
    <li><a href="#clone-or-download">Clone or Download</a>
      <ul>
        <li><a href="#thankyou">Thankyou</a></li>
      </ul>
    </li>
  </ul>
</nav>
                    </div>
                </details>
            </div>

        <div class="post-content">
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            <a class="post-dummy-target" id="prerequisites"></a><h3>Prerequisites</h3>
<ul>
<li><a href="https://www.mysql.com/">MySQL Database</a></li>
<li><a href="https://start.spring.io/">Spring Initializr</a></li>
<li><a href="https://mvnrepository.com/artifact/org.springframework.boot/spring-boot-starter-batch/2.4.0">Spring Boot Starter Batch</a></li>
<li><a href="https://mvnrepository.com/artifact/org.springframework.boot/spring-boot-starter-quartz/2.4.0">Spring Boot Starter Quartz</a></li>
<li><a href="https://mvnrepository.com/artifact/mysql/mysql-connector-java/8.0.22">MySQL-Connector</a></li>
<li><a href="https://mvnrepository.com/artifact/org.projectlombok/lombok/1.18.16">Lombok Annotation</a></li>
</ul>
<a class="post-dummy-target" id="what-is-spring-batch"></a><h3>What is Spring Batch?</h3>
<p><img src="/images/spring-batch-reference-model.png" alt="Spring batch reference model"></p>
<p>Spring Batch is a lightweight, comprehensive batch framework designed to enable the development of robust batch applications vital for the daily operations of enterprise systems. Spring Batch builds upon the characteristics of the Spring Framework that people have come to expect (productivity, POJO-based development approach, and general ease of use), while making it easy for developers to access and leverage more advance enterprise services when necessary. Spring Batch is not a scheduling framework. There are many good enterprise schedulers (such as Quartz, Tivoli, Control-M, etc.) available in both the commercial and open source spaces. It is intended to work in conjunction with a scheduler, not replace a scheduler.</p>
<a class="post-dummy-target" id="step-to-create-spring-batch"></a><h3>Step to create spring batch</h3>
<ol>
<li>Create business data</li>
</ol>
<p>Typically, your customer or a business analyst supplies a spreadsheet. For this simple example, you can find some made-up data in <code>src/main/resources/sample-data.csv</code>:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-html" data-lang="html">Maverick,24,M
Al Sah-Him,21,M
Felicia,24,F
Jessica,22,F
Calvin Joe,25,M
</code></pre></td></tr></table>
</div>
</div><p>Next, write an SQL script to create a table and store data.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-sql" data-lang="sql"><span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">M_HUMAN</span>
<span class="p">(</span>
    <span class="n">id</span>         <span class="nb">bigint</span> <span class="n">auto_increment</span> <span class="k">primary</span> <span class="k">key</span><span class="p">,</span>
    <span class="n">created_at</span> <span class="k">timestamp</span> <span class="k">default</span> <span class="k">CURRENT_TIMESTAMP</span> <span class="k">not</span> <span class="k">null</span><span class="p">,</span>
    <span class="n">updated_at</span> <span class="k">timestamp</span>                           <span class="k">null</span> <span class="k">on</span> <span class="k">update</span> <span class="k">CURRENT_TIMESTAMP</span><span class="p">,</span>
    <span class="n">deleted_at</span> <span class="k">timestamp</span>                           <span class="k">null</span><span class="p">,</span>
    <span class="n">name</span>       <span class="nb">varchar</span><span class="p">(</span><span class="mi">255</span><span class="p">)</span>                        <span class="k">not</span> <span class="k">null</span><span class="p">,</span>
    <span class="n">age</span>        <span class="nb">varchar</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>                          <span class="k">not</span> <span class="k">null</span><span class="p">,</span>
    <span class="n">gender</span>     <span class="nb">varchar</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>                          <span class="k">not</span> <span class="k">null</span>
<span class="p">)</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><ol start="2">
<li>Starting with spring initializr</li>
</ol>
<p>For all Spring applications, you should start with the <a href="https://start.spring.io/">Spring Initializr</a>. The Initializr offers a fast way to pull in all the dependencies you need for an application and does a lot of the set up for you. This example needs the Spring Batch. And we will started with maven project.</p>
<p>The following listing shows the <code>pom.xml</code> file created when you choose Maven:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
<span class="nt">&lt;project</span> <span class="na">xmlns=</span><span class="s">&#34;http://maven.apache.org/POM/4.0.0&#34;</span> <span class="na">xmlns:xsi=</span><span class="s">&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span>
	<span class="na">xsi:schemaLocation=</span><span class="s">&#34;http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd&#34;</span><span class="nt">&gt;</span>
	<span class="nt">&lt;modelVersion</span><span class="nt">&gt;</span>4.0.0<span class="nt">&lt;/modelVersion&gt;</span>
	<span class="nt">&lt;parent</span><span class="nt">&gt;</span>
		<span class="nt">&lt;groupId</span><span class="nt">&gt;</span>org.springframework.boot<span class="nt">&lt;/groupId&gt;</span>
		<span class="nt">&lt;artifactId</span><span class="nt">&gt;</span>spring-boot-starter-parent<span class="nt">&lt;/artifactId&gt;</span>
		<span class="nt">&lt;version</span><span class="nt">&gt;</span>2.4.0<span class="nt">&lt;/version&gt;</span>
		<span class="nt">&lt;relativePath</span><span class="nt">/&gt;</span> <span class="c">&lt;!--</span><span class="c"> lookup parent from repository </span><span class="c">--&gt;</span>
	<span class="nt">&lt;/parent&gt;</span>
	<span class="nt">&lt;groupId</span><span class="nt">&gt;</span>com.maverick<span class="nt">&lt;/groupId&gt;</span>
	<span class="nt">&lt;artifactId</span><span class="nt">&gt;</span>spring-batch-example<span class="nt">&lt;/artifactId&gt;</span>
	<span class="nt">&lt;version</span><span class="nt">&gt;</span>0.0.1-SNAPSHOT<span class="nt">&lt;/version&gt;</span>
	<span class="nt">&lt;name</span><span class="nt">&gt;</span>spring-batch-example<span class="nt">&lt;/name&gt;</span>
	<span class="nt">&lt;description</span><span class="nt">&gt;</span>Demo project for Spring Boot<span class="nt">&lt;/description&gt;</span>

	<span class="nt">&lt;properties</span><span class="nt">&gt;</span>
		<span class="nt">&lt;java.version</span><span class="nt">&gt;</span>11<span class="nt">&lt;/java.version&gt;</span>
	<span class="nt">&lt;/properties&gt;</span>

	<span class="nt">&lt;dependencies</span><span class="nt">&gt;</span>
		<span class="nt">&lt;dependency</span><span class="nt">&gt;</span>
			<span class="nt">&lt;groupId</span><span class="nt">&gt;</span>org.springframework.boot<span class="nt">&lt;/groupId&gt;</span>
			<span class="nt">&lt;artifactId</span><span class="nt">&gt;</span>spring-boot-starter-batch<span class="nt">&lt;/artifactId&gt;</span>
		<span class="nt">&lt;/dependency&gt;</span>

		<span class="nt">&lt;dependency</span><span class="nt">&gt;</span>
			<span class="nt">&lt;groupId</span><span class="nt">&gt;</span>org.springframework.boot<span class="nt">&lt;/groupId&gt;</span>
			<span class="nt">&lt;artifactId</span><span class="nt">&gt;</span>spring-boot-starter-test<span class="nt">&lt;/artifactId&gt;</span>
			<span class="nt">&lt;scope</span><span class="nt">&gt;</span>test<span class="nt">&lt;/scope&gt;</span>
		<span class="nt">&lt;/dependency&gt;</span>
		<span class="nt">&lt;dependency</span><span class="nt">&gt;</span>
			<span class="nt">&lt;groupId</span><span class="nt">&gt;</span>org.springframework.batch<span class="nt">&lt;/groupId&gt;</span>
			<span class="nt">&lt;artifactId</span><span class="nt">&gt;</span>spring-batch-test<span class="nt">&lt;/artifactId&gt;</span>
			<span class="nt">&lt;scope</span><span class="nt">&gt;</span>test<span class="nt">&lt;/scope&gt;</span>
		<span class="nt">&lt;/dependency&gt;</span>
		<span class="c">&lt;!--</span><span class="c"> https://mvnrepository.com/artifact/mysql/mysql</span><span class="c">-</span><span class="c">connector</span><span class="c">-</span><span class="c">java </span><span class="c">--&gt;</span>
		<span class="nt">&lt;dependency</span><span class="nt">&gt;</span>
			<span class="nt">&lt;groupId</span><span class="nt">&gt;</span>mysql<span class="nt">&lt;/groupId&gt;</span>
			<span class="nt">&lt;artifactId</span><span class="nt">&gt;</span>mysql-connector-java<span class="nt">&lt;/artifactId&gt;</span>
			<span class="nt">&lt;version</span><span class="nt">&gt;</span>8.0.22<span class="nt">&lt;/version&gt;</span>
		<span class="nt">&lt;/dependency&gt;</span>

		<span class="c">&lt;!--</span><span class="c"> https://mvnrepository.com/artifact/org.projectlombok/lombok </span><span class="c">--&gt;</span>
		<span class="nt">&lt;dependency</span><span class="nt">&gt;</span>
			<span class="nt">&lt;groupId</span><span class="nt">&gt;</span>org.projectlombok<span class="nt">&lt;/groupId&gt;</span>
			<span class="nt">&lt;artifactId</span><span class="nt">&gt;</span>lombok<span class="nt">&lt;/artifactId&gt;</span>
			<span class="nt">&lt;version</span><span class="nt">&gt;</span>1.18.16<span class="nt">&lt;/version&gt;</span>
			<span class="nt">&lt;scope</span><span class="nt">&gt;</span>provided<span class="nt">&lt;/scope&gt;</span>
		<span class="nt">&lt;/dependency&gt;</span>
		<span class="nt">&lt;dependency</span><span class="nt">&gt;</span>
			<span class="nt">&lt;groupId</span><span class="nt">&gt;</span>org.springframework.boot<span class="nt">&lt;/groupId&gt;</span>
			<span class="nt">&lt;artifactId</span><span class="nt">&gt;</span>spring-boot-starter-quartz<span class="nt">&lt;/artifactId&gt;</span>
		<span class="nt">&lt;/dependency&gt;</span>

	<span class="nt">&lt;/dependencies&gt;</span>

	<span class="nt">&lt;build</span><span class="nt">&gt;</span>
		<span class="nt">&lt;plugins</span><span class="nt">&gt;</span>
			<span class="nt">&lt;plugin</span><span class="nt">&gt;</span>
				<span class="nt">&lt;groupId</span><span class="nt">&gt;</span>org.springframework.boot<span class="nt">&lt;/groupId&gt;</span>
				<span class="nt">&lt;artifactId</span><span class="nt">&gt;</span>spring-boot-maven-plugin<span class="nt">&lt;/artifactId&gt;</span>
			<span class="nt">&lt;/plugin&gt;</span>
		<span class="nt">&lt;/plugins&gt;</span>
	<span class="nt">&lt;/build&gt;</span>

<span class="nt">&lt;/project&gt;</span>

</code></pre></td></tr></table>
</div>
</div><ol start="3">
<li>Create a model class as the following example <code>src/main/java/com/maverick/springbatchexample/model/Person.java</code></li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">com.maverick.springbatchexample.model</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">lombok.AllArgsConstructor</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">lombok.Builder</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">lombok.Data</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">lombok.NoArgsConstructor</span><span class="o">;</span>

<span class="nd">@Data</span>
<span class="nd">@AllArgsConstructor</span>
<span class="nd">@NoArgsConstructor</span>
<span class="nd">@Builder</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Person</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="n">String</span> <span class="n">name</span><span class="o">;</span>

    <span class="kd">private</span> <span class="n">String</span> <span class="n">age</span><span class="o">;</span>

    <span class="kd">private</span> <span class="n">String</span> <span class="n">gender</span><span class="o">;</span>

<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><ol start="4">
<li>Create an intermediate processor as the following example <code>src/main/java/com/maverick/springbatchexample/processor/PersonItemProcessor.java</code></li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">com.maverick.springbatchexample.processor</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">com.maverick.springbatchexample.model.Person</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.slf4j.Logger</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.slf4j.LoggerFactory</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.batch.item.ItemProcessor</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">PersonItemProcessor</span> <span class="kd">implements</span> <span class="n">ItemProcessor</span><span class="o">&lt;</span><span class="n">Person</span><span class="o">,</span> <span class="n">Person</span><span class="o">&gt;</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">Logger</span> <span class="n">LOG</span> <span class="o">=</span> <span class="n">LoggerFactory</span><span class="o">.</span><span class="na">getLogger</span><span class="o">(</span><span class="n">PersonItemProcessor</span><span class="o">.</span><span class="na">class</span><span class="o">)</span><span class="o">;</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">Person</span> <span class="nf">process</span><span class="o">(</span><span class="n">Person</span> <span class="n">person</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">Exception</span> <span class="o">{</span>
        <span class="n">LOG</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">&#34;### Process: &#34;</span> <span class="o">+</span> <span class="n">person</span><span class="o">.</span><span class="na">getName</span><span class="o">(</span><span class="o">)</span><span class="o">)</span><span class="o">;</span>
        <span class="k">return</span> <span class="n">person</span><span class="o">;</span>
    <span class="o">}</span>

<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><ol start="5">
<li>Create datasource configuration as the following example <code>src/main/java/com/maverick/springbatchexample/configuration/DataSourceConfiguration.java</code></li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">com.maverick.springbatchexample.configuration</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.springframework.beans.factory.annotation.Qualifier</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.beans.factory.annotation.Value</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.boot.jdbc.DataSourceBuilder</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.context.annotation.Bean</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.context.annotation.Configuration</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.context.annotation.Primary</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.jdbc.core.JdbcTemplate</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">javax.sql.DataSource</span><span class="o">;</span>

<span class="nd">@Configuration</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">DataSourceConfiguration</span> <span class="o">{</span>

    <span class="nd">@Value</span><span class="o">(</span><span class="s">&#34;${spring.datasource.url}&#34;</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">datasourceUrl</span><span class="o">;</span>

    <span class="nd">@Value</span><span class="o">(</span><span class="s">&#34;${spring.datasource.username}&#34;</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">datasourceUsername</span><span class="o">;</span>

    <span class="nd">@Value</span><span class="o">(</span><span class="s">&#34;${spring.datasource.password}&#34;</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">datasourcePassword</span><span class="o">;</span>

    <span class="nd">@Value</span><span class="o">(</span><span class="s">&#34;${spring.datasource.driverClassName}&#34;</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">datasourceDriverClassName</span><span class="o">;</span>

    <span class="nd">@Bean</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">&#34;MVRCKDatasource&#34;</span><span class="o">)</span>
    <span class="nd">@Primary</span>
    <span class="kd">public</span> <span class="n">DataSource</span> <span class="nf">dataSource</span><span class="o">(</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">DataSourceBuilder</span><span class="o">.</span><span class="na">create</span><span class="o">(</span><span class="o">)</span>
                <span class="o">.</span><span class="na">url</span><span class="o">(</span><span class="n">datasourceUrl</span><span class="o">)</span>
                <span class="o">.</span><span class="na">username</span><span class="o">(</span><span class="n">datasourceUsername</span><span class="o">)</span>
                <span class="o">.</span><span class="na">password</span><span class="o">(</span><span class="n">datasourcePassword</span><span class="o">)</span>
                <span class="o">.</span><span class="na">driverClassName</span><span class="o">(</span><span class="n">datasourceDriverClassName</span><span class="o">)</span>
                <span class="o">.</span><span class="na">build</span><span class="o">(</span><span class="o">)</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@Bean</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">&#34;MVRCKJdbcTemplate&#34;</span><span class="o">)</span>
    <span class="kd">public</span> <span class="n">JdbcTemplate</span> <span class="nf">jdbcTemplate</span><span class="o">(</span><span class="nd">@Qualifier</span><span class="o">(</span><span class="s">&#34;MVRCKDatasource&#34;</span><span class="o">)</span> <span class="n">DataSource</span> <span class="n">dataSource</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="n">JdbcTemplate</span><span class="o">(</span><span class="n">dataSource</span><span class="o">)</span><span class="o">;</span>
    <span class="o">}</span>

<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><ol start="6">
<li>Create quartz job launcher as the following example <code>src/main/java/com/maverick/springbatchexample/quartz/QuartzJobLauncher.java</code></li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">com.maverick.springbatchexample.quartz</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.quartz.JobExecutionContext</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.quartz.JobExecutionException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.slf4j.Logger</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.slf4j.LoggerFactory</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.batch.core.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.batch.core.configuration.JobLocator</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.batch.core.launch.JobLauncher</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.batch.core.launch.NoSuchJobException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.batch.core.repository.JobExecutionAlreadyRunningException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.batch.core.repository.JobInstanceAlreadyCompleteException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.batch.core.repository.JobRestartException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.scheduling.quartz.QuartzJobBean</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">QuartzJobLauncher</span> <span class="kd">extends</span> <span class="n">QuartzJobBean</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">Logger</span> <span class="n">LOG</span> <span class="o">=</span> <span class="n">LoggerFactory</span><span class="o">.</span><span class="na">getLogger</span><span class="o">(</span><span class="n">QuartzJobLauncher</span><span class="o">.</span><span class="na">class</span><span class="o">)</span><span class="o">;</span>

    <span class="kd">private</span> <span class="n">String</span> <span class="n">jobName</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">JobLauncher</span> <span class="n">jobLauncher</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">JobLocator</span> <span class="n">jobLocator</span><span class="o">;</span>

    <span class="kd">public</span> <span class="n">String</span> <span class="nf">getJobName</span><span class="o">(</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">jobName</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setJobName</span><span class="o">(</span><span class="n">String</span> <span class="n">jobName</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">jobName</span> <span class="o">=</span> <span class="n">jobName</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="n">JobLauncher</span> <span class="nf">getJobLauncher</span><span class="o">(</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">jobLauncher</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setJobLauncher</span><span class="o">(</span><span class="n">JobLauncher</span> <span class="n">jobLauncher</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">jobLauncher</span> <span class="o">=</span> <span class="n">jobLauncher</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="n">JobLocator</span> <span class="nf">getJobLocator</span><span class="o">(</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">jobLocator</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setJobLocator</span><span class="o">(</span><span class="n">JobLocator</span> <span class="n">jobLocator</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">jobLocator</span> <span class="o">=</span> <span class="n">jobLocator</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">executeInternal</span><span class="o">(</span><span class="n">JobExecutionContext</span> <span class="n">jobExecutionContext</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">JobExecutionException</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="n">Job</span> <span class="n">job</span> <span class="o">=</span> <span class="n">jobLocator</span><span class="o">.</span><span class="na">getJob</span><span class="o">(</span><span class="n">jobName</span><span class="o">)</span><span class="o">;</span>
            <span class="n">JobParameters</span> <span class="n">jobParameters</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JobParametersBuilder</span><span class="o">(</span><span class="o">)</span>
                    <span class="o">.</span><span class="na">addLong</span><span class="o">(</span><span class="s">&#34;time&#34;</span><span class="o">,</span><span class="n">System</span><span class="o">.</span><span class="na">currentTimeMillis</span><span class="o">(</span><span class="o">)</span><span class="o">)</span>
                    <span class="o">.</span><span class="na">toJobParameters</span><span class="o">(</span><span class="o">)</span><span class="o">;</span>
            <span class="n">JobExecution</span> <span class="n">jobExecution</span> <span class="o">=</span> <span class="n">jobLauncher</span><span class="o">.</span><span class="na">run</span><span class="o">(</span><span class="n">job</span><span class="o">,</span> <span class="n">jobParameters</span><span class="o">)</span><span class="o">;</span>
            <span class="n">LOG</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">&#34;Job was completed successfully.&#34;</span><span class="o">,</span> <span class="n">job</span><span class="o">.</span><span class="na">getName</span><span class="o">(</span><span class="o">)</span><span class="o">,</span> <span class="n">jobExecution</span><span class="o">.</span><span class="na">getId</span><span class="o">(</span><span class="o">)</span><span class="o">)</span><span class="o">;</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">JobParametersInvalidException</span> <span class="o">|</span> <span class="n">NoSuchJobException</span> <span class="o">|</span> <span class="n">JobExecutionAlreadyRunningException</span> <span class="o">|</span> <span class="n">JobInstanceAlreadyCompleteException</span> <span class="o">|</span> <span class="n">JobRestartException</span> <span class="n">ex</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">LOG</span><span class="o">.</span><span class="na">error</span><span class="o">(</span><span class="s">&#34;Failed execute job !!!&#34;</span><span class="o">)</span><span class="o">;</span>
            <span class="n">LOG</span><span class="o">.</span><span class="na">error</span><span class="o">(</span><span class="n">ex</span><span class="o">.</span><span class="na">getMessage</span><span class="o">(</span><span class="o">)</span><span class="o">)</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>

<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><ol start="7">
<li>Create quartz configuration as the following example <code>src/main/java/com/maverick/springbatchexample/quartz/QuartzConfiguration.java</code></li>
</ol>
<p>Quartz Scheduler Cron Format</p>
<p>Format [ * * * * * ? * ]</p>
<p>&mdash;&mdash;&gt;[ 1 2 3 4 5 6 7 ]</p>
<p>[1] : Seconds</p>
<p>[2] : Minutes</p>
<p>[3] : Hours</p>
<p>[4] : Day of month</p>
<p>[5] : Month</p>
<p>[6] : Day of week</p>
<p>[7] : Year</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">com.maverick.springbatchexample.quartz</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.slf4j.Logger</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.slf4j.LoggerFactory</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.batch.core.configuration.JobLocator</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.batch.core.configuration.JobRegistry</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.batch.core.configuration.support.JobRegistryBeanPostProcessor</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.batch.core.explore.JobExplorer</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.batch.core.launch.JobLauncher</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.batch.core.launch.JobOperator</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.batch.core.launch.support.SimpleJobLauncher</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.batch.core.launch.support.SimpleJobOperator</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.batch.core.repository.JobRepository</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.batch.core.repository.support.JobRepositoryFactoryBean</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.beans.factory.annotation.Autowired</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.beans.factory.annotation.Value</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.context.annotation.Bean</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.context.annotation.Configuration</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.scheduling.quartz.CronTriggerFactoryBean</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.scheduling.quartz.JobDetailFactoryBean</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.scheduling.quartz.SchedulerFactoryBean</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.transaction.PlatformTransactionManager</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">javax.sql.DataSource</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.HashMap</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Map</span><span class="o">;</span>

<span class="nd">@Configuration</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">QuartzConfiguration</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">Logger</span> <span class="n">LOG</span> <span class="o">=</span> <span class="n">LoggerFactory</span><span class="o">.</span><span class="na">getLogger</span><span class="o">(</span><span class="n">QuartzConfiguration</span><span class="o">.</span><span class="na">class</span><span class="o">)</span><span class="o">;</span>

    <span class="kd">private</span> <span class="kd">final</span> <span class="n">DataSource</span> <span class="n">dataSource</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="n">JobExplorer</span> <span class="n">jobExplorer</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="n">JobLocator</span> <span class="n">jobLocator</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="n">JobRegistry</span> <span class="n">jobRegistry</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="n">PlatformTransactionManager</span> <span class="n">platformTransactionManager</span><span class="o">;</span>

    <span class="nd">@Value</span><span class="o">(</span><span class="s">&#34;${scheduler.maverick.cron}&#34;</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">schedulerMaverickCron</span><span class="o">;</span>

    <span class="nd">@Autowired</span>
    <span class="kd">public</span> <span class="nf">QuartzConfiguration</span><span class="o">(</span><span class="n">DataSource</span> <span class="n">dataSource</span><span class="o">,</span> <span class="n">JobExplorer</span> <span class="n">jobExplorer</span><span class="o">,</span> <span class="n">JobLocator</span> <span class="n">jobLocator</span><span class="o">,</span>
                               <span class="n">JobRegistry</span> <span class="n">jobRegistry</span><span class="o">,</span> <span class="n">PlatformTransactionManager</span> <span class="n">platformTransactionManager</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">dataSource</span> <span class="o">=</span> <span class="n">dataSource</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">jobExplorer</span> <span class="o">=</span> <span class="n">jobExplorer</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">jobLocator</span> <span class="o">=</span> <span class="n">jobLocator</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">jobRegistry</span> <span class="o">=</span> <span class="n">jobRegistry</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">platformTransactionManager</span> <span class="o">=</span> <span class="n">platformTransactionManager</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@Bean</span>
    <span class="kd">public</span> <span class="n">JobRegistryBeanPostProcessor</span> <span class="nf">jobRegistryBeanPostProcessor</span><span class="o">(</span><span class="n">JobRegistry</span> <span class="n">jobRegistry</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">JobRegistryBeanPostProcessor</span> <span class="n">jobRegistryBeanPostProcessor</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JobRegistryBeanPostProcessor</span><span class="o">(</span><span class="o">)</span><span class="o">;</span>
        <span class="n">jobRegistryBeanPostProcessor</span><span class="o">.</span><span class="na">setJobRegistry</span><span class="o">(</span><span class="n">jobRegistry</span><span class="o">)</span><span class="o">;</span>
        <span class="k">return</span> <span class="n">jobRegistryBeanPostProcessor</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@Bean</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">&#34;jobRepository&#34;</span><span class="o">)</span>
    <span class="kd">public</span> <span class="n">JobRepository</span> <span class="nf">jobRepository</span><span class="o">(</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">JobRepositoryFactoryBean</span> <span class="n">factoryBean</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JobRepositoryFactoryBean</span><span class="o">(</span><span class="o">)</span><span class="o">;</span>
        <span class="n">factoryBean</span><span class="o">.</span><span class="na">setDataSource</span><span class="o">(</span><span class="n">dataSource</span><span class="o">)</span><span class="o">;</span>
        <span class="n">factoryBean</span><span class="o">.</span><span class="na">setTransactionManager</span><span class="o">(</span><span class="n">platformTransactionManager</span><span class="o">)</span><span class="o">;</span>
        <span class="n">factoryBean</span><span class="o">.</span><span class="na">setIsolationLevelForCreate</span><span class="o">(</span><span class="s">&#34;ISOLATION_READ_COMMITTED&#34;</span><span class="o">)</span><span class="o">;</span>
        <span class="n">factoryBean</span><span class="o">.</span><span class="na">setTablePrefix</span><span class="o">(</span><span class="s">&#34;BATCH_&#34;</span><span class="o">)</span><span class="o">;</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="n">factoryBean</span><span class="o">.</span><span class="na">afterPropertiesSet</span><span class="o">(</span><span class="o">)</span><span class="o">;</span>
            <span class="k">return</span> <span class="n">factoryBean</span><span class="o">.</span><span class="na">getObject</span><span class="o">(</span><span class="o">)</span><span class="o">;</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">ex</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">LOG</span><span class="o">.</span><span class="na">error</span><span class="o">(</span><span class="s">&#34;JobRepository bean could not be initialized&#34;</span><span class="o">,</span> <span class="n">ex</span><span class="o">)</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="kc">null</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@Bean</span>
    <span class="kd">public</span> <span class="n">JobLauncher</span> <span class="nf">jobLauncher</span><span class="o">(</span><span class="o">)</span><span class="o">{</span>
        <span class="n">SimpleJobLauncher</span> <span class="n">jobLauncher</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SimpleJobLauncher</span><span class="o">(</span><span class="o">)</span><span class="o">;</span>
        <span class="n">jobLauncher</span><span class="o">.</span><span class="na">setJobRepository</span><span class="o">(</span><span class="n">jobRepository</span><span class="o">(</span><span class="o">)</span><span class="o">)</span><span class="o">;</span>
        <span class="k">return</span> <span class="n">jobLauncher</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@Bean</span>
    <span class="kd">public</span> <span class="n">JobOperator</span> <span class="nf">jobOperator</span><span class="o">(</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">SimpleJobOperator</span> <span class="n">jobOperator</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SimpleJobOperator</span><span class="o">(</span><span class="o">)</span><span class="o">;</span>
        <span class="n">jobOperator</span><span class="o">.</span><span class="na">setJobExplorer</span><span class="o">(</span><span class="n">jobExplorer</span><span class="o">)</span><span class="o">;</span>
        <span class="n">jobOperator</span><span class="o">.</span><span class="na">setJobLauncher</span><span class="o">(</span><span class="n">jobLauncher</span><span class="o">(</span><span class="o">)</span><span class="o">)</span><span class="o">;</span>
        <span class="n">jobOperator</span><span class="o">.</span><span class="na">setJobRegistry</span><span class="o">(</span><span class="n">jobRegistry</span><span class="o">)</span><span class="o">;</span>
        <span class="n">jobOperator</span><span class="o">.</span><span class="na">setJobRepository</span><span class="o">(</span><span class="n">jobRepository</span><span class="o">(</span><span class="o">)</span><span class="o">)</span><span class="o">;</span>
        <span class="k">return</span> <span class="n">jobOperator</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@Bean</span>
    <span class="kd">public</span> <span class="n">JobDetailFactoryBean</span> <span class="nf">jobDetailFactoryBean</span><span class="o">(</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">JobDetailFactoryBean</span> <span class="n">factory</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JobDetailFactoryBean</span><span class="o">(</span><span class="o">)</span><span class="o">;</span>
        <span class="n">factory</span><span class="o">.</span><span class="na">setJobClass</span><span class="o">(</span><span class="n">QuartzJobLauncher</span><span class="o">.</span><span class="na">class</span><span class="o">)</span><span class="o">;</span>
        <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Object</span><span class="o">&gt;</span> <span class="n">map</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;</span><span class="o">&gt;</span><span class="o">(</span><span class="o">)</span><span class="o">;</span>
        <span class="n">map</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&#34;jobName&#34;</span><span class="o">,</span> <span class="s">&#34;importPersonJob&#34;</span><span class="o">)</span><span class="o">;</span>
        <span class="n">map</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&#34;jobLauncher&#34;</span><span class="o">,</span> <span class="n">jobLauncher</span><span class="o">(</span><span class="o">)</span><span class="o">)</span><span class="o">;</span>
        <span class="n">map</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&#34;jobLocator&#34;</span><span class="o">,</span> <span class="n">jobLocator</span><span class="o">)</span><span class="o">;</span>
        <span class="n">factory</span><span class="o">.</span><span class="na">setJobDataAsMap</span><span class="o">(</span><span class="n">map</span><span class="o">)</span><span class="o">;</span>
        <span class="k">return</span> <span class="n">factory</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@Bean</span>
    <span class="kd">public</span> <span class="n">CronTriggerFactoryBean</span> <span class="nf">cronTriggerFactoryBean</span><span class="o">(</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">CronTriggerFactoryBean</span> <span class="n">stFactory</span> <span class="o">=</span> <span class="k">new</span> <span class="n">CronTriggerFactoryBean</span><span class="o">(</span><span class="o">)</span><span class="o">;</span>
        <span class="n">stFactory</span><span class="o">.</span><span class="na">setJobDetail</span><span class="o">(</span><span class="n">jobDetailFactoryBean</span><span class="o">(</span><span class="o">)</span><span class="o">.</span><span class="na">getObject</span><span class="o">(</span><span class="o">)</span><span class="o">)</span><span class="o">;</span>
        <span class="n">stFactory</span><span class="o">.</span><span class="na">setCronExpression</span><span class="o">(</span><span class="n">schedulerMaverickCron</span><span class="o">)</span><span class="o">;</span>
        <span class="n">stFactory</span><span class="o">.</span><span class="na">setName</span><span class="o">(</span><span class="s">&#34;cronTriggerFactoryBean&#34;</span><span class="o">)</span><span class="o">;</span>
        <span class="k">return</span> <span class="n">stFactory</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@Bean</span>
    <span class="kd">public</span> <span class="n">SchedulerFactoryBean</span> <span class="nf">schedulerBean</span><span class="o">(</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">SchedulerFactoryBean</span> <span class="n">scheduler</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SchedulerFactoryBean</span><span class="o">(</span><span class="o">)</span><span class="o">;</span>
        <span class="n">scheduler</span><span class="o">.</span><span class="na">setTriggers</span><span class="o">(</span><span class="n">cronTriggerFactoryBean</span><span class="o">(</span><span class="o">)</span><span class="o">.</span><span class="na">getObject</span><span class="o">(</span><span class="o">)</span><span class="o">)</span><span class="o">;</span>
        <span class="k">return</span> <span class="n">scheduler</span><span class="o">;</span>
    <span class="o">}</span>

<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><ol start="8">
<li>Create job completion notification listener to notify when job is complete as the following example <code>src/main/java/com/maverick/springbatchexample/service/JobCompletionNotificationListener.java</code></li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">com.maverick.springbatchexample.service</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.slf4j.Logger</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.slf4j.LoggerFactory</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.batch.core.BatchStatus</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.batch.core.JobExecution</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.batch.core.listener.JobExecutionListenerSupport</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.stereotype.Service</span><span class="o">;</span>

<span class="nd">@Service</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">JobCompletionNotificationListener</span> <span class="kd">extends</span> <span class="n">JobExecutionListenerSupport</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">Logger</span> <span class="n">LOG</span> <span class="o">=</span> <span class="n">LoggerFactory</span><span class="o">.</span><span class="na">getLogger</span><span class="o">(</span><span class="n">JobCompletionNotificationListener</span><span class="o">.</span><span class="na">class</span><span class="o">)</span><span class="o">;</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">afterJob</span><span class="o">(</span><span class="n">JobExecution</span> <span class="n">jobExecution</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">jobExecution</span><span class="o">.</span><span class="na">getStatus</span><span class="o">(</span><span class="o">)</span> <span class="o">=</span><span class="o">=</span> <span class="n">BatchStatus</span><span class="o">.</span><span class="na">COMPLETED</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">LOG</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">&#34;### JOB FINISHED!&#34;</span><span class="o">)</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><ol start="9">
<li>Put together a batch job configuration as the following example <code>src/main/java/com/maverick/springbatchexample/configuration/BatchConfiguration.java</code></li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span><span class="lnt">82
</span><span class="lnt">83
</span><span class="lnt">84
</span><span class="lnt">85
</span><span class="lnt">86
</span><span class="lnt">87
</span><span class="lnt">88
</span><span class="lnt">89
</span><span class="lnt">90
</span><span class="lnt">91
</span><span class="lnt">92
</span><span class="lnt">93
</span><span class="lnt">94
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">com.maverick.springbatchexample.configuration</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">com.maverick.springbatchexample.model.Person</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.maverick.springbatchexample.processor.PersonItemProcessor</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.maverick.springbatchexample.service.JobCompletionNotificationListener</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.batch.core.Job</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.batch.core.Step</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.batch.core.configuration.annotation.EnableBatchProcessing</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.batch.core.configuration.annotation.JobBuilderFactory</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.batch.core.configuration.annotation.StepBuilderFactory</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.batch.core.configuration.annotation.StepScope</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.batch.core.launch.support.RunIdIncrementer</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.batch.item.database.BeanPropertyItemSqlParameterSourceProvider</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.batch.item.database.JdbcBatchItemWriter</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.batch.item.database.builder.JdbcBatchItemWriterBuilder</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.batch.item.file.FlatFileItemReader</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.batch.item.file.builder.FlatFileItemReaderBuilder</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.batch.item.file.mapping.BeanWrapperFieldSetMapper</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.beans.factory.annotation.Autowired</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.beans.factory.annotation.Qualifier</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.beans.factory.annotation.Value</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.context.annotation.Bean</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.context.annotation.Configuration</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.core.io.ClassPathResource</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">javax.sql.DataSource</span><span class="o">;</span>

<span class="nd">@Configuration</span>
<span class="nd">@EnableBatchProcessing</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">BatchConfiguration</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="kd">final</span> <span class="n">JobBuilderFactory</span> <span class="n">jobBuilderFactory</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="n">StepBuilderFactory</span> <span class="n">stepBuilderFactory</span><span class="o">;</span>

    <span class="nd">@Value</span><span class="o">(</span><span class="s">&#34;${files.source-file:sample-data.csv}&#34;</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">sourceFile</span><span class="o">;</span>

    <span class="nd">@Autowired</span>
    <span class="kd">public</span> <span class="nf">BatchConfiguration</span><span class="o">(</span><span class="n">JobBuilderFactory</span> <span class="n">jobBuilderFactory</span><span class="o">,</span> <span class="n">StepBuilderFactory</span> <span class="n">stepBuilderFactory</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">jobBuilderFactory</span> <span class="o">=</span> <span class="n">jobBuilderFactory</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">stepBuilderFactory</span> <span class="o">=</span> <span class="n">stepBuilderFactory</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@Bean</span>
    <span class="kd">public</span> <span class="n">FlatFileItemReader</span><span class="o">&lt;</span><span class="n">Person</span><span class="o">&gt;</span> <span class="nf">reader</span><span class="o">(</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="n">FlatFileItemReaderBuilder</span><span class="o">&lt;</span><span class="n">Person</span><span class="o">&gt;</span><span class="o">(</span><span class="o">)</span>
                <span class="o">.</span><span class="na">name</span><span class="o">(</span><span class="s">&#34;personItemReader&#34;</span><span class="o">)</span>
                <span class="o">.</span><span class="na">resource</span><span class="o">(</span><span class="k">new</span> <span class="n">ClassPathResource</span><span class="o">(</span><span class="n">sourceFile</span><span class="o">)</span><span class="o">)</span>
                <span class="o">.</span><span class="na">delimited</span><span class="o">(</span><span class="o">)</span>
                <span class="o">.</span><span class="na">names</span><span class="o">(</span><span class="k">new</span> <span class="n">String</span><span class="o">[</span><span class="o">]</span><span class="o">{</span><span class="s">&#34;name&#34;</span><span class="o">,</span> <span class="s">&#34;age&#34;</span><span class="o">,</span> <span class="s">&#34;gender&#34;</span><span class="o">}</span><span class="o">)</span>
                <span class="o">.</span><span class="na">fieldSetMapper</span><span class="o">(</span><span class="k">new</span> <span class="n">BeanWrapperFieldSetMapper</span><span class="o">&lt;</span><span class="o">&gt;</span><span class="o">(</span><span class="o">)</span><span class="o">{</span><span class="o">{</span>
                    <span class="n">setTargetType</span><span class="o">(</span><span class="n">Person</span><span class="o">.</span><span class="na">class</span><span class="o">)</span><span class="o">;</span>
                <span class="o">}</span><span class="o">}</span><span class="o">)</span>
                <span class="o">.</span><span class="na">build</span><span class="o">(</span><span class="o">)</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@Bean</span>
    <span class="nd">@StepScope</span>
    <span class="kd">public</span> <span class="n">PersonItemProcessor</span> <span class="nf">processor</span><span class="o">(</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="n">PersonItemProcessor</span><span class="o">(</span><span class="o">)</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@Bean</span>
    <span class="kd">public</span> <span class="n">JdbcBatchItemWriter</span><span class="o">&lt;</span><span class="n">Person</span><span class="o">&gt;</span> <span class="nf">writer</span><span class="o">(</span><span class="n">DataSource</span> <span class="n">dataSource</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="n">JdbcBatchItemWriterBuilder</span><span class="o">&lt;</span><span class="n">Person</span><span class="o">&gt;</span><span class="o">(</span><span class="o">)</span>
                <span class="o">.</span><span class="na">itemSqlParameterSourceProvider</span><span class="o">(</span><span class="k">new</span> <span class="n">BeanPropertyItemSqlParameterSourceProvider</span><span class="o">&lt;</span><span class="o">&gt;</span><span class="o">(</span><span class="o">)</span><span class="o">)</span>
                <span class="o">.</span><span class="na">sql</span><span class="o">(</span><span class="s">&#34;INSERT INTO M_HUMAN (name, age, gender) VALUES (:name, :age, :gender)&#34;</span><span class="o">)</span>
                <span class="o">.</span><span class="na">dataSource</span><span class="o">(</span><span class="n">dataSource</span><span class="o">)</span>
                <span class="o">.</span><span class="na">build</span><span class="o">(</span><span class="o">)</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@Bean</span>
    <span class="kd">public</span> <span class="n">Job</span> <span class="nf">importPersonJob</span><span class="o">(</span><span class="n">JobCompletionNotificationListener</span> <span class="n">listener</span><span class="o">,</span>
                               <span class="nd">@Qualifier</span><span class="o">(</span><span class="s">&#34;personImportStep&#34;</span><span class="o">)</span> <span class="n">Step</span> <span class="n">personImportStep</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">jobBuilderFactory</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">&#34;importPersonJob&#34;</span><span class="o">)</span>
                <span class="o">.</span><span class="na">incrementer</span><span class="o">(</span><span class="k">new</span> <span class="n">RunIdIncrementer</span><span class="o">(</span><span class="o">)</span><span class="o">)</span>
                <span class="o">.</span><span class="na">listener</span><span class="o">(</span><span class="n">listener</span><span class="o">)</span>
                <span class="o">.</span><span class="na">start</span><span class="o">(</span><span class="n">personImportStep</span><span class="o">)</span>
                <span class="o">.</span><span class="na">build</span><span class="o">(</span><span class="o">)</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@Bean</span>
    <span class="kd">public</span> <span class="n">Step</span> <span class="nf">personImportStep</span><span class="o">(</span><span class="n">FlatFileItemReader</span><span class="o">&lt;</span><span class="n">Person</span><span class="o">&gt;</span> <span class="n">reader</span><span class="o">,</span>
                                 <span class="n">PersonItemProcessor</span> <span class="n">processor</span><span class="o">,</span>
                                 <span class="n">JdbcBatchItemWriter</span><span class="o">&lt;</span><span class="n">Person</span><span class="o">&gt;</span> <span class="n">writer</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">stepBuilderFactory</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">&#34;personImportStep&#34;</span><span class="o">)</span>
                <span class="o">.</span><span class="o">&lt;</span><span class="n">Person</span><span class="o">,</span> <span class="n">Person</span><span class="o">&gt;</span> <span class="nf">chunk</span><span class="o">(</span><span class="n">10</span><span class="o">)</span>
                <span class="o">.</span><span class="na">reader</span><span class="o">(</span><span class="n">reader</span><span class="o">)</span>
                <span class="o">.</span><span class="na">processor</span><span class="o">(</span><span class="n">processor</span><span class="o">)</span>
                <span class="o">.</span><span class="na">writer</span><span class="o">(</span><span class="n">writer</span><span class="o">)</span>
                <span class="o">.</span><span class="na">build</span><span class="o">(</span><span class="o">)</span><span class="o">;</span>
    <span class="o">}</span>

<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><ol start="10">
<li>Make application executable and load <code>application.properties</code> from classpath</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="nd">@SpringBootApplication</span>
<span class="nd">@PropertySources</span><span class="o">(</span><span class="o">{</span>
		<span class="nd">@PropertySource</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&#34;classpath:application.properties&#34;</span><span class="o">,</span> <span class="n">ignoreResourceNotFound</span> <span class="o">=</span> <span class="kc">true</span><span class="o">)</span>
<span class="o">}</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SpringBatchExampleApplication</span> <span class="o">{</span>

	<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[</span><span class="o">]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
		<span class="n">SpringApplication</span><span class="o">.</span><span class="na">run</span><span class="o">(</span><span class="n">SpringBatchExampleApplication</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">args</span><span class="o">)</span><span class="o">;</span>
	<span class="o">}</span>

<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><ol start="11">
<li>Edit <code>src/main/resources/application.properties</code> to allow initialize schema and etc.</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">spring.batch.initialize-schema=ALWAYS
spring.main.allow-bean-definition-overriding=true
spring.batch.job.enabled=false
</code></pre></td></tr></table>
</div>
</div><ol start="12">
<li>Create an external application configuration call <code>application.yml</code></li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-yml" data-lang="yml">app<span class="p">:</span><span class="w">
</span><span class="w">  </span>name<span class="p">:</span><span class="w"> </span><span class="s2">&#34;Spring Batch Example&#34;</span><span class="w">
</span><span class="w"></span>spring<span class="p">:</span><span class="w">
</span><span class="w">  </span>profiles<span class="p">:</span><span class="w">
</span><span class="w">    </span>active<span class="p">:</span><span class="w"> </span><span class="s2">&#34;dev&#34;</span><span class="w">
</span><span class="w">  </span>datasource<span class="p">:</span><span class="w">
</span><span class="w">    </span>url<span class="p">:</span><span class="w"> </span><span class="s2">&#34;jdbc:mysql://localhost:3306/DB_NAME?allowPublicKeyRetrieval=true&amp;useSSL=false&#34;</span><span class="w">
</span><span class="w">    </span>username<span class="p">:</span><span class="w"> </span>DB_USERNAME<span class="w">
</span><span class="w">    </span>password<span class="p">:</span><span class="w"> </span>DB_PASSWORD<span class="w">
</span><span class="w">    </span>driverClassName<span class="p">:</span><span class="w"> </span>com.mysql.cj.jdbc.Driver<span class="w">
</span><span class="w"></span>scheduler<span class="p">:</span><span class="w">
</span><span class="w">  </span>maverick<span class="p">:</span><span class="w">
</span><span class="w">    </span>cron<span class="p">:</span><span class="w"> </span><span class="s2">&#34;0 0 14 ? * TUE *&#34;</span><span class="w">
</span><span class="w"></span>files<span class="p">:</span><span class="w">
</span><span class="w">  </span>source-file<span class="p">:</span><span class="w"> </span><span class="s2">&#34;sample-data.csv&#34;</span><span class="w">
</span></code></pre></td></tr></table>
</div>
</div><ol start="13">
<li>Build an executable jar with <code>mvn clean package</code> and run application parallel to <code>application.yml</code> with command</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">java -jar spring-batch-example-0.0.1-SNAPSHOT.jar -Dspring.config.location<span class="o">=</span>application.yml
</code></pre></td></tr></table>
</div>
</div><p>The job prints out a line for each person that gets transformed. After the job runs, you can also see the output from querying the database. It should resemble the following output:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">2020-12-08 14:00:00.218  INFO 78242 --- [erBean_Worker-1] o.s.b.c.l.support.SimpleJobLauncher      : Job: [SimpleJob: [name=importPersonJob]] launched with the following parameters: [{time=1607410800020}]
2020-12-08 14:00:00.338  INFO 78242 --- [erBean_Worker-1] o.s.batch.core.job.SimpleStepHandler     : Executing step: [personImportStep]
2020-12-08 14:00:00.437  INFO 78242 --- [erBean_Worker-1] c.m.s.processor.PersonItemProcessor      : ### Process: Maverick
2020-12-08 14:00:00.438  INFO 78242 --- [erBean_Worker-1] c.m.s.processor.PersonItemProcessor      : ### Process: Al Sah-Him
2020-12-08 14:00:00.438  INFO 78242 --- [erBean_Worker-1] c.m.s.processor.PersonItemProcessor      : ### Process: Felicia
2020-12-08 14:00:00.438  INFO 78242 --- [erBean_Worker-1] c.m.s.processor.PersonItemProcessor      : ### Process: Jessica
2020-12-08 14:00:00.438  INFO 78242 --- [erBean_Worker-1] c.m.s.processor.PersonItemProcessor      : ### Process: Calvin Joe
2020-12-08 14:00:00.503  INFO 78242 --- [erBean_Worker-1] o.s.batch.core.step.AbstractStep         : Step: [personImportStep] executed in 164ms
2020-12-08 14:00:00.533  INFO 78242 --- [erBean_Worker-1] .m.s.s.JobCompletionNotificationListener : ### JOB FINISHED!
2020-12-08 14:00:00.559  INFO 78242 --- [erBean_Worker-1] o.s.b.c.l.support.SimpleJobLauncher      : Job: [SimpleJob: [name=importPersonJob]] completed with the following parameters: [{time=1607410800020}] and the following status: [COMPLETED] in 267ms
</code></pre></td></tr></table>
</div>
</div><a class="post-dummy-target" id="clone-or-download"></a><h2>Clone or Download</h2>
<p>You can clone or download this project</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">git@github.com:piinalpin/spring-batch-quartz-example.git
</code></pre></td></tr></table>
</div>
</div><a class="post-dummy-target" id="thankyou"></a><h3>Thankyou</h3>
<p><a href="https://spring.io/guides/gs/batch-processing/">Spring.io</a> - Create a Batch Service</p>
        </div>

        <div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>This article is updated with 2020-12-08</span>
            </div>
            <div class="post-info-license">
                
            </div>
        </div>
        <div class="post-info-line">
            <div class="post-info-md">
                
                    
                        <span><a class="link-to-markdown" href="https://blog.piinalpin.com/2020/12/spring-batch-example/index.md" target="_blank"></a></span>
                    
                
            </div>
            <div class="post-info-share">
                
                    <span>
    
        <a href="//twitter.com/share?url=https%3a%2f%2fblog.piinalpin.com%2f2020%2f12%2fspring-batch-example%2f&amp;text=Simple%20Spring%20Batch%20with%20Quartz%20Scheduling&amp;via=piinalpin" target="_blank" title="Share on Twitter">
            <i class="fab fa-twitter fa-fw"></i>
        </a>
    
    
        <a href="//www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fblog.piinalpin.com%2f2020%2f12%2fspring-batch-example%2f" target="_blank" title="Share on Facebook">
            <i class="fab fa-facebook-square fa-fw"></i>
        </a>
    
    
        <a href="//reddit.com/submit?url=https%3a%2f%2fblog.piinalpin.com%2f2020%2f12%2fspring-batch-example%2f&amp;title=Simple%20Spring%20Batch%20with%20Quartz%20Scheduling" target="_blank" title="Share on Reddit">
            <i class="fab fa-reddit fa-fw"></i>
        </a>
    
    
    
    
    
    
    
    
</span>
                
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section>
            
                
                    <span class="tag">
                        <a href="https://blog.piinalpin.com/tags/java/"><i class="fas fa-tag fa-fw"></i>Java</a>
                    </span>
                
                    <span class="tag">
                        <a href="https://blog.piinalpin.com/tags/spring-batch/"><i class="fas fa-tag fa-fw"></i>Spring Batch</a>
                    </span>
                
                    <span class="tag">
                        <a href="https://blog.piinalpin.com/tags/spring-boot/"><i class="fas fa-tag fa-fw"></i>Spring Boot</a>
                    </span>
                
                    <span class="tag">
                        <a href="https://blog.piinalpin.com/tags/mysql/"><i class="fas fa-tag fa-fw"></i>MySQL</a>
                    </span>
                
            
        </section>
        <section>
            <span><a href="javascript:window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="https://blog.piinalpin.com/">Home</a></span>
        </section>
    </div>

    <div class="post-nav">
        
            <a href="https://blog.piinalpin.com/2020/12/create-sequence-like-oracle-in-mysql/" class="prev" rel="prev" title="Create Sequence Like Oracle in MySQL"><i class="fas fa-angle-left fa-fw"></i>Create Sequence Like Oracle in MySQL</a>
        
        
            <a href="https://blog.piinalpin.com/2020/12/sql-generator/" class="next" rel="next" title="SQL Insert Generator from Excel File using Python">SQL Insert Generator from Excel File using Python<i class="fas fa-angle-right fa-fw"></i></a>
        
    </div>
</div>

        <div class="post-comment">
            
            

            
        </div>
    </article></div>
            </main>
            <footer class="footer">
    <div class="copyright">
        <div class="copyright-line">
            Powered by <a href="https://gohugo.io/" target="_blank" rel="external nofollow noopener noreffer">Hugo</a>&nbsp;|&nbsp;Theme - <a href="https://github.com/dillonzq/LoveIt" target="_blank" rel="external nofollow noopener noreffer">LoveIt<i class="far fa-heart fa-fw"></i></a>
        </div>
        <div class="copyright-line">
            <i class="far fa-copyright fa-fw"></i><span itemprop="copyrightYear">2019 - 2020</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="https://blog.piinalpin.com/">piinalpin</a></span><span class="license">&nbsp;|&nbsp;<a rel="license external nofollow noopener noreffer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span></div>
    </div>
</footer>


    
    




    
    




    
    





    
    



    
    



    
    





    
    





    
    



    
    





    
    




    
    




    
    



    
    





    
    


<script src="/js/lib/jquery/jquery.slim.min.min.js"></script>
<script src="/js/lib/lazysizes/lazysizes.min.min.js"></script>
<script src="/js/lib/smooth-scroll/smooth-scroll.polyfills.min.min.js"></script><script>window.scroll = new SmoothScroll('[data-scroll]', {speed: 300, speedAsDuration: true});</script>


    
    

    

    
        <link rel="stylesheet" href="/css/lib/katex/katex.min.min.css"><script src="/js/lib/katex/katex.min.min.js"></script><script defer src="/js/lib/katex/auto-render.min.min.js" onload="renderMathInElement(document.body);"></script>
    

    

    






<script src="/js/blog.min.js"></script>


    
</div>
        <a href="#" class="dynamic-to-top" id="dynamic-to-top" data-scroll><span>&nbsp;</span></a>
    </body>
</html>