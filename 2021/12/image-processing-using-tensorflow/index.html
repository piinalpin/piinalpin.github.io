<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>Image Processing Using Tensorflow - Convolutional Neural Network (CNN) | PiinAlpin</title><meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="robots" content="noodp" />
<meta name="Description" content="Digital image processing is the use of a digital computer to process digital images through an algorithm. As a subcategory or field of digital signal processing, digital image processing has many advantages over analog image processing.">
<link rel="prev" href="https://blog.piinalpin.com/2021/12/orm-nodejs-sequelize/" />
<link rel="next" href="https://blog.piinalpin.com/2022/02/best-practice-uploading-file-using-rest-template/" />
<link rel="canonical" href="https://blog.piinalpin.com/2021/12/image-processing-using-tensorflow/" />
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Image Processing Using Tensorflow - Convolutional Neural Network (CNN)"/>
<meta name="twitter:description" content="Digital image processing is the use of a digital computer to process digital images through an algorithm. As a subcategory or field of digital signal processing, digital image processing has many advantages over analog image processing."/>
<script type="application/ld+json">
    {
    "@context": "http://schema.org",
    "@type": "BlogPosting",
    "headline": "Image Processing Using Tensorflow - Convolutional Neural Network (CNN)",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "https:\/\/blog.piinalpin.com\/2021\/12\/image-processing-using-tensorflow\/"
    },
    
        "image": {
            "@type": "ImageObject",
            "url": "https:\/\/blog.piinalpin.com\/cover.png",
            "width":  800 ,
            "height":  600 
        },
    
    "genre": "posts",
    
        "keywords": "Image Processing, Tensorflow, Artificial Intelligence, Keras, Python",
    
    "wordcount":  879 ,
    "url": "https:\/\/blog.piinalpin.com\/2021\/12\/image-processing-using-tensorflow\/",
    
        "datePublished": "2021-12-10T10:02:39\u002b07:00",
    
    
        "dateModified": "2021-12-10T10:02:39\u002b07:00",
    
    
        "license": "This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.",
    
    
        "publisher": {
            "@type": "Organization",
            "name": "Alvinditya Saputra",
            "logo": {
            "@type": "ImageObject",
            "url": "https:\/\/blog.piinalpin.com\/logo.png",
            "width":  127 ,
            "height":  40 
            }
        },
    
    
    "description": "Digital image processing is the use of a digital computer to process digital images through an algorithm. As a subcategory or field of digital signal processing, digital image processing has many advantages over analog image processing."
    }
    </script>
<link rel="stylesheet" href="/css/style.min.css">
<link rel="stylesheet" href="/css/lib/fontawesome-free/all.min.min.css">

<link rel="stylesheet" href="/css/lib/animate/animate.min.min.css">


<script>
  if('serviceWorker' in navigator) {
      navigator.serviceWorker
          .register('/service-worker.js', { scope: '/' })
          .then(function(registration) {
              
          });

      navigator.serviceWorker
          .ready
          .then(function(registration) {
              
          });
  }
</script>
    </head>
    <body>
        <script>
            window.localStorage.getItem('theme') === 'dark';
            document.body.classList.add('dark-theme');
        </script>
        <div class="wrapper">
            <nav class="navbar">
    <div class="navbar-container">
        <div class="navbar-header animated bounceIn">
            <a href="https://blog.piinalpin.com/">PiinAlpin</a>
        </div>
        <div class="navbar-menu">
            
            
                <a class="menu-item" href="https://blog.piinalpin.com/posts" title="">Posts</a>
            
                <a class="menu-item" href="https://blog.piinalpin.com/tags" title="">Tags</a>
            
                <a class="menu-item" href="https://blog.piinalpin.com/categories" title="">Categories</a>
            
                <a class="menu-item" href="https://blog.piinalpin.com/about" title="">About</a>
            
        </div>
    </div>
</nav>
<nav class="navbar-mobile">
     <div class="navbar-container">
        <div class="navbar-header">
            <div class="navbar-header-title animated bounceIn">
                <a href="https://blog.piinalpin.com/">PiinAlpin</a>
            </div>
            <div class="menu-toggle" id="menu-toggle">
                <span></span><span></span><span></span>
            </div>
        </div>
    </div>
</nav><main class="main">
                <div class="container">
                    
    
    
    

    <article class="post-warp">
        <h1 class="post-title animated flipInX">Image Processing Using Tensorflow - Convolutional Neural Network (CNN)</h1>

        <div class="post-meta">
            <div class="post-meta-main">
                <a class="author" href="https://blog.piinalpin.com/" rel="author"><i class="fas fa-user-circle fa-fw"></i>piinalpin&nbsp;</a>
                <span class="post-category">
                        included in
                        <i class="far fa-folder fa-fw"></i><a href="https://blog.piinalpin.com/categories/documentation/">Documentation</a>
                            
                    </span>
            </div>
            <div class="post-meta-other">
                <i class="far fa-calendar-alt fa-fw"></i><time datetime=2021-12-10>2021-12-10</time>&nbsp;
                <i class="fas fa-pencil-alt fa-fw"></i>about 879 words&nbsp;
                <i class="far fa-clock fa-fw"></i>5 min&nbsp;</div>
        </div>

        

        <div class="post-toc" id="post-toc">
                <h2 class="post-toc-title">Table of Contents</h2>
                <div class="post-toc-content">
                    <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#overview">Overview</a></li>
        <li><a href="#study-case">Study Case</a></li>
      </ul>
    </li>
    <li><a href="#source">Source</a>
      <ul>
        <li><a href="#reference">Reference</a></li>
      </ul>
    </li>
  </ul>
</nav>
                </div>
            </div>
            <div class="post-toc-mobile" id="post-toc-mobile">
                <details>
                    <summary><div class="post-toc-title"><span>Table of Contents</span><span><i class="details icon fas fa-angle-down"></i></span></div></summary>
                    <div class="post-toc-content">
                        
                        
                        <nav id="TableOfContentsMobile">
  <ul>
    <li>
      <ul>
        <li><a href="#overview">Overview</a></li>
        <li><a href="#study-case">Study Case</a></li>
      </ul>
    </li>
    <li><a href="#source">Source</a>
      <ul>
        <li><a href="#reference">Reference</a></li>
      </ul>
    </li>
  </ul>
</nav>
                    </div>
                </details>
            </div>

        <div class="post-content">
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            <a class="post-dummy-target" id="overview"></a><h3>Overview</h3>
<p>Digital image processing is the use of a digital computer to process digital images through an algorithm. As a subcategory or field of digital signal processing, digital image processing has many advantages over analog image processing.</p>
<p><img src="/images/malaria-1.png" alt="Image Processing Flow"></p>
<p>Machine learning is a complex discipline. But implementing machine learning models is far less daunting and difficult than it used to be, thanks to machine learning frameworks—such as Google’s TensorFlow—that ease the process of acquiring data, training models, serving predictions, and refining future results.</p>
<p>Created by the Google Brain team, TensorFlow is an open source library for numerical computation and large-scale machine learning. TensorFlow bundles together a slew of machine learning and deep learning (aka neural networking) models and algorithms and makes them useful by way of a common metaphor. It uses Python to provide a convenient front-end API for building applications with the framework, while executing those applications in high-performance C++.</p>
<a class="post-dummy-target" id="study-case"></a><h3>Study Case</h3>
<p>In this case, we will detect the image whether the image is an indication of malaria infection or not. We will use dataset which can be download <a href="https://github.com/piinalpin/research-collection/tree/master/tensorflow/malaria-detection/dataset">here</a>.</p>
<p><strong>Directory Structure</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">.
├── ...
├── dataset
│   └── parasitized/
│   ├── uninfected/
├── test-data/
│   └── ...
└── research.ipynb
└── ...
</code></pre></td></tr></table>
</div>
</div><p><strong>Import Dependency and Count Dataset</strong></p>
<p>We will use <code>tensorflow.keras</code> library like following code.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">tensorflow</span> <span class="kn">import</span> <span class="n">keras</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras</span> <span class="kn">import</span> <span class="n">Sequential</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.layers</span> <span class="kn">import</span> <span class="n">Conv2D</span><span class="p">,</span> <span class="n">Activation</span><span class="p">,</span> <span class="n">MaxPooling2D</span><span class="p">,</span> <span class="n">Dropout</span><span class="p">,</span> <span class="n">Flatten</span><span class="p">,</span> <span class="n">Dense</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.preprocessing.image</span> <span class="kn">import</span> <span class="n">ImageDataGenerator</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.models</span> <span class="kn">import</span> <span class="n">load_model</span>
<span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span>
<span class="kn">from</span> <span class="nn">skimage</span> <span class="kn">import</span> <span class="n">transform</span>

<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">glob</span>
</code></pre></td></tr></table>
</div>
</div><p>Count our dataset in this case.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">parasitized</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s1">&#39;dataset/parasitized/*.png&#39;</span><span class="p">)</span>
<span class="n">uninfected</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s1">&#39;dataset/uninfected/*.png&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Parasitized data: </span><span class="si">{}</span><span class="se">\n</span><span class="s2">Uninfected data: </span><span class="si">{}</span><span class="s2">&#34;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">parasitized</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">uninfected</span><span class="p">)))</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>Preprocessing</strong></p>
<p>Data augmentation, based on wikipedia data augmentation is techniques are used to increase the amount of data by adding slightly modified copies of already existing data or newly created synthetic data from existing data.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">dimension</span> <span class="o">=</span> <span class="mi">128</span>
<span class="n">batch</span> <span class="o">=</span> <span class="mi">32</span>
<span class="n">data_dir</span> <span class="o">=</span> <span class="s2">&#34;dataset&#34;</span>

<span class="n">datagen</span> <span class="o">=</span> <span class="n">ImageDataGenerator</span><span class="p">(</span><span class="n">rescale</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="mf">255.0</span><span class="p">,</span> 
                             <span class="n">validation_split</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>
                             <span class="n">zoom_range</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span>
                             <span class="n">width_shift_range</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span>
                             <span class="n">height_shift_range</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span>
                             <span class="n">shear_range</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span>
                             <span class="n">horizontal_flip</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">train_data</span> <span class="o">=</span> <span class="n">datagen</span><span class="o">.</span><span class="n">flow_from_directory</span><span class="p">(</span><span class="n">data_dir</span><span class="p">,</span> 
                                         <span class="n">target_size</span><span class="o">=</span><span class="p">(</span><span class="n">dimension</span><span class="p">,</span> <span class="n">dimension</span><span class="p">),</span> 
                                         <span class="n">batch_size</span><span class="o">=</span><span class="n">batch</span><span class="p">,</span> 
                                         <span class="n">class_mode</span><span class="o">=</span><span class="s1">&#39;categorical&#39;</span><span class="p">,</span> 
                                         <span class="n">subset</span><span class="o">=</span><span class="s1">&#39;training&#39;</span><span class="p">)</span>

<span class="n">validation_data</span> <span class="o">=</span> <span class="n">datagen</span><span class="o">.</span><span class="n">flow_from_directory</span><span class="p">(</span><span class="n">data_dir</span><span class="p">,</span>
                                              <span class="n">target_size</span><span class="o">=</span><span class="p">(</span><span class="n">dimension</span><span class="p">,</span> <span class="n">dimension</span><span class="p">),</span>
                                              <span class="n">batch_size</span><span class="o">=</span><span class="n">batch</span><span class="p">,</span>
                                              <span class="n">class_mode</span><span class="o">=</span><span class="s1">&#39;categorical&#39;</span><span class="p">,</span>
                                              <span class="n">subset</span><span class="o">=</span><span class="s1">&#39;validation&#39;</span><span class="p">,</span>
                                              <span class="n">shuffle</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">test_data</span> <span class="o">=</span> <span class="n">datagen</span><span class="o">.</span><span class="n">flow_from_directory</span><span class="p">(</span><span class="n">data_dir</span><span class="p">,</span>
                                        <span class="n">target_size</span><span class="o">=</span><span class="p">(</span><span class="n">dimension</span><span class="p">,</span> <span class="n">dimension</span><span class="p">),</span>
                                        <span class="n">batch_size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                                        <span class="n">shuffle</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>Training Data and Modelling</strong></p>
<p>The process of training an ML model involves providing an ML algorithm (that is, the learning algorithm) with training data to learn from. The term ML model refers to the model artifact that is created by the training process.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">model</span> <span class="o">=</span> <span class="n">Sequential</span><span class="p">()</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Conv2D</span><span class="p">(</span><span class="n">filters</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">kernel_size</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="s2">&#34;same&#34;</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s2">&#34;relu&#34;</span><span class="p">,</span> <span class="n">input_shape</span><span class="o">=</span><span class="p">(</span><span class="n">dimension</span><span class="p">,</span> <span class="n">dimension</span><span class="p">,</span> <span class="mi">3</span><span class="p">)))</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">MaxPooling2D</span><span class="p">(</span><span class="n">pool_size</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>

<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Conv2D</span><span class="p">(</span><span class="n">filters</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">kernel_size</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="s2">&#34;same&#34;</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s2">&#34;relu&#34;</span><span class="p">))</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">MaxPooling2D</span><span class="p">(</span><span class="n">pool_size</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>

<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Conv2D</span><span class="p">(</span><span class="n">filters</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span> <span class="n">kernel_size</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="s2">&#34;same&#34;</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s2">&#34;relu&#34;</span><span class="p">))</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">MaxPooling2D</span><span class="p">(</span><span class="n">pool_size</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>

<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dropout</span><span class="p">(</span><span class="mf">0.2</span><span class="p">))</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Flatten</span><span class="p">())</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s2">&#34;relu&#34;</span><span class="p">))</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dropout</span><span class="p">(</span><span class="mf">0.2</span><span class="p">))</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s2">&#34;softmax&#34;</span><span class="p">))</span>

<span class="c1"># Compile the model</span>
<span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="s2">&#34;adam&#34;</span><span class="p">,</span> 
              <span class="n">loss</span><span class="o">=</span><span class="s2">&#34;binary_crossentropy&#34;</span><span class="p">,</span> 
              <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s2">&#34;accuracy&#34;</span><span class="p">])</span>

<span class="c1"># Save the best trained model by monitoring validation loss</span>
<span class="n">model_name</span> <span class="o">=</span> <span class="s2">&#34;train_data_model.b&#34;</span>
<span class="n">model_checkpoint</span> <span class="o">=</span> <span class="n">ModelCheckpoint</span><span class="p">(</span><span class="n">model_name</span><span class="p">,</span> 
                                   <span class="n">save_weights_only</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
                                   <span class="n">monitor</span><span class="o">=</span><span class="s1">&#39;val_loss&#39;</span><span class="p">,</span> 
                                   <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> 
                                   <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> 
                                   <span class="n">save_best_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Training dataset</span>
<span class="n">history</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_data</span><span class="p">,</span> 
                    <span class="n">batch_size</span><span class="o">=</span><span class="n">batch</span><span class="p">,</span> 
                    <span class="n">epochs</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> 
                    <span class="n">validation_data</span><span class="o">=</span><span class="n">validation_data</span><span class="p">,</span>
                    <span class="n">callbacks</span> <span class="o">=</span> <span class="p">[</span><span class="n">model_checkpoint</span><span class="p">],</span>
                    <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>Model Evaluation</strong></p>
<p>Evaluation is a process during development of the model to check whether the model is best fit for the given problem and corresponding data. Keras model provides a function, evaluate which does the evaluation of the model. It has three main arguments :</p>
<ul>
<li>Test data</li>
<li>Test data label</li>
<li>verbose - true or false</li>
</ul>
<p>Let us evaluate the model, which we created in the previous chapter using test data.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="c1"># Load compiled model</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">load_model</span><span class="p">(</span><span class="s2">&#34;train_data_model.b&#34;</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">test_data</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>Prediction</strong></p>
<p>Prediction is fitting a shape that gets as close to the data as possible. The object we’re fitting is more of a skeleton that goes through one body of data instead of a fence that goes between separate bodies of data.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="c1"># Load image from filename</span>
<span class="k">def</span> <span class="nf">load</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
   <span class="n">np_image</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
   <span class="n">np_image</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np_image</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;int32&#39;</span><span class="p">)</span><span class="o">/</span><span class="mi">255</span>
   <span class="n">np_image</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="n">np_image</span><span class="p">,</span> <span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
   <span class="n">np_image</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">np_image</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
   <span class="k">return</span> <span class="n">np_image</span>

<span class="k">def</span> <span class="nf">prediction</span><span class="p">(</span><span class="n">image</span><span class="p">):</span>
  <span class="n">np_image</span> <span class="o">=</span> <span class="n">load</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
  <span class="n">prediction</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">np_image</span><span class="p">)</span> <span class="c1"># Predict input image</span>
  <span class="n">result</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">&gt;=</span><span class="mf">0.5</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">prediction</span><span class="p">]</span> <span class="c1"># Normalize prediction</span>
  <span class="k">if</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
    <span class="k">return</span> <span class="kc">False</span>
  <span class="k">return</span> <span class="kc">True</span>

<span class="c1">## Test with random data</span>
<span class="n">test1</span> <span class="o">=</span> <span class="n">prediction</span><span class="p">(</span><span class="s2">&#34;test-data/parasitized1.png&#34;</span><span class="p">)</span>
<span class="n">test2</span> <span class="o">=</span> <span class="n">prediction</span><span class="p">(</span><span class="s2">&#34;test-data/parasitized2.png&#34;</span><span class="p">)</span>
<span class="n">test3</span> <span class="o">=</span> <span class="n">prediction</span><span class="p">(</span><span class="s2">&#34;test-data/parasitized3.png&#34;</span><span class="p">)</span>
<span class="n">test4</span> <span class="o">=</span> <span class="n">prediction</span><span class="p">(</span><span class="s2">&#34;test-data/parasitized4.png&#34;</span><span class="p">)</span>
<span class="n">test5</span> <span class="o">=</span> <span class="n">prediction</span><span class="p">(</span><span class="s2">&#34;test-data/uninfected1.png&#34;</span><span class="p">)</span>
<span class="n">test6</span> <span class="o">=</span> <span class="n">prediction</span><span class="p">(</span><span class="s2">&#34;test-data/uninfected2.png&#34;</span><span class="p">)</span>
<span class="n">test7</span> <span class="o">=</span> <span class="n">prediction</span><span class="p">(</span><span class="s2">&#34;test-data/uninfected3.png&#34;</span><span class="p">)</span>
<span class="n">test8</span> <span class="o">=</span> <span class="n">prediction</span><span class="p">(</span><span class="s2">&#34;test-data/uninfected4.png&#34;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Result for infected or uninfected of malaria&#34;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Test 1: &#34;</span><span class="p">,</span> <span class="n">test1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Test 2: &#34;</span><span class="p">,</span> <span class="n">test2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Test 3: &#34;</span><span class="p">,</span> <span class="n">test3</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Test 4: &#34;</span><span class="p">,</span> <span class="n">test4</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Test 5: &#34;</span><span class="p">,</span> <span class="n">test5</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Test 6: &#34;</span><span class="p">,</span> <span class="n">test6</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Test 7: &#34;</span><span class="p">,</span> <span class="n">test7</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Test 8: &#34;</span><span class="p">,</span> <span class="n">test8</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><a class="post-dummy-target" id="source"></a><h2>Source</h2>
<p>You can clone or download the source in</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash">https://github.com/piinalpin/research-collection/tree/master/tensorflow/malaria-detection
</code></pre></td></tr></table>
</div>
</div><a class="post-dummy-target" id="reference"></a><h3>Reference</h3>
<ul>
<li><a href="https://en.wikipedia.org/wiki/Digital_image_processing">Digital Image Processing - Wikipedia</a></li>
<li><a href="https://www.tensorflow.org/api_docs/python/tf/keras/Sequential">Tensorflow Sequential</a></li>
<li><a href="https://towardsdatascience.com/classification-regression-and-prediction-whats-the-difference-5423d9efe4ec">Classification, regression, and prediction — what’s the difference?</a></li>
<li><a href="https://www.tutorialspoint.com/keras/keras_model_evaluation_and_prediction.htm">Model Evaluation and Model Prediction</a></li>
<li><a href="https://docs.aws.amazon.com/machine-learning/latest/dg/training-ml-models.html">Training ML Models</a></li>
<li><a href="https://research.aimultiple.com/data-augmentation/">What is Data Augmentation? Techniques, Benefit &amp; Examples</a></li>
</ul>
        </div>

        <div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>This article is updated with 2021-12-10</span>
            </div>
            <div class="post-info-license">
                
            </div>
        </div>
        <div class="post-info-line">
            <div class="post-info-md">
                
                    
                        <span><a class="link-to-markdown" href="https://blog.piinalpin.com/2021/12/image-processing-using-tensorflow/index.md" target="_blank"></a></span>
                    
                
            </div>
            <div class="post-info-share">
                
                    <span>
    
        <a href="//twitter.com/share?url=https%3a%2f%2fblog.piinalpin.com%2f2021%2f12%2fimage-processing-using-tensorflow%2f&amp;text=Image%20Processing%20Using%20Tensorflow%20-%20Convolutional%20Neural%20Network%20%28CNN%29&amp;via=piinalpin" target="_blank" title="Share on Twitter">
            <i class="fab fa-twitter fa-fw"></i>
        </a>
    
    
        <a href="//www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fblog.piinalpin.com%2f2021%2f12%2fimage-processing-using-tensorflow%2f" target="_blank" title="Share on Facebook">
            <i class="fab fa-facebook-square fa-fw"></i>
        </a>
    
    
        <a href="//reddit.com/submit?url=https%3a%2f%2fblog.piinalpin.com%2f2021%2f12%2fimage-processing-using-tensorflow%2f&amp;title=Image%20Processing%20Using%20Tensorflow%20-%20Convolutional%20Neural%20Network%20%28CNN%29" target="_blank" title="Share on Reddit">
            <i class="fab fa-reddit fa-fw"></i>
        </a>
    
    
        <a href="//www.linkedin.com/shareArticle?url=https%3a%2f%2fblog.piinalpin.com%2f2021%2f12%2fimage-processing-using-tensorflow%2f&amp;title=Image%20Processing%20Using%20Tensorflow%20-%20Convolutional%20Neural%20Network%20%28CNN%29" target="_blank" title="Share on LinkedIn">
            <i class="fab fa-linkedin fa-fw"></i>
        </a>
    
    
    
    
    
    
    
</span>
                
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section>
            
                
                    <span class="tag">
                        <a href="https://blog.piinalpin.com/tags/image-processing/"><i class="fas fa-tag fa-fw"></i>Image Processing</a>
                    </span>
                
                    <span class="tag">
                        <a href="https://blog.piinalpin.com/tags/tensorflow/"><i class="fas fa-tag fa-fw"></i>Tensorflow</a>
                    </span>
                
                    <span class="tag">
                        <a href="https://blog.piinalpin.com/tags/artificial-intelligence/"><i class="fas fa-tag fa-fw"></i>Artificial Intelligence</a>
                    </span>
                
                    <span class="tag">
                        <a href="https://blog.piinalpin.com/tags/keras/"><i class="fas fa-tag fa-fw"></i>Keras</a>
                    </span>
                
                    <span class="tag">
                        <a href="https://blog.piinalpin.com/tags/python/"><i class="fas fa-tag fa-fw"></i>Python</a>
                    </span>
                
            
        </section>
        <section>
            <span><a href="javascript:window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="https://blog.piinalpin.com/">Home</a></span>
        </section>
    </div>

    <div class="post-nav">
        
            <a href="https://blog.piinalpin.com/2021/12/orm-nodejs-sequelize/" class="prev" rel="prev" title="Object Relational Mapping Node JS using Sequelize"><i class="fas fa-angle-left fa-fw"></i>Object Relational Mapping Node JS using Sequelize</a>
        
        
            <a href="https://blog.piinalpin.com/2022/02/best-practice-uploading-file-using-rest-template/" class="next" rel="next" title="Best Practice Uploading File Using Spring RestTemplate">Best Practice Uploading File Using Spring RestTemplate<i class="fas fa-angle-right fa-fw"></i></a>
        
    </div>
</div>

        <div class="post-comment">
            
            

            
        </div>
    </article></div>
            </main>
            <footer class="footer">
    <div class="copyright">
        <div class="copyright-line">
            Powered by <a href="https://gohugo.io/" target="_blank" rel="external nofollow noopener noreffer">Hugo</a>&nbsp;|&nbsp;Theme - <a href="https://github.com/dillonzq/LoveIt" target="_blank" rel="external nofollow noopener noreffer">LoveIt<i class="far fa-heart fa-fw"></i></a>
        </div>
        <div class="copyright-line">
            <i class="far fa-copyright fa-fw"></i><span itemprop="copyrightYear">2019 - 2022</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="https://blog.piinalpin.com/">piinalpin</a></span><span class="license">&nbsp;|&nbsp;<a rel="license external nofollow noopener noreffer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span></div>
    </div>
</footer>


    
    




    
    




    
    





    
    



    
    



    
    





    
    





    
    



    
    





    
    




    
    




    
    



    
    





    
    


<script src="/js/lib/jquery/jquery.slim.min.min.js"></script>
<script src="/js/lib/lazysizes/lazysizes.min.min.js"></script>
<script src="/js/lib/smooth-scroll/smooth-scroll.polyfills.min.min.js"></script><script>window.scroll = new SmoothScroll('[data-scroll]', {speed: 300, speedAsDuration: true});</script>


    
    

    

    
        <link rel="stylesheet" href="/css/lib/katex/katex.min.min.css"><script src="/js/lib/katex/katex.min.min.js"></script><script defer src="/js/lib/katex/auto-render.min.min.js" onload="renderMathInElement(document.body);"></script>
    

    

    






<script src="/js/blog.min.js"></script>


    
</div>
        <a href="#" class="dynamic-to-top" id="dynamic-to-top" data-scroll><span>&nbsp;</span></a>
    </body>
</html>