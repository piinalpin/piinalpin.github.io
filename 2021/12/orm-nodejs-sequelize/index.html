<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>Object Relational Mapping Node JS using Sequelize | PiinAlpin</title><meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="robots" content="noodp" />
<meta name="Description" content="Object-Relational Mapping (ORM) is a technique that lets you query and manipulate data from a database using an object-oriented paradigm.">
<link rel="prev" href="https://blog.piinalpin.com/2021/11/cloud-object-storage-spring-boot-with-minio/" />
<link rel="next" href="https://blog.piinalpin.com/2021/12/image-processing-using-tensorflow/" />
<link rel="canonical" href="https://blog.piinalpin.com/2021/12/orm-nodejs-sequelize/" />
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Object Relational Mapping Node JS using Sequelize"/>
<meta name="twitter:description" content="Object-Relational Mapping (ORM) is a technique that lets you query and manipulate data from a database using an object-oriented paradigm."/>
<script type="application/ld+json">
    {
    "@context": "http://schema.org",
    "@type": "BlogPosting",
    "headline": "Object Relational Mapping Node JS using Sequelize",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "https:\/\/blog.piinalpin.com\/2021\/12\/orm-nodejs-sequelize\/"
    },
    
        "image": {
            "@type": "ImageObject",
            "url": "https:\/\/blog.piinalpin.com\/cover.png",
            "width":  800 ,
            "height":  600 
        },
    
    "genre": "posts",
    
        "keywords": "Node JS, Express JS, Javascript, Sequelize, Object Relational Mapping, ORM, ES6, Ecma Script",
    
    "wordcount":  2297 ,
    "url": "https:\/\/blog.piinalpin.com\/2021\/12\/orm-nodejs-sequelize\/",
    
        "datePublished": "2021-12-07T10:31:30\u002b07:00",
    
    
        "dateModified": "2021-12-07T10:31:30\u002b07:00",
    
    
        "license": "This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.",
    
    
        "publisher": {
            "@type": "Organization",
            "name": "Alvinditya Saputra",
            "logo": {
            "@type": "ImageObject",
            "url": "https:\/\/blog.piinalpin.com\/logo.png",
            "width":  127 ,
            "height":  40 
            }
        },
    
    
    "description": "Object-Relational Mapping (ORM) is a technique that lets you query and manipulate data from a database using an object-oriented paradigm."
    }
    </script>
<link rel="stylesheet" href="/css/style.min.css">
<link rel="stylesheet" href="/css/lib/fontawesome-free/all.min.min.css">

<link rel="stylesheet" href="/css/lib/animate/animate.min.min.css">


<script>
  if('serviceWorker' in navigator) {
      navigator.serviceWorker
          .register('/service-worker.js', { scope: '/' })
          .then(function(registration) {
              
          });

      navigator.serviceWorker
          .ready
          .then(function(registration) {
              
          });
  }
</script>
    </head>
    <body>
        <script>
            window.localStorage.getItem('theme') === 'dark';
            document.body.classList.add('dark-theme');
        </script>
        <div class="wrapper">
            <nav class="navbar">
    <div class="navbar-container">
        <div class="navbar-header animated bounceIn">
            <a href="https://blog.piinalpin.com/">PiinAlpin</a>
        </div>
        <div class="navbar-menu">
            
            
                <a class="menu-item" href="https://blog.piinalpin.com/posts" title="">Posts</a>
            
                <a class="menu-item" href="https://blog.piinalpin.com/tags" title="">Tags</a>
            
                <a class="menu-item" href="https://blog.piinalpin.com/categories" title="">Categories</a>
            
                <a class="menu-item" href="https://blog.piinalpin.com/about" title="">About</a>
            
        </div>
    </div>
</nav>
<nav class="navbar-mobile">
     <div class="navbar-container">
        <div class="navbar-header">
            <div class="navbar-header-title animated bounceIn">
                <a href="https://blog.piinalpin.com/">PiinAlpin</a>
            </div>
            <div class="menu-toggle" id="menu-toggle">
                <span></span><span></span><span></span>
            </div>
        </div>
    </div>
</nav><main class="main">
                <div class="container">
                    
    
    
    

    <article class="post-warp">
        <h1 class="post-title animated flipInX">Object Relational Mapping Node JS using Sequelize</h1>

        <div class="post-meta">
            <div class="post-meta-main">
                <a class="author" href="https://blog.piinalpin.com/" rel="author"><i class="fas fa-user-circle fa-fw"></i>piinalpin&nbsp;</a>
                <span class="post-category">
                        included in
                        <i class="far fa-folder fa-fw"></i><a href="https://blog.piinalpin.com/categories/documentation/">Documentation</a>
                            
                    </span>
            </div>
            <div class="post-meta-other">
                <i class="far fa-calendar-alt fa-fw"></i><time datetime=2021-12-07>2021-12-07</time>&nbsp;
                <i class="fas fa-pencil-alt fa-fw"></i>about 2297 words&nbsp;
                <i class="far fa-clock fa-fw"></i>11 min&nbsp;</div>
        </div>

        

        <div class="post-toc" id="post-toc">
                <h2 class="post-toc-title">Table of Contents</h2>
                <div class="post-toc-content">
                    <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#prerequisites">Prerequisites</a></li>
        <li><a href="#overview">Overview</a></li>
        <li><a href="#project-setup-and-dependencies">Project Setup and Dependencies</a></li>
        <li><a href="#implementation">Implementation</a></li>
        <li><a href="#clone-or-download">Clone or download</a></li>
        <li><a href="#references">References</a></li>
      </ul>
    </li>
  </ul>
</nav>
                </div>
            </div>
            <div class="post-toc-mobile" id="post-toc-mobile">
                <details>
                    <summary><div class="post-toc-title"><span>Table of Contents</span><span><i class="details icon fas fa-angle-down"></i></span></div></summary>
                    <div class="post-toc-content">
                        
                        
                        <nav id="TableOfContentsMobile">
  <ul>
    <li>
      <ul>
        <li><a href="#prerequisites">Prerequisites</a></li>
        <li><a href="#overview">Overview</a></li>
        <li><a href="#project-setup-and-dependencies">Project Setup and Dependencies</a></li>
        <li><a href="#implementation">Implementation</a></li>
        <li><a href="#clone-or-download">Clone or download</a></li>
        <li><a href="#references">References</a></li>
      </ul>
    </li>
  </ul>
</nav>
                    </div>
                </details>
            </div>

        <div class="post-content">
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            <a class="post-dummy-target" id="prerequisites"></a><h3>Prerequisites</h3>
<ul>
<li><a href="https://nodejs.org/en/">Node JS</a></li>
</ul>
<a class="post-dummy-target" id="overview"></a><h3>Overview</h3>
<p><img src="/images/orm-nodejs-1.png" alt="Object-Relational Mapping"></p>
<p>Object-Relational Mapping (ORM) is a technique that lets you query and manipulate data from a database using an object-oriented paradigm. When talking about ORM, most people are referring to a library that implements the Object-Relational Mapping technique, hence the phrase &ldquo;an ORM&rdquo;.</p>
<a class="post-dummy-target" id="project-setup-and-dependencies"></a><h3>Project Setup and Dependencies</h3>
<p>Create account in <a href="https://www.clever-cloud.com">Clever Cloud</a> and create a database account, we will use a <code>Postgre SQL</code> for the database.</p>
<p>Choose <code>Personal Space -&gt; Create -&gt; ad add-on</code> then choose a <code>Postgre SQL</code> and click select. After that choose a plan like below.</p>
<p><img src="/images/orm-nodejs-2.png" alt="Clever Cloud Personal Space"></p>
<p><img src="/images/orm-nodejs-3.png" alt="Clever Cloud Postgre SQL"></p>
<p><img src="/images/orm-nodejs-4.png" alt="Clever Cloud Postgre SQL Plan"></p>
<p>Create a project, I use <code>yarn</code> package manager for creating this project. And fill the answer from the question of creating a project.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash">mkdir orm-nodejs
<span class="nb">cd</span> orm-nodejs
yarn init
</code></pre></td></tr></table>
</div>
</div><p>Create <code>.env</code> file and fill like below.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"># Server
SERVER_PORT=8000

# Database
DB_HOST=&lt;YOUR DATABASE HOST&gt;
DB_USER=&lt;YOUR DATABASE USER&gt;
DB_PASSWORD=&lt;YOUR DATABASE PASSWORD&gt;
DB_PORT=&lt;YOUR DATABASE PORT&gt;
DB_NAME=&lt;YOUR DATABASE NAME&gt;
DB_DIALECT=&lt;YOUR DATABASE DIALECT&gt;
</code></pre></td></tr></table>
</div>
</div><p><strong>Project Structure</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">.
├── ...
├── app
│   └── config/
│   ├── model/
│   ├── routes/
│   ├── service/
│   ├── util/
│   └── ...
└── .env
└── package.json
└── routes.js
└── schemas.sql
└── server.js
└── yarn.lock
└── ...
</code></pre></td></tr></table>
</div>
</div><p><strong>Database Design</strong></p>
<p><img src="/images/orm-nodejs-5.png" alt="Database Design"></p>
<p>I design table for this case using <a href="https://dbdiagram.io/d">dbdiagram.io</a> and I was create a schemas that can be use to import like following code.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="k">CREATE</span><span class="w"> </span><span class="n">SEQUENCE</span><span class="w"> </span><span class="n">id_transaction_seq</span><span class="w"> </span><span class="k">start</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">increment</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w">
</span><span class="w"></span><span class="k">CREATE</span><span class="w"> </span><span class="n">SEQUENCE</span><span class="w"> </span><span class="n">id_transaction_detail_seq</span><span class="w"> </span><span class="k">start</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">increment</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w">
</span><span class="w">
</span><span class="w"></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="s2">&#34;transaction&#34;</span><span class="w"> </span><span class="p">(</span><span class="w">
</span><span class="w">  </span><span class="s2">&#34;id&#34;</span><span class="w"> </span><span class="nb">bigint</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="n">nextval</span><span class="p">(</span><span class="s1">&#39;id_transaction_seq&#39;</span><span class="p">),</span><span class="w">
</span><span class="w">  </span><span class="s2">&#34;created_at&#34;</span><span class="w"> </span><span class="k">TIMESTAMP</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">
</span><span class="w">  </span><span class="s2">&#34;updated_at&#34;</span><span class="w"> </span><span class="k">TIMESTAMP</span><span class="p">,</span><span class="w">
</span><span class="w">  </span><span class="s2">&#34;transaction_ref_number&#34;</span><span class="w"> </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">255</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">
</span><span class="w">  </span><span class="s2">&#34;transaction_date&#34;</span><span class="w"> </span><span class="k">TIMESTAMP</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">
</span><span class="w">  </span><span class="s2">&#34;customer_name&#34;</span><span class="w"> </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">255</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">
</span><span class="w">  </span><span class="s2">&#34;cost&#34;</span><span class="w"> </span><span class="nb">bigint</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">
</span><span class="w">  </span><span class="s2">&#34;shipping_cost&#34;</span><span class="w"> </span><span class="nb">bigint</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="w">
</span><span class="w"></span><span class="p">);</span><span class="w">
</span><span class="w">
</span><span class="w"></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="s2">&#34;transaction_detail&#34;</span><span class="w"> </span><span class="p">(</span><span class="w">
</span><span class="w">  </span><span class="s2">&#34;id&#34;</span><span class="w"> </span><span class="nb">bigint</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="n">nextval</span><span class="p">(</span><span class="s1">&#39;id_transaction_detail_seq&#39;</span><span class="p">),</span><span class="w">
</span><span class="w">  </span><span class="s2">&#34;created_at&#34;</span><span class="w"> </span><span class="k">TIMESTAMP</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">
</span><span class="w">  </span><span class="s2">&#34;updated_at&#34;</span><span class="w"> </span><span class="k">TIMESTAMP</span><span class="p">,</span><span class="w">
</span><span class="w">  </span><span class="s2">&#34;transaction_id&#34;</span><span class="w"> </span><span class="nb">bigint</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">
</span><span class="w">  </span><span class="s2">&#34;stuff&#34;</span><span class="w"> </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">255</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">
</span><span class="w">  </span><span class="s2">&#34;price&#34;</span><span class="w"> </span><span class="nb">bigint</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">
</span><span class="w">  </span><span class="s2">&#34;qty&#34;</span><span class="w"> </span><span class="nb">int</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">
</span><span class="w">  </span><span class="s2">&#34;total&#34;</span><span class="w"> </span><span class="nb">bigint</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">
</span><span class="w">  </span><span class="k">CONSTRAINT</span><span class="w"> </span><span class="n">fk_transaction</span><span class="w"> </span><span class="k">FOREIGN</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">transaction_id</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="k">transaction</span><span class="p">(</span><span class="n">id</span><span class="p">)</span><span class="w">
</span><span class="w"></span><span class="p">);</span><span class="w">
</span></code></pre></td></tr></table>
</div>
</div><p><strong>Install Dependency</strong></p>
<p>Install the required dependencies, type yarn command in terminal like below.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash">yarn add express sequelize dotenv pg pg-hstore cors nodemon
</code></pre></td></tr></table>
</div>
</div><p>Add codes below into <code>package.json</code>.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="s2">&#34;scripts&#34;</span><span class="err">:</span> <span class="p">{</span>
    <span class="nt">&#34;dev&#34;</span><span class="p">:</span> <span class="s2">&#34;nodemon server&#34;</span>
<span class="p">}</span><span class="err">,</span>
<span class="s2">&#34;type&#34;</span><span class="err">:</span> <span class="s2">&#34;module&#34;</span><span class="err">,</span>
</code></pre></td></tr></table>
</div>
</div><a class="post-dummy-target" id="implementation"></a><h3>Implementation</h3>
<p><strong>Create Initial Routes and Server</strong></p>
<p>Create an initial routes like below.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="kr">import</span> <span class="p">{</span> <span class="nx">Router</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;express&#39;</span><span class="p">;</span>

<span class="kr">const</span> <span class="nx">router</span> <span class="o">=</span> <span class="nx">Router</span><span class="p">();</span>

<span class="nx">router</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">,</span> <span class="nx">next</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
    <span class="nx">res</span><span class="p">.</span><span class="nx">json</span><span class="p">({</span><span class="nx">message</span><span class="o">:</span> <span class="s1">&#39;ok&#39;</span><span class="p">});</span>
<span class="p">});</span>

<span class="kr">export</span> <span class="k">default</span> <span class="nx">router</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><p>Create a server to provide the api, fill the code like below.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="kr">import</span> <span class="nx">express</span><span class="p">,</span> <span class="p">{</span> <span class="nx">json</span><span class="p">,</span> <span class="nx">urlencoded</span> <span class="p">}</span> <span class="nx">from</span> <span class="s2">&#34;express&#34;</span><span class="p">;</span>
<span class="kr">import</span> <span class="nx">cors</span> <span class="nx">from</span> <span class="s2">&#34;cors&#34;</span><span class="p">;</span>
<span class="kr">import</span> <span class="nx">dotenv</span> <span class="nx">from</span> <span class="s2">&#34;dotenv&#34;</span><span class="p">;</span>
<span class="kr">import</span> <span class="nx">routes</span> <span class="nx">from</span>  <span class="s2">&#34;./routes.js&#34;</span><span class="p">;</span>

<span class="nx">dotenv</span><span class="p">.</span><span class="nx">config</span><span class="p">();</span>
<span class="kr">const</span> <span class="nx">app</span> <span class="o">=</span> <span class="nx">express</span><span class="p">();</span>
<span class="kr">const</span> <span class="nx">PORT</span> <span class="o">=</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">SERVER_PORT</span><span class="p">;</span>

<span class="kd">var</span> <span class="nx">corsOptions</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">origin</span><span class="o">:</span> <span class="s2">&#34;http://localhost:8000&#34;</span>
<span class="p">};</span>

<span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">cors</span><span class="p">(</span><span class="nx">corsOptions</span><span class="p">));</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">json</span><span class="p">());</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">urlencoded</span><span class="p">({</span> 
    <span class="nx">extended</span><span class="o">:</span> <span class="kc">true</span> 
<span class="p">}));</span>

<span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="s1">&#39;/api&#39;</span><span class="p">,</span> <span class="nx">routes</span><span class="p">);</span>

<span class="nx">app</span><span class="p">.</span><span class="nx">listen</span><span class="p">(</span><span class="nx">PORT</span><span class="p">,</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;Running on port &#34;</span><span class="p">,</span> <span class="nx">PORT</span><span class="p">);</span>
<span class="p">});</span>
</code></pre></td></tr></table>
</div>
</div><p>Try to run with <code>yarn run dev</code> and consume base path with <code>curl http://localhost:8000/api/</code> in terminal like below. And we should get an output <code>{&quot;message&quot;:&quot;ok&quot;}</code></p>
<p><strong>Database Configuration</strong></p>
<p>Create database configuration with <code>.env</code> file to load properties in <code>app/config/database.js</code> like following code.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="kr">import</span> <span class="nx">dotenv</span> <span class="nx">from</span> <span class="s1">&#39;dotenv&#39;</span><span class="p">;</span>
<span class="kr">import</span> <span class="p">{</span> <span class="nx">Sequelize</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;sequelize&#39;</span><span class="p">;</span>
<span class="nx">dotenv</span><span class="p">.</span><span class="nx">config</span><span class="p">();</span>

<span class="kr">const</span> <span class="nx">db</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Sequelize</span><span class="p">(</span>
    <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">DB_NAME</span><span class="p">,</span>
    <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">DB_USER</span><span class="p">,</span>
    <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">DB_PASSWORD</span><span class="p">,</span>
    <span class="p">{</span>
        <span class="nx">host</span><span class="o">:</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">DB_HOST</span><span class="p">,</span>
        <span class="nx">dialect</span><span class="o">:</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">DB_DIALECT</span><span class="p">,</span>
        <span class="nx">pool</span><span class="o">:</span> <span class="p">{</span>
            <span class="nx">max</span><span class="o">:</span> <span class="mi">5</span><span class="p">,</span>
            <span class="nx">min</span><span class="o">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="nx">acquire</span><span class="o">:</span> <span class="mi">30000</span><span class="p">,</span>
            <span class="nx">idle</span><span class="o">:</span> <span class="mi">10000</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">)</span>

<span class="kr">export</span> <span class="k">default</span> <span class="nx">db</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>Model</strong></p>
<p>Create model <code>transaction</code> and <code>transaction_detail</code> in <code>app/model/**</code>. First, we create <code>transaction.js</code> like following code.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="kr">import</span> <span class="nx">Sequelize</span> <span class="nx">from</span> <span class="s1">&#39;sequelize&#39;</span><span class="p">;</span>
<span class="kr">import</span> <span class="nx">db</span> <span class="nx">from</span> <span class="s1">&#39;../config/database.js&#39;</span><span class="p">;</span>

<span class="kr">const</span> <span class="nx">Transaction</span> <span class="o">=</span> <span class="nx">db</span><span class="p">.</span><span class="nx">define</span><span class="p">(</span><span class="s1">&#39;transaction&#39;</span><span class="p">,</span> <span class="p">{</span>
    <span class="nx">id</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">type</span><span class="o">:</span> <span class="nx">Sequelize</span><span class="p">.</span><span class="nx">INTEGER</span><span class="p">,</span>
        <span class="nx">primaryKey</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
        <span class="nx">allowNull</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
        <span class="nx">defaultValue</span><span class="o">:</span> <span class="nx">db</span><span class="p">.</span><span class="nx">Sequelize</span><span class="p">.</span><span class="nx">literal</span><span class="p">(</span><span class="s2">&#34;nextval(&#39;id_transaction_seq&#39;)&#34;</span><span class="p">)</span>
    <span class="p">},</span>
    <span class="nx">createdAt</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">type</span><span class="o">:</span> <span class="nx">Sequelize</span><span class="p">.</span><span class="nx">DATE</span><span class="p">,</span>
        <span class="nx">defaultValue</span><span class="o">:</span> <span class="nx">Sequelize</span><span class="p">.</span><span class="nx">NOW</span><span class="p">,</span>
        <span class="nx">allowNull</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
        <span class="nx">allowNull</span><span class="o">:</span> <span class="kc">false</span>
    <span class="p">},</span>
    <span class="nx">updatedAt</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">type</span><span class="o">:</span> <span class="nx">Sequelize</span><span class="p">.</span><span class="nx">DATE</span><span class="p">,</span>
        <span class="nx">defaultValue</span><span class="o">:</span> <span class="nx">Sequelize</span><span class="p">.</span><span class="nx">NOW</span><span class="p">,</span>
        <span class="nx">allowNull</span><span class="o">:</span> <span class="kc">false</span>
    <span class="p">},</span>
    <span class="nx">transactionRefNumber</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">type</span><span class="o">:</span> <span class="nx">Sequelize</span><span class="p">.</span><span class="nx">STRING</span><span class="p">,</span>
        <span class="nx">allowNull</span><span class="o">:</span> <span class="kc">false</span>
    <span class="p">},</span>
    <span class="nx">transactionDate</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">type</span><span class="o">:</span> <span class="nx">Sequelize</span><span class="p">.</span><span class="nx">DATE</span><span class="p">,</span>
        <span class="nx">allowNull</span><span class="o">:</span> <span class="kc">false</span>
    <span class="p">},</span>
    <span class="nx">customerName</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">type</span><span class="o">:</span> <span class="nx">Sequelize</span><span class="p">.</span><span class="nx">STRING</span><span class="p">,</span>
        <span class="nx">allowNull</span><span class="o">:</span> <span class="kc">false</span>
    <span class="p">},</span>
    <span class="nx">cost</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">type</span><span class="o">:</span> <span class="nx">Sequelize</span><span class="p">.</span><span class="nx">BIGINT</span><span class="p">,</span>
        <span class="nx">allowNull</span><span class="o">:</span> <span class="kc">false</span>
    <span class="p">},</span>
    <span class="nx">shippingCost</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">type</span><span class="o">:</span> <span class="nx">Sequelize</span><span class="p">.</span><span class="nx">BIGINT</span><span class="p">,</span>
        <span class="nx">allowNull</span><span class="o">:</span> <span class="kc">false</span>
    <span class="p">}</span>
<span class="p">},</span> <span class="p">{</span>
    <span class="nx">tableName</span><span class="o">:</span> <span class="s1">&#39;transaction&#39;</span><span class="p">,</span>
    <span class="nx">underscored</span><span class="o">:</span> <span class="kc">true</span>
<span class="p">});</span>

<span class="kr">export</span> <span class="k">default</span> <span class="nx">Transaction</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><p>And <code>transactionDetail.js</code> model like following code.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="kr">import</span> <span class="nx">Sequelize</span> <span class="nx">from</span> <span class="s1">&#39;sequelize&#39;</span><span class="p">;</span>
<span class="kr">import</span> <span class="nx">db</span> <span class="nx">from</span> <span class="s1">&#39;../config/database.js&#39;</span><span class="p">;</span>
<span class="kr">import</span> <span class="nx">Transaction</span> <span class="nx">from</span> <span class="s1">&#39;./transaction.js&#39;</span><span class="p">;</span>

<span class="kr">const</span> <span class="nx">TransactionDetail</span> <span class="o">=</span> <span class="nx">db</span><span class="p">.</span><span class="nx">define</span><span class="p">(</span><span class="s1">&#39;transaction_detail&#39;</span><span class="p">,</span> <span class="p">{</span>
    <span class="nx">id</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">type</span><span class="o">:</span> <span class="nx">Sequelize</span><span class="p">.</span><span class="nx">INTEGER</span><span class="p">,</span>
        <span class="nx">primaryKey</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
        <span class="nx">allowNull</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
        <span class="nx">defaultValue</span><span class="o">:</span> <span class="nx">db</span><span class="p">.</span><span class="nx">Sequelize</span><span class="p">.</span><span class="nx">literal</span><span class="p">(</span><span class="s2">&#34;nextval(&#39;id_transaction_detail_seq&#39;)&#34;</span><span class="p">)</span>
    <span class="p">},</span>
    <span class="nx">createdAt</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">type</span><span class="o">:</span> <span class="nx">Sequelize</span><span class="p">.</span><span class="nx">DATE</span><span class="p">,</span>
        <span class="nx">defaultValue</span><span class="o">:</span> <span class="nx">Sequelize</span><span class="p">.</span><span class="nx">NOW</span><span class="p">,</span>
        <span class="nx">allowNull</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
        <span class="nx">allowNull</span><span class="o">:</span> <span class="kc">false</span>
    <span class="p">},</span>
    <span class="nx">updatedAt</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">type</span><span class="o">:</span> <span class="nx">Sequelize</span><span class="p">.</span><span class="nx">DATE</span><span class="p">,</span>
        <span class="nx">defaultValue</span><span class="o">:</span> <span class="nx">Sequelize</span><span class="p">.</span><span class="nx">NOW</span><span class="p">,</span>
        <span class="nx">allowNull</span><span class="o">:</span> <span class="kc">false</span>
    <span class="p">},</span>
    <span class="nx">transactionId</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">type</span><span class="o">:</span> <span class="nx">Sequelize</span><span class="p">.</span><span class="nx">BIGINT</span><span class="p">,</span>
        <span class="nx">allowNull</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
        <span class="nx">references</span><span class="o">:</span> <span class="p">{</span>
            <span class="nx">model</span><span class="o">:</span> <span class="s1">&#39;transaction&#39;</span><span class="p">,</span> <span class="c1">// &#39;transaction&#39; refer to table name
</span><span class="c1"></span>            <span class="nx">key</span><span class="o">:</span> <span class="s1">&#39;id&#39;</span>
        <span class="p">}</span>
    <span class="p">},</span>
    <span class="nx">stuff</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">type</span><span class="o">:</span> <span class="nx">Sequelize</span><span class="p">.</span><span class="nx">STRING</span><span class="p">,</span>
        <span class="nx">allowNull</span><span class="o">:</span> <span class="kc">false</span>
    <span class="p">},</span>
    <span class="nx">price</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">type</span><span class="o">:</span> <span class="nx">Sequelize</span><span class="p">.</span><span class="nx">BIGINT</span><span class="p">,</span>
        <span class="nx">allowNull</span><span class="o">:</span> <span class="kc">false</span>
    <span class="p">},</span>
    <span class="nx">qty</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">type</span><span class="o">:</span> <span class="nx">Sequelize</span><span class="p">.</span><span class="nx">BIGINT</span><span class="p">,</span>
        <span class="nx">allowNull</span><span class="o">:</span> <span class="kc">false</span>
    <span class="p">},</span>
    <span class="nx">total</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">type</span><span class="o">:</span> <span class="nx">Sequelize</span><span class="p">.</span><span class="nx">BIGINT</span><span class="p">,</span>
        <span class="nx">allowNull</span><span class="o">:</span> <span class="kc">false</span>
    <span class="p">}</span>
<span class="p">},</span> <span class="p">{</span>
    <span class="nx">tableName</span><span class="o">:</span> <span class="s1">&#39;transaction_detail&#39;</span><span class="p">,</span>
    <span class="nx">underscored</span><span class="o">:</span> <span class="kc">true</span>
<span class="p">});</span>

<span class="nx">TransactionDetail</span><span class="p">.</span><span class="nx">belongsTo</span><span class="p">(</span><span class="nx">Transaction</span><span class="p">,</span> <span class="p">{</span> <span class="nx">as</span><span class="o">:</span> <span class="s1">&#39;transaction&#39;</span><span class="p">,</span> <span class="nx">foreignKey</span><span class="o">:</span> <span class="s1">&#39;transactionId&#39;</span><span class="p">,</span> <span class="nx">targetKey</span><span class="o">:</span> <span class="s1">&#39;id&#39;</span> <span class="p">});</span>
<span class="kr">export</span> <span class="k">default</span> <span class="nx">TransactionDetail</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><p>Take note for this line</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="nx">TransactionDetail</span><span class="p">.</span><span class="nx">belongsTo</span><span class="p">(</span><span class="nx">Transaction</span><span class="p">,</span> <span class="p">{</span> <span class="nx">as</span><span class="o">:</span> <span class="s1">&#39;transaction&#39;</span><span class="p">,</span> <span class="nx">foreignKey</span><span class="o">:</span> <span class="s1">&#39;transactionId&#39;</span><span class="p">,</span> <span class="nx">targetKey</span><span class="o">:</span> <span class="s1">&#39;id&#39;</span> <span class="p">});</span>
</code></pre></td></tr></table>
</div>
</div><p>That mean, <code>TransactionDetail</code> have a constraint to <code>Transaction</code> model.</p>
<p><strong>Service to Create a new Transaction</strong></p>
<p>Create <code>app/service/transactionService.js</code> and create method to insert a new transaction like following code.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="kr">import</span> <span class="nx">Transaction</span> <span class="nx">from</span> <span class="s1">&#39;../model/transaction.js&#39;</span><span class="p">;</span>
<span class="kr">import</span> <span class="nx">TransactionDetail</span> <span class="nx">from</span> <span class="s1">&#39;../model/transactionDetail.js&#39;</span><span class="p">;</span>
<span class="kr">import</span> <span class="nx">db</span> <span class="nx">from</span> <span class="s1">&#39;../config/database.js&#39;</span>

<span class="kr">export</span> <span class="kr">const</span> <span class="nx">create</span> <span class="o">=</span> <span class="kr">async</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">,</span> <span class="nx">next</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Start execute create new transaction&#39;</span><span class="p">);</span>

    <span class="kd">let</span> <span class="nx">t</span><span class="p">;</span>

    <span class="c1">// Get request body
</span><span class="c1"></span>    <span class="kr">const</span> <span class="nx">request</span> <span class="o">=</span> <span class="nx">req</span><span class="p">.</span><span class="nx">body</span><span class="p">;</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Request::: &#39;</span> <span class="o">+</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">request</span><span class="p">));</span>

    <span class="k">try</span> <span class="p">{</span>
        <span class="c1">// define managed transaction
</span><span class="c1"></span>        <span class="nx">t</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">db</span><span class="p">.</span><span class="nx">transaction</span><span class="p">();</span>

        <span class="kr">const</span> <span class="nx">transaction</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">Transaction</span><span class="p">.</span><span class="nx">create</span><span class="p">({</span>
            <span class="nx">transactionRefNumber</span><span class="o">:</span> <span class="nx">request</span><span class="p">.</span><span class="nx">transactionRefNumber</span><span class="p">,</span>
            <span class="nx">transactionDate</span><span class="o">:</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">(),</span>
            <span class="nx">customerName</span><span class="o">:</span> <span class="nx">request</span><span class="p">.</span><span class="nx">customerName</span><span class="p">,</span>
            <span class="nx">cost</span><span class="o">:</span> <span class="nx">request</span><span class="p">.</span><span class="nx">cost</span><span class="p">,</span>
            <span class="nx">shippingCost</span><span class="o">:</span> <span class="nx">request</span><span class="p">.</span><span class="nx">shippingCost</span>
        <span class="p">},</span> <span class="p">{</span>
            <span class="nx">transaction</span><span class="o">:</span> <span class="nx">t</span>
        <span class="p">});</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Transaction:: &#39;</span> <span class="o">+</span> <span class="nx">transaction</span><span class="p">);</span>

        <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">request</span><span class="p">.</span><span class="nx">details</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="kr">const</span> <span class="nx">detail</span> <span class="o">=</span> <span class="nx">request</span><span class="p">.</span><span class="nx">details</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
            <span class="kr">await</span> <span class="nx">TransactionDetail</span><span class="p">.</span><span class="nx">create</span><span class="p">({</span>
                <span class="nx">transactionId</span><span class="o">:</span> <span class="nx">transaction</span><span class="p">.</span><span class="nx">id</span><span class="p">,</span>
                <span class="nx">stuff</span><span class="o">:</span> <span class="nx">detail</span><span class="p">.</span><span class="nx">stuff</span><span class="p">,</span>
                <span class="nx">price</span><span class="o">:</span> <span class="nx">detail</span><span class="p">.</span><span class="nx">price</span><span class="p">,</span>
                <span class="nx">qty</span><span class="o">:</span> <span class="nx">detail</span><span class="p">.</span><span class="nx">qty</span><span class="p">,</span>
                <span class="nx">total</span><span class="o">:</span> <span class="nx">detail</span><span class="p">.</span><span class="nx">total</span><span class="p">,</span>
            <span class="p">},</span> <span class="p">{</span>
                <span class="nx">transaction</span><span class="o">:</span> <span class="nx">t</span>
            <span class="p">});</span>
        <span class="p">}</span>

        <span class="c1">// Commit managed transaction
</span><span class="c1"></span>        <span class="kr">await</span> <span class="nx">t</span><span class="p">.</span><span class="nx">commit</span><span class="p">();</span>
        <span class="nx">res</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="nx">transaction</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">catch</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// Rollback managed transaction
</span><span class="c1"></span>        <span class="kr">await</span> <span class="nx">t</span><span class="p">.</span><span class="nx">rollback</span><span class="p">();</span>

        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Happened error when save transaction data. &#39;</span><span class="p">,</span> <span class="nx">err</span><span class="p">);</span>
        <span class="nx">res</span><span class="p">.</span><span class="nx">status</span><span class="p">(</span><span class="mi">500</span><span class="p">).</span><span class="nx">send</span><span class="p">({</span>
            <span class="nx">message</span><span class="o">:</span> <span class="nx">err</span><span class="p">.</span><span class="nx">message</span>
        <span class="p">})</span>
    <span class="p">}</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;End execute create new transaction&#39;</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>In this code, we use a transactional database <code>transaction commit and rollback</code>. So, if we got error when inserting a new row, the database will be rollback to before insert.</p>
<p><strong>Routing</strong></p>
<p>Then, we will create a new routes in <code>app/routes/transactionRoute.js</code> like following code.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="kr">import</span> <span class="p">{</span> <span class="nx">Router</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;express&#39;</span><span class="p">;</span>
<span class="kr">import</span> <span class="o">*</span> <span class="nx">as</span> <span class="nx">transactionService</span> <span class="nx">from</span> <span class="s1">&#39;../service/transactionService.js&#39;</span><span class="p">;</span>

<span class="kr">const</span> <span class="nx">router</span> <span class="o">=</span> <span class="nx">Router</span><span class="p">();</span>

<span class="c1">// Transaction
</span><span class="c1"></span><span class="nx">router</span><span class="p">.</span><span class="nx">post</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="nx">transactionService</span><span class="p">.</span><span class="nx">create</span><span class="p">);</span>

<span class="kr">export</span> <span class="k">default</span> <span class="nx">router</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><p>Lets try to run by typing in your favourite terminal <code>yarn run dev</code>. And open your postman and fill data like below.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="err">POST</span> <span class="err">http://localhost:</span><span class="mi">8000</span><span class="err">/api/transaction</span>

<span class="err">request</span> <span class="err">body:</span>
<span class="p">{</span>
    <span class="nt">&#34;transactionRefNumber&#34;</span><span class="p">:</span> <span class="s2">&#34;120003&#34;</span><span class="p">,</span>
    <span class="nt">&#34;customerName&#34;</span><span class="p">:</span> <span class="s2">&#34;Maverick&#34;</span><span class="p">,</span>
    <span class="nt">&#34;cost&#34;</span><span class="p">:</span> <span class="mi">400000</span><span class="p">,</span>
    <span class="nt">&#34;shippingCost&#34;</span><span class="p">:</span> <span class="mi">18000</span><span class="p">,</span>
    <span class="nt">&#34;details&#34;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="nt">&#34;stuff&#34;</span><span class="p">:</span> <span class="s2">&#34;Speaker&#34;</span><span class="p">,</span>
            <span class="nt">&#34;price&#34;</span><span class="p">:</span> <span class="mi">200000</span><span class="p">,</span>
            <span class="nt">&#34;qty&#34;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
            <span class="nt">&#34;total&#34;</span><span class="p">:</span> <span class="mi">200000</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="nt">&#34;stuff&#34;</span><span class="p">:</span> <span class="s2">&#34;Headset&#34;</span><span class="p">,</span>
            <span class="nt">&#34;price&#34;</span><span class="p">:</span> <span class="mi">180000</span><span class="p">,</span>
            <span class="nt">&#34;qty&#34;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
            <span class="nt">&#34;total&#34;</span><span class="p">:</span> <span class="mi">180000</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="nt">&#34;stuff&#34;</span><span class="p">:</span> <span class="s2">&#34;Case Iphone 6S&#34;</span><span class="p">,</span>
            <span class="nt">&#34;price&#34;</span><span class="p">:</span> <span class="mi">20000</span><span class="p">,</span>
            <span class="nt">&#34;qty&#34;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
            <span class="nt">&#34;total&#34;</span><span class="p">:</span> <span class="mi">20000</span>
        <span class="p">}</span>
    <span class="p">]</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>ANd we should got an output.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="p">{</span>
  <span class="nt">&#34;createdAt&#34;</span><span class="p">:</span> <span class="s2">&#34;2021-12-07T06:53:09.403Z&#34;</span><span class="p">,</span>
  <span class="nt">&#34;updatedAt&#34;</span><span class="p">:</span> <span class="s2">&#34;2021-12-07T06:53:09.410Z&#34;</span><span class="p">,</span>
  <span class="nt">&#34;id&#34;</span><span class="p">:</span> <span class="s2">&#34;15&#34;</span><span class="p">,</span>
  <span class="nt">&#34;transactionRefNumber&#34;</span><span class="p">:</span> <span class="s2">&#34;120003&#34;</span><span class="p">,</span>
  <span class="nt">&#34;transactionDate&#34;</span><span class="p">:</span> <span class="s2">&#34;2021-12-07T06:53:09.401Z&#34;</span><span class="p">,</span>
  <span class="nt">&#34;customerName&#34;</span><span class="p">:</span> <span class="s2">&#34;Maverick&#34;</span><span class="p">,</span>
  <span class="nt">&#34;cost&#34;</span><span class="p">:</span> <span class="s2">&#34;400000&#34;</span><span class="p">,</span>
  <span class="nt">&#34;shippingCost&#34;</span><span class="p">:</span> <span class="s2">&#34;18000&#34;</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>Service to Get All Transaction</strong></p>
<p>After we create a new transaction, we will create a service to get all of transaction or search transaction by parameter. Add the following code into <code>app/service/transactionService.js</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="kr">import</span> <span class="nx">Sequelize</span> <span class="nx">from</span> <span class="s1">&#39;sequelize&#39;</span><span class="p">;</span>

<span class="kr">export</span> <span class="kr">const</span> <span class="nx">getAll</span> <span class="o">=</span> <span class="kr">async</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">,</span> <span class="nx">next</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Start execute find all transaction&#39;</span><span class="p">);</span>
    <span class="kr">const</span> <span class="nx">transactions</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">Transaction</span><span class="p">.</span><span class="nx">findAll</span><span class="p">();</span>
    <span class="nx">res</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="nx">transactions</span><span class="p">);</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;End execute find all transaction&#39;</span><span class="p">);</span>
<span class="p">}</span>

<span class="kr">export</span> <span class="kr">const</span> <span class="nx">search</span> <span class="o">=</span> <span class="kr">async</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">,</span> <span class="nx">next</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Start execute search transaction by parameter&#39;</span><span class="p">);</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Search Request:: &#39;</span> <span class="o">+</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">req</span><span class="p">.</span><span class="nx">body</span><span class="p">));</span>
    <span class="kr">const</span> <span class="nx">transaction</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">Transaction</span><span class="p">.</span><span class="nx">findAll</span><span class="p">({</span>
        <span class="nx">where</span><span class="o">:</span> <span class="p">{</span>
            <span class="nx">transactionRefNumber</span><span class="o">:</span> <span class="p">{</span>
                <span class="p">[</span><span class="nx">Sequelize</span><span class="p">.</span><span class="nx">Op</span><span class="p">.</span><span class="nx">like</span><span class="p">]</span><span class="o">:</span> <span class="s1">&#39;%&#39;</span> <span class="o">+</span> <span class="nx">req</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">transactionRefNumber</span> <span class="o">+</span> <span class="s1">&#39;%&#39;</span>
            <span class="p">},</span>
            <span class="nx">customerName</span><span class="o">:</span> <span class="p">{</span>
                <span class="p">[</span><span class="nx">Sequelize</span><span class="p">.</span><span class="nx">Op</span><span class="p">.</span><span class="nx">like</span><span class="p">]</span><span class="o">:</span> <span class="s1">&#39;%&#39;</span> <span class="o">+</span> <span class="nx">req</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">customerName</span> <span class="o">+</span> <span class="s1">&#39;%&#39;</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">});</span>
    <span class="nx">res</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="nx">transaction</span><span class="p">);</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;End execute search transaction by parameter&#39;</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>Get All Transaction Routes</strong></p>
<p>Then, we will create routes to get all transaction or search transaction data by parameter. Add the following code into <code>app/routes/transactionRoute.js</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="nx">router</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="nx">transactionService</span><span class="p">.</span><span class="nx">getAll</span><span class="p">);</span>
<span class="nx">router</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;/search&#39;</span><span class="p">,</span> <span class="nx">transactionService</span><span class="p">.</span><span class="nx">search</span><span class="p">);</span>
</code></pre></td></tr></table>
</div>
</div><p>Trying our api using postman.</p>
<p>Get all transaction.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="err">GET</span> <span class="err">http://localhost:</span><span class="mi">8000</span><span class="err">/api/transaction</span>

<span class="err">Response:</span>
<span class="p">[</span>
  <span class="p">{</span>
    <span class="nt">&#34;id&#34;</span><span class="p">:</span> <span class="s2">&#34;13&#34;</span><span class="p">,</span>
    <span class="nt">&#34;createdAt&#34;</span><span class="p">:</span> <span class="s2">&#34;2021-12-07T01:20:44.668Z&#34;</span><span class="p">,</span>
    <span class="nt">&#34;updatedAt&#34;</span><span class="p">:</span> <span class="s2">&#34;2021-12-07T01:20:44.670Z&#34;</span><span class="p">,</span>
    <span class="nt">&#34;transactionRefNumber&#34;</span><span class="p">:</span> <span class="s2">&#34;120001&#34;</span><span class="p">,</span>
    <span class="nt">&#34;transactionDate&#34;</span><span class="p">:</span> <span class="s2">&#34;2021-12-07T01:20:44.667Z&#34;</span><span class="p">,</span>
    <span class="nt">&#34;customerName&#34;</span><span class="p">:</span> <span class="s2">&#34;John Doe&#34;</span><span class="p">,</span>
    <span class="nt">&#34;cost&#34;</span><span class="p">:</span> <span class="s2">&#34;320000&#34;</span><span class="p">,</span>
    <span class="nt">&#34;shippingCost&#34;</span><span class="p">:</span> <span class="s2">&#34;8000&#34;</span>
  <span class="p">},</span>
  <span class="p">{</span>
    <span class="nt">&#34;id&#34;</span><span class="p">:</span> <span class="s2">&#34;14&#34;</span><span class="p">,</span>
    <span class="nt">&#34;createdAt&#34;</span><span class="p">:</span> <span class="s2">&#34;2021-12-07T01:21:36.088Z&#34;</span><span class="p">,</span>
    <span class="nt">&#34;updatedAt&#34;</span><span class="p">:</span> <span class="s2">&#34;2021-12-07T01:21:36.090Z&#34;</span><span class="p">,</span>
    <span class="nt">&#34;transactionRefNumber&#34;</span><span class="p">:</span> <span class="s2">&#34;120002&#34;</span><span class="p">,</span>
    <span class="nt">&#34;transactionDate&#34;</span><span class="p">:</span> <span class="s2">&#34;2021-12-07T01:21:36.087Z&#34;</span><span class="p">,</span>
    <span class="nt">&#34;customerName&#34;</span><span class="p">:</span> <span class="s2">&#34;Maverick&#34;</span><span class="p">,</span>
    <span class="nt">&#34;cost&#34;</span><span class="p">:</span> <span class="s2">&#34;200000&#34;</span><span class="p">,</span>
    <span class="nt">&#34;shippingCost&#34;</span><span class="p">:</span> <span class="s2">&#34;18000&#34;</span>
  <span class="p">},</span>
  <span class="p">{</span>
    <span class="nt">&#34;id&#34;</span><span class="p">:</span> <span class="s2">&#34;15&#34;</span><span class="p">,</span>
    <span class="nt">&#34;createdAt&#34;</span><span class="p">:</span> <span class="s2">&#34;2021-12-07T06:53:09.403Z&#34;</span><span class="p">,</span>
    <span class="nt">&#34;updatedAt&#34;</span><span class="p">:</span> <span class="s2">&#34;2021-12-07T06:53:09.410Z&#34;</span><span class="p">,</span>
    <span class="nt">&#34;transactionRefNumber&#34;</span><span class="p">:</span> <span class="s2">&#34;120003&#34;</span><span class="p">,</span>
    <span class="nt">&#34;transactionDate&#34;</span><span class="p">:</span> <span class="s2">&#34;2021-12-07T06:53:09.401Z&#34;</span><span class="p">,</span>
    <span class="nt">&#34;customerName&#34;</span><span class="p">:</span> <span class="s2">&#34;Maverick&#34;</span><span class="p">,</span>
    <span class="nt">&#34;cost&#34;</span><span class="p">:</span> <span class="s2">&#34;400000&#34;</span><span class="p">,</span>
    <span class="nt">&#34;shippingCost&#34;</span><span class="p">:</span> <span class="s2">&#34;18000&#34;</span>
  <span class="p">}</span>
<span class="p">]</span>
</code></pre></td></tr></table>
</div>
</div><p>Search transaction by parameter.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="err">GET</span> <span class="err">http://localhost:</span><span class="mi">8000</span><span class="err">/api/transaction/search</span>

<span class="err">Request</span> <span class="err">Body:</span>
<span class="p">{</span>
    <span class="nt">&#34;transactionRefNumber&#34;</span><span class="p">:</span> <span class="s2">&#34;120003&#34;</span><span class="p">,</span>
    <span class="nt">&#34;customerName&#34;</span><span class="p">:</span> <span class="s2">&#34;&#34;</span>
<span class="p">}</span>

<span class="err">Response:</span>
<span class="p">[</span>
  <span class="p">{</span>
    <span class="nt">&#34;id&#34;</span><span class="p">:</span> <span class="s2">&#34;15&#34;</span><span class="p">,</span>
    <span class="nt">&#34;createdAt&#34;</span><span class="p">:</span> <span class="s2">&#34;2021-12-07T06:53:09.403Z&#34;</span><span class="p">,</span>
    <span class="nt">&#34;updatedAt&#34;</span><span class="p">:</span> <span class="s2">&#34;2021-12-07T06:53:09.410Z&#34;</span><span class="p">,</span>
    <span class="nt">&#34;transactionRefNumber&#34;</span><span class="p">:</span> <span class="s2">&#34;120003&#34;</span><span class="p">,</span>
    <span class="nt">&#34;transactionDate&#34;</span><span class="p">:</span> <span class="s2">&#34;2021-12-07T06:53:09.401Z&#34;</span><span class="p">,</span>
    <span class="nt">&#34;customerName&#34;</span><span class="p">:</span> <span class="s2">&#34;Maverick&#34;</span><span class="p">,</span>
    <span class="nt">&#34;cost&#34;</span><span class="p">:</span> <span class="s2">&#34;400000&#34;</span><span class="p">,</span>
    <span class="nt">&#34;shippingCost&#34;</span><span class="p">:</span> <span class="s2">&#34;18000&#34;</span>
  <span class="p">}</span>
<span class="p">]</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>Transaction Detail Service</strong></p>
<p>Create transaction detail service to search, update, or delete transaction detail in <code>app/service/transactionDetailService.js</code> like following code.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="kr">import</span> <span class="nx">db</span> <span class="nx">from</span> <span class="s1">&#39;../config/database.js&#39;</span>
<span class="kr">import</span> <span class="nx">TransactionDetail</span> <span class="nx">from</span> <span class="s1">&#39;../model/transactionDetail.js&#39;</span><span class="p">;</span>
<span class="kr">import</span> <span class="nx">Sequelize</span> <span class="nx">from</span> <span class="s1">&#39;sequelize&#39;</span><span class="p">;</span>

<span class="kr">export</span> <span class="kr">const</span> <span class="nx">search</span> <span class="o">=</span> <span class="kr">async</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">,</span> <span class="nx">next</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Start execute search transaction detail by parameter&#39;</span><span class="p">);</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Search Request:: &#39;</span> <span class="o">+</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">req</span><span class="p">.</span><span class="nx">body</span><span class="p">));</span>
    <span class="kr">const</span> <span class="nx">transaction</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">TransactionDetail</span><span class="p">.</span><span class="nx">findAll</span><span class="p">({</span>
        <span class="nx">where</span><span class="o">:</span> <span class="p">{</span>
            <span class="p">[</span><span class="nx">Sequelize</span><span class="p">.</span><span class="nx">Op</span><span class="p">.</span><span class="nx">and</span><span class="p">]</span><span class="o">:</span> <span class="p">[</span>
                <span class="p">{</span>
                    <span class="nx">stuff</span><span class="o">:</span> <span class="p">{</span>
                        <span class="p">[</span><span class="nx">Sequelize</span><span class="p">.</span><span class="nx">Op</span><span class="p">.</span><span class="nx">like</span><span class="p">]</span><span class="o">:</span> <span class="s1">&#39;%&#39;</span> <span class="o">+</span> <span class="nx">req</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">stuff</span> <span class="o">+</span> <span class="s1">&#39;%&#39;</span>
                    <span class="p">}</span>
                <span class="p">},</span>
                <span class="nx">Sequelize</span><span class="p">.</span><span class="nx">where</span><span class="p">(</span>
                    <span class="nx">Sequelize</span><span class="p">.</span><span class="nx">cast</span><span class="p">(</span><span class="nx">Sequelize</span><span class="p">.</span><span class="nx">col</span><span class="p">(</span><span class="s1">&#39;transaction_detail.transaction_id&#39;</span><span class="p">),</span> <span class="s1">&#39;varchar&#39;</span><span class="p">),</span>
                    <span class="p">{</span>
                        <span class="p">[</span><span class="nx">Sequelize</span><span class="p">.</span><span class="nx">Op</span><span class="p">.</span><span class="nx">iLike</span><span class="p">]</span><span class="o">:</span> <span class="s1">&#39;%&#39;</span> <span class="o">+</span> <span class="nx">req</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">transactionId</span> <span class="o">+</span> <span class="s1">&#39;%&#39;</span>
                    <span class="p">}</span>
                <span class="p">)</span>
            <span class="p">]</span>
        <span class="p">}</span>
    <span class="p">});</span>
    <span class="nx">res</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="nx">transaction</span><span class="p">);</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;End execute search transaction detail by parameter&#39;</span><span class="p">);</span>
<span class="p">}</span>

<span class="kr">export</span> <span class="kr">const</span> <span class="nx">update</span> <span class="o">=</span> <span class="kr">async</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">,</span> <span class="nx">next</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Start execute update transaction detail&#39;</span><span class="p">);</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Transaction detail update Request:: &#39;</span> <span class="o">+</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">req</span><span class="p">.</span><span class="nx">body</span><span class="p">));</span>

    <span class="kd">let</span> <span class="nx">t</span><span class="p">;</span>

    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Find transaction detail by id:: &#39;</span> <span class="o">+</span> <span class="nx">req</span><span class="p">.</span><span class="nx">params</span><span class="p">.</span><span class="nx">id</span><span class="p">);</span>
    <span class="kr">const</span> <span class="nx">detail</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">TransactionDetail</span><span class="p">.</span><span class="nx">findByPk</span><span class="p">(</span><span class="nx">req</span><span class="p">.</span><span class="nx">params</span><span class="p">.</span><span class="nx">id</span><span class="p">);</span>

    <span class="k">if</span> <span class="p">(</span><span class="kc">null</span> <span class="o">==</span> <span class="nx">detail</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Data transaction detail not found, cancel update data&#39;</span><span class="p">);</span>
        <span class="nx">res</span><span class="p">.</span><span class="nx">send</span><span class="p">({</span><span class="nx">message</span><span class="o">:</span> <span class="s1">&#39;transaction detail: not found&#39;</span><span class="p">});</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">try</span> <span class="p">{</span>
        <span class="nx">t</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">db</span><span class="p">.</span><span class="nx">transaction</span><span class="p">();</span>

        <span class="kr">const</span> <span class="nx">detailToUpdate</span> <span class="o">=</span> <span class="p">{</span>
            <span class="nx">qty</span><span class="o">:</span> <span class="nx">req</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">qty</span><span class="p">,</span>
            <span class="nx">total</span><span class="o">:</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">detail</span><span class="p">.</span><span class="nx">total</span><span class="p">)</span> <span class="o">*</span> <span class="nx">req</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">qty</span>
        <span class="p">}</span>

        <span class="kr">await</span> <span class="nx">TransactionDetail</span><span class="p">.</span><span class="nx">update</span><span class="p">(</span><span class="nx">detailToUpdate</span><span class="p">,</span> <span class="p">{</span>
            <span class="nx">where</span><span class="o">:</span> <span class="p">{</span>
                <span class="nx">id</span><span class="o">:</span> <span class="nx">req</span><span class="p">.</span><span class="nx">params</span><span class="p">.</span><span class="nx">id</span>
            <span class="p">}</span>
        <span class="p">});</span>

        <span class="kr">await</span> <span class="nx">t</span><span class="p">.</span><span class="nx">commit</span><span class="p">();</span>
        <span class="nx">res</span><span class="p">.</span><span class="nx">send</span><span class="p">({</span><span class="nx">message</span><span class="o">:</span> <span class="s1">&#39;success&#39;</span><span class="p">});</span>
    <span class="p">}</span> <span class="k">catch</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
        <span class="kr">await</span> <span class="nx">t</span><span class="p">.</span><span class="nx">rollback</span><span class="p">();</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Happened error when updating transaction detail&#39;</span><span class="p">);</span>
        <span class="nx">res</span><span class="p">.</span><span class="nx">status</span><span class="p">(</span><span class="mi">500</span><span class="p">).</span><span class="nx">send</span><span class="p">({</span>
            <span class="nx">message</span><span class="o">:</span> <span class="nx">err</span><span class="p">.</span><span class="nx">message</span>
        <span class="p">})</span>
    <span class="p">}</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;End execute update transaction detail&#39;</span><span class="p">);</span>
<span class="p">}</span>

<span class="kr">export</span> <span class="kr">const</span> <span class="nx">deleteById</span> <span class="o">=</span> <span class="kr">async</span><span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">,</span> <span class="nx">next</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Start execute delete transaction detail by id&#39;</span><span class="p">);</span>

    <span class="kd">let</span> <span class="nx">t</span><span class="p">;</span>

    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Find transaction detail by id:: &#39;</span> <span class="o">+</span> <span class="nx">req</span><span class="p">.</span><span class="nx">params</span><span class="p">.</span><span class="nx">id</span><span class="p">);</span>
    <span class="kr">const</span> <span class="nx">detail</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">TransactionDetail</span><span class="p">.</span><span class="nx">findByPk</span><span class="p">(</span><span class="nx">req</span><span class="p">.</span><span class="nx">params</span><span class="p">.</span><span class="nx">id</span><span class="p">);</span>

    <span class="k">if</span> <span class="p">(</span><span class="kc">null</span> <span class="o">==</span> <span class="nx">detail</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Data transaction detail not found, cancel update data&#39;</span><span class="p">);</span>
        <span class="nx">res</span><span class="p">.</span><span class="nx">send</span><span class="p">({</span><span class="nx">message</span><span class="o">:</span> <span class="s1">&#39;transaction detail: not found&#39;</span><span class="p">});</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">try</span> <span class="p">{</span>
        <span class="nx">t</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">db</span><span class="p">.</span><span class="nx">transaction</span><span class="p">();</span>

        <span class="kr">await</span> <span class="nx">TransactionDetail</span><span class="p">.</span><span class="nx">destroy</span><span class="p">({</span>
            <span class="nx">where</span><span class="o">:</span> <span class="p">{</span>
                <span class="nx">id</span><span class="o">:</span> <span class="nx">detail</span><span class="p">.</span><span class="nx">id</span>
            <span class="p">}</span>
        <span class="p">});</span>

        <span class="kr">await</span> <span class="nx">t</span><span class="p">.</span><span class="nx">commit</span><span class="p">();</span>
        <span class="nx">res</span><span class="p">.</span><span class="nx">send</span><span class="p">({</span><span class="nx">message</span><span class="o">:</span> <span class="s1">&#39;success&#39;</span><span class="p">});</span>
    <span class="p">}</span> <span class="k">catch</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
        <span class="kr">await</span> <span class="nx">t</span><span class="p">.</span><span class="nx">rollback</span><span class="p">();</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Happened error when deleting transaction detail&#39;</span><span class="p">);</span>
        <span class="nx">res</span><span class="p">.</span><span class="nx">status</span><span class="p">(</span><span class="mi">500</span><span class="p">).</span><span class="nx">send</span><span class="p">({</span>
            <span class="nx">message</span><span class="o">:</span> <span class="nx">err</span><span class="p">.</span><span class="nx">message</span>
        <span class="p">})</span>
    <span class="p">}</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;End execute delete transaction detail by id&#39;</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>Update Transaction Routes</strong></p>
<p>Update transaction routes, add the following code into <code>app/routes/transactionRoute.js</code>.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="kr">import</span> <span class="o">*</span> <span class="nx">as</span> <span class="nx">transactionDetailService</span> <span class="nx">from</span> <span class="s1">&#39;../service/transactionDetailService.js&#39;</span><span class="p">;</span>

<span class="c1">// Detail
</span><span class="c1"></span><span class="nx">router</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;/detail&#39;</span><span class="p">,</span> <span class="nx">transactionDetailService</span><span class="p">.</span><span class="nx">search</span><span class="p">);</span>
<span class="nx">router</span><span class="p">.</span><span class="nx">put</span><span class="p">(</span><span class="s1">&#39;/detail/:id&#39;</span><span class="p">,</span> <span class="nx">transactionDetailService</span><span class="p">.</span><span class="nx">update</span><span class="p">);</span>
<span class="nx">router</span><span class="p">.</span><span class="k">delete</span><span class="p">(</span><span class="s1">&#39;/detail/:id&#39;</span><span class="p">,</span> <span class="nx">transactionDetailService</span><span class="p">.</span><span class="nx">deleteById</span><span class="p">);</span>
</code></pre></td></tr></table>
</div>
</div><p>Test our transaction detail api.</p>
<p>Search all transaction detail by parameter.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="err">GET</span> <span class="err">http://localhost:</span><span class="mi">8000</span><span class="err">/api/transaction/detail</span>

<span class="err">Request</span> <span class="err">Body:</span>
<span class="p">{</span>
    <span class="nt">&#34;transactionId&#34;</span><span class="p">:</span> <span class="mi">15</span><span class="p">,</span>
    <span class="nt">&#34;stuff&#34;</span><span class="p">:</span> <span class="s2">&#34;&#34;</span>
<span class="p">}</span>

<span class="err">Response:</span>
<span class="p">[</span>
  <span class="p">{</span>
    <span class="nt">&#34;id&#34;</span><span class="p">:</span> <span class="s2">&#34;9&#34;</span><span class="p">,</span>
    <span class="nt">&#34;createdAt&#34;</span><span class="p">:</span> <span class="s2">&#34;2021-12-07T06:53:09.687Z&#34;</span><span class="p">,</span>
    <span class="nt">&#34;updatedAt&#34;</span><span class="p">:</span> <span class="s2">&#34;2021-12-07T06:53:09.688Z&#34;</span><span class="p">,</span>
    <span class="nt">&#34;transactionId&#34;</span><span class="p">:</span> <span class="s2">&#34;15&#34;</span><span class="p">,</span>
    <span class="nt">&#34;stuff&#34;</span><span class="p">:</span> <span class="s2">&#34;Speaker&#34;</span><span class="p">,</span>
    <span class="nt">&#34;price&#34;</span><span class="p">:</span> <span class="s2">&#34;200000&#34;</span><span class="p">,</span>
    <span class="nt">&#34;qty&#34;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="nt">&#34;total&#34;</span><span class="p">:</span> <span class="s2">&#34;200000&#34;</span>
  <span class="p">},</span>
  <span class="p">{</span>
    <span class="nt">&#34;id&#34;</span><span class="p">:</span> <span class="s2">&#34;10&#34;</span><span class="p">,</span>
    <span class="nt">&#34;createdAt&#34;</span><span class="p">:</span> <span class="s2">&#34;2021-12-07T06:53:10.006Z&#34;</span><span class="p">,</span>
    <span class="nt">&#34;updatedAt&#34;</span><span class="p">:</span> <span class="s2">&#34;2021-12-07T06:53:10.006Z&#34;</span><span class="p">,</span>
    <span class="nt">&#34;transactionId&#34;</span><span class="p">:</span> <span class="s2">&#34;15&#34;</span><span class="p">,</span>
    <span class="nt">&#34;stuff&#34;</span><span class="p">:</span> <span class="s2">&#34;Headset&#34;</span><span class="p">,</span>
    <span class="nt">&#34;price&#34;</span><span class="p">:</span> <span class="s2">&#34;180000&#34;</span><span class="p">,</span>
    <span class="nt">&#34;qty&#34;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="nt">&#34;total&#34;</span><span class="p">:</span> <span class="s2">&#34;180000&#34;</span>
  <span class="p">},</span>
  <span class="p">{</span>
    <span class="nt">&#34;id&#34;</span><span class="p">:</span> <span class="s2">&#34;11&#34;</span><span class="p">,</span>
    <span class="nt">&#34;createdAt&#34;</span><span class="p">:</span> <span class="s2">&#34;2021-12-07T06:53:10.525Z&#34;</span><span class="p">,</span>
    <span class="nt">&#34;updatedAt&#34;</span><span class="p">:</span> <span class="s2">&#34;2021-12-07T06:53:10.525Z&#34;</span><span class="p">,</span>
    <span class="nt">&#34;transactionId&#34;</span><span class="p">:</span> <span class="s2">&#34;15&#34;</span><span class="p">,</span>
    <span class="nt">&#34;stuff&#34;</span><span class="p">:</span> <span class="s2">&#34;Case Iphone 6S&#34;</span><span class="p">,</span>
    <span class="nt">&#34;price&#34;</span><span class="p">:</span> <span class="s2">&#34;20000&#34;</span><span class="p">,</span>
    <span class="nt">&#34;qty&#34;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="nt">&#34;total&#34;</span><span class="p">:</span> <span class="s2">&#34;20000&#34;</span>
  <span class="p">}</span>
<span class="p">]</span>
</code></pre></td></tr></table>
</div>
</div><p>Update transaction detail.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="err">PUT</span> <span class="err">http://localhost:</span><span class="mi">8000</span><span class="err">/api/transaction/detail/</span><span class="mi">11</span>

<span class="err">Request</span> <span class="err">Body:</span>
<span class="p">{</span>
    <span class="nt">&#34;qty&#34;</span><span class="p">:</span> <span class="mi">3</span>
<span class="p">}</span>

<span class="err">Response:</span>
<span class="p">{</span>
  <span class="nt">&#34;message&#34;</span><span class="p">:</span> <span class="s2">&#34;success&#34;</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>Delete transaction detail by id.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="err">DELETE</span> <span class="err">http://localhost:</span><span class="mi">8000</span><span class="err">/api/transaction/detail/</span><span class="mi">11</span>

<span class="err">Response:</span>
<span class="p">{</span>
  <span class="nt">&#34;message&#34;</span><span class="p">:</span> <span class="s2">&#34;success&#34;</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><a class="post-dummy-target" id="clone-or-download"></a><h3>Clone or download</h3>
<p>You can clone or download this project at</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash">https://github.com/piinalpin/nodejs-orm.git
</code></pre></td></tr></table>
</div>
</div><a class="post-dummy-target" id="references"></a><h3>References</h3>
<ul>
<li><a href="https://github.com/indahsramonasari/nodejs-user-product">IndahSRamonasari - NodeJS User Product</a></li>
<li><a href="https://sequelize.org/master/manual/model-basics.html">Sequelize - Model Basic</a></li>
<li><a href="https://sequelize.org/master/manual/transactions.html">Sequelize - Transactions</a></li>
<li><a href="https://stackoverflow.com/questions/33775165/auto-increment-id-with-sequelize-in-mysql">Auto Increment Id with Sequelize</a></li>
<li><a href="https://stackoverflow.com/questions/59653217/sequelize-5-belongs-to-relation-is-not-working">Sequelize Belong to Relationship</a></li>
<li><a href="https://stackoverflow.com/questions/14169655/sequelize-js-foreign-key">Sequelize Foreign Key</a></li>
<li><a href="https://stackoverflow.com/questions/14169655/sequelize-js-foreign-key">mesaugat - Express API ES6 Starter</a></li>
</ul>
        </div>

        <div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>This article is updated with 2021-12-07</span>
            </div>
            <div class="post-info-license">
                
            </div>
        </div>
        <div class="post-info-line">
            <div class="post-info-md">
                
                    
                        <span><a class="link-to-markdown" href="https://blog.piinalpin.com/2021/12/orm-nodejs-sequelize/index.md" target="_blank"></a></span>
                    
                
            </div>
            <div class="post-info-share">
                
                    <span>
    
        <a href="//twitter.com/share?url=https%3a%2f%2fblog.piinalpin.com%2f2021%2f12%2form-nodejs-sequelize%2f&amp;text=Object%20Relational%20Mapping%20Node%20JS%20using%20Sequelize&amp;via=piinalpin" target="_blank" title="Share on Twitter">
            <i class="fab fa-twitter fa-fw"></i>
        </a>
    
    
        <a href="//www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fblog.piinalpin.com%2f2021%2f12%2form-nodejs-sequelize%2f" target="_blank" title="Share on Facebook">
            <i class="fab fa-facebook-square fa-fw"></i>
        </a>
    
    
        <a href="//reddit.com/submit?url=https%3a%2f%2fblog.piinalpin.com%2f2021%2f12%2form-nodejs-sequelize%2f&amp;title=Object%20Relational%20Mapping%20Node%20JS%20using%20Sequelize" target="_blank" title="Share on Reddit">
            <i class="fab fa-reddit fa-fw"></i>
        </a>
    
    
        <a href="//www.linkedin.com/shareArticle?url=https%3a%2f%2fblog.piinalpin.com%2f2021%2f12%2form-nodejs-sequelize%2f&amp;title=Object%20Relational%20Mapping%20Node%20JS%20using%20Sequelize" target="_blank" title="Share on LinkedIn">
            <i class="fab fa-linkedin fa-fw"></i>
        </a>
    
    
    
    
    
    
    
</span>
                
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section>
            
                
                    <span class="tag">
                        <a href="https://blog.piinalpin.com/tags/node-js/"><i class="fas fa-tag fa-fw"></i>Node JS</a>
                    </span>
                
                    <span class="tag">
                        <a href="https://blog.piinalpin.com/tags/express-js/"><i class="fas fa-tag fa-fw"></i>Express JS</a>
                    </span>
                
                    <span class="tag">
                        <a href="https://blog.piinalpin.com/tags/javascript/"><i class="fas fa-tag fa-fw"></i>Javascript</a>
                    </span>
                
                    <span class="tag">
                        <a href="https://blog.piinalpin.com/tags/sequelize/"><i class="fas fa-tag fa-fw"></i>Sequelize</a>
                    </span>
                
                    <span class="tag">
                        <a href="https://blog.piinalpin.com/tags/object-relational-mapping/"><i class="fas fa-tag fa-fw"></i>Object Relational Mapping</a>
                    </span>
                
                    <span class="tag">
                        <a href="https://blog.piinalpin.com/tags/orm/"><i class="fas fa-tag fa-fw"></i>ORM</a>
                    </span>
                
                    <span class="tag">
                        <a href="https://blog.piinalpin.com/tags/es6/"><i class="fas fa-tag fa-fw"></i>ES6</a>
                    </span>
                
                    <span class="tag">
                        <a href="https://blog.piinalpin.com/tags/ecma-script/"><i class="fas fa-tag fa-fw"></i>Ecma Script</a>
                    </span>
                
            
        </section>
        <section>
            <span><a href="javascript:window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="https://blog.piinalpin.com/">Home</a></span>
        </section>
    </div>

    <div class="post-nav">
        
            <a href="https://blog.piinalpin.com/2021/11/cloud-object-storage-spring-boot-with-minio/" class="prev" rel="prev" title="Cloud Object Storage Spring Boot With Minio"><i class="fas fa-angle-left fa-fw"></i>Cloud Object Storage Spring Boot With Minio</a>
        
        
            <a href="https://blog.piinalpin.com/2021/12/image-processing-using-tensorflow/" class="next" rel="next" title="Image Processing Using Tensorflow - Convolutional Neural Network (CNN)">Image Processing Using Tensorflow - Convolutional Neural Network (CNN)<i class="fas fa-angle-right fa-fw"></i></a>
        
    </div>
</div>

        <div class="post-comment">
            
            

            
        </div>
    </article></div>
            </main>
            <footer class="footer">
    <div class="copyright">
        <div class="copyright-line">
            Powered by <a href="https://gohugo.io/" target="_blank" rel="external nofollow noopener noreffer">Hugo</a>&nbsp;|&nbsp;Theme - <a href="https://github.com/dillonzq/LoveIt" target="_blank" rel="external nofollow noopener noreffer">LoveIt<i class="far fa-heart fa-fw"></i></a>
        </div>
        <div class="copyright-line">
            <i class="far fa-copyright fa-fw"></i><span itemprop="copyrightYear">2019 - 2021</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="https://blog.piinalpin.com/">piinalpin</a></span><span class="license">&nbsp;|&nbsp;<a rel="license external nofollow noopener noreffer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span></div>
    </div>
</footer>


    
    




    
    




    
    





    
    



    
    



    
    





    
    





    
    



    
    





    
    




    
    




    
    



    
    





    
    


<script src="/js/lib/jquery/jquery.slim.min.min.js"></script>
<script src="/js/lib/lazysizes/lazysizes.min.min.js"></script>
<script src="/js/lib/smooth-scroll/smooth-scroll.polyfills.min.min.js"></script><script>window.scroll = new SmoothScroll('[data-scroll]', {speed: 300, speedAsDuration: true});</script>


    
    

    

    
        <link rel="stylesheet" href="/css/lib/katex/katex.min.min.css"><script src="/js/lib/katex/katex.min.min.js"></script><script defer src="/js/lib/katex/auto-render.min.min.js" onload="renderMathInElement(document.body);"></script>
    

    

    






<script src="/js/blog.min.js"></script>


    
</div>
        <a href="#" class="dynamic-to-top" id="dynamic-to-top" data-scroll><span>&nbsp;</span></a>
    </body>
</html>