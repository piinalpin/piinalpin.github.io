<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>Persistent Volume and Persistent Volume Claim in Kubernetes | PiinAlpin</title><meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="robots" content="noodp" />
<meta name="Description" content="Managing storage is a distinct problem from managing compute instances. The PersistentVolume subsystem provides an API for users and administrators that abstracts details of how storage is provided from how it is consumed. To do this, we introduce two new API resources: PersistentVolume and PersistentVolumeClaim.">
<link rel="prev" href="https://blog.piinalpin.com/2021/05/why-should-learn-kubernetes/" />
<link rel="canonical" href="https://blog.piinalpin.com/2021/05/why-should-learn-kubernetes-pv-and-pvc/" />
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Persistent Volume and Persistent Volume Claim in Kubernetes"/>
<meta name="twitter:description" content="Managing storage is a distinct problem from managing compute instances. The PersistentVolume subsystem provides an API for users and administrators that abstracts details of how storage is provided from how it is consumed. To do this, we introduce two new API resources: PersistentVolume and PersistentVolumeClaim."/>
<script type="application/ld+json">
    {
    "@context": "http://schema.org",
    "@type": "BlogPosting",
    "headline": "Persistent Volume and Persistent Volume Claim in Kubernetes",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "https:\/\/blog.piinalpin.com\/2021\/05\/why-should-learn-kubernetes-pv-and-pvc\/"
    },
    
        "image": {
            "@type": "ImageObject",
            "url": "https:\/\/blog.piinalpin.com\/cover.png",
            "width":  800 ,
            "height":  600 
        },
    
    "genre": "posts",
    
        "keywords": "Kubernetes, Deployment, DevOps, Container, Cluster, Nodes, Pods, K8s, Cloud Computing, Persistence Volume, Persistence Volume Claim",
    
    "wordcount":  1233 ,
    "url": "https:\/\/blog.piinalpin.com\/2021\/05\/why-should-learn-kubernetes-pv-and-pvc\/",
    
        "datePublished": "2021-05-28T09:37:50\u002b07:00",
    
    
        "dateModified": "2021-05-28T09:37:50\u002b07:00",
    
    
        "license": "This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.",
    
    
        "publisher": {
            "@type": "Organization",
            "name": "Alvinditya Saputra",
            "logo": {
            "@type": "ImageObject",
            "url": "https:\/\/blog.piinalpin.com\/logo.png",
            "width":  127 ,
            "height":  40 
            }
        },
    
    
    "description": "Managing storage is a distinct problem from managing compute instances. The PersistentVolume subsystem provides an API for users and administrators that abstracts details of how storage is provided from how it is consumed. To do this, we introduce two new API resources: PersistentVolume and PersistentVolumeClaim."
    }
    </script>
<link rel="stylesheet" href="/css/style.min.css">
<link rel="stylesheet" href="/css/lib/fontawesome-free/all.min.min.css">

<link rel="stylesheet" href="/css/lib/animate/animate.min.min.css">


<script>
  if('serviceWorker' in navigator) {
      navigator.serviceWorker
          .register('/service-worker.js', { scope: '/' })
          .then(function(registration) {
              
          });

      navigator.serviceWorker
          .ready
          .then(function(registration) {
              
          });
  }
</script>
    </head>
    <body>
        <script>
            window.localStorage.getItem('theme') === 'dark';
            document.body.classList.add('dark-theme');
        </script>
        <div class="wrapper">
            <nav class="navbar">
    <div class="navbar-container">
        <div class="navbar-header animated bounceIn">
            <a href="https://blog.piinalpin.com/">PiinAlpin</a>
        </div>
        <div class="navbar-menu">
            
            
                <a class="menu-item" href="https://blog.piinalpin.com/posts" title="">Posts</a>
            
                <a class="menu-item" href="https://blog.piinalpin.com/tags" title="">Tags</a>
            
                <a class="menu-item" href="https://blog.piinalpin.com/categories" title="">Categories</a>
            
                <a class="menu-item" href="https://blog.piinalpin.com/about" title="">About</a>
            
        </div>
    </div>
</nav>
<nav class="navbar-mobile">
     <div class="navbar-container">
        <div class="navbar-header">
            <div class="navbar-header-title animated bounceIn">
                <a href="https://blog.piinalpin.com/">PiinAlpin</a>
            </div>
            <div class="menu-toggle" id="menu-toggle">
                <span></span><span></span><span></span>
            </div>
        </div>
    </div>
</nav><main class="main">
                <div class="container">
                    
    
    
    

    <article class="post-warp">
        <h1 class="post-title animated flipInX">Persistent Volume and Persistent Volume Claim in Kubernetes</h1>

        <div class="post-meta">
            <div class="post-meta-main">
                <a class="author" href="https://blog.piinalpin.com/" rel="author"><i class="fas fa-user-circle fa-fw"></i>piinalpin&nbsp;</a>
                <span class="post-category">
                        included in
                        <i class="far fa-folder fa-fw"></i><a href="https://blog.piinalpin.com/categories/documentation/">Documentation</a>
                            
                    </span>
            </div>
            <div class="post-meta-other">
                <i class="far fa-calendar-alt fa-fw"></i><time datetime=2021-05-28>2021-05-28</time>&nbsp;
                <i class="fas fa-pencil-alt fa-fw"></i>about 1233 words&nbsp;
                <i class="far fa-clock fa-fw"></i>6 min&nbsp;</div>
        </div>

        

        <div class="post-toc" id="post-toc">
                <h2 class="post-toc-title">Table of Contents</h2>
                <div class="post-toc-content">
                    <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#what-is-persistent-volume-and-persistent-volume-claim">What is Persistent Volume and Persistent Volume Claim</a></li>
        <li><a href="#create-a-perstistent-volume">Create a Perstistent Volume</a></li>
        <li><a href="#create-a-persistent-volume-claim">Create a Persistent Volume Claim</a></li>
        <li><a href="#create-a-pod">Create a Pod</a></li>
        <li><a href="#implement-node-app-web-service-and-database-using-mysql-with-persistent-volume">Implement Node App Web Service and Database using MySQL with Persistent Volume</a></li>
        <li><a href="#full-example-code">Full Example Code</a></li>
        <li><a href="#thankyou">Thankyou</a></li>
      </ul>
    </li>
  </ul>
</nav>
                </div>
            </div>
            <div class="post-toc-mobile" id="post-toc-mobile">
                <details>
                    <summary><div class="post-toc-title"><span>Table of Contents</span><span><i class="details icon fas fa-angle-down"></i></span></div></summary>
                    <div class="post-toc-content">
                        
                        
                        <nav id="TableOfContentsMobile">
  <ul>
    <li>
      <ul>
        <li><a href="#what-is-persistent-volume-and-persistent-volume-claim">What is Persistent Volume and Persistent Volume Claim</a></li>
        <li><a href="#create-a-perstistent-volume">Create a Perstistent Volume</a></li>
        <li><a href="#create-a-persistent-volume-claim">Create a Persistent Volume Claim</a></li>
        <li><a href="#create-a-pod">Create a Pod</a></li>
        <li><a href="#implement-node-app-web-service-and-database-using-mysql-with-persistent-volume">Implement Node App Web Service and Database using MySQL with Persistent Volume</a></li>
        <li><a href="#full-example-code">Full Example Code</a></li>
        <li><a href="#thankyou">Thankyou</a></li>
      </ul>
    </li>
  </ul>
</nav>
                    </div>
                </details>
            </div>

        <div class="post-content">
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            <a class="post-dummy-target" id="what-is-persistent-volume-and-persistent-volume-claim"></a><h3>What is Persistent Volume and Persistent Volume Claim</h3>
<p><img src="/images/pv-and-pvc-k8s.png" alt="Persistent Volume and Persistent Volume Claim"></p>
<p><strong>A PersistentVolume (PV)</strong> is a piece of storage in the cluster that has been provisioned by an administrator or dynamically provisioned using Storage Classes. It is a resource in the cluster just like a node is a cluster resource. PVs are volume plugins like Volumes, but have a lifecycle independent of any individual Pod that uses the PV. This API object captures the details of the implementation of the storage, be that NFS, iSCSI, or a cloud-provider-specific storage system.</p>
<p><strong>A PersistentVolumeClaim (PVC)</strong> is a request for storage by a user. It is similar to a Pod. Pods consume node resources and PVCs consume PV resources. Pods can request specific levels of resources (CPU and Memory). Claims can request specific size and access modes (e.g., they can be mounted ReadWriteOnce, ReadOnlyMany or ReadWriteMany, see AccessModes).</p>
<p>While PersistentVolumeClaims allow a user to consume abstract storage resources, it is common that users need PersistentVolumes with varying properties, such as performance, for different problems. Cluster administrators need to be able to offer a variety of PersistentVolumes that differ in more ways than size and access modes, without exposing users to the details of how those volumes are implemented. For these needs, there is the StorageClass resource.</p>
<p>More detail please see <a href="https://kubernetes.io/docs/tasks/configure-pod-container/configure-persistent-volume-storage/">Configure a Pod to Use a PersistentVolume for Storage</a></p>
<a class="post-dummy-target" id="create-a-perstistent-volume"></a><h3>Create a Perstistent Volume</h3>
<p>In this exercise, you create a hostPath PersistentVolume. Kubernetes supports hostPath for development and testing on a single-node cluster. A hostPath PersistentVolume uses a file or directory on the Node to emulate network-attached storage.</p>
<p>In a production cluster, you would not use hostPath. Instead a cluster administrator would provision a network resource like a Google Compute Engine persistent disk, an NFS share, or an Amazon Elastic Block Store volume. Cluster administrators can also use StorageClasses to set up dynamic provisioning.</p>
<p>Create a <code>pv-example.yaml</code> configuration file for the hostPath PersistentVolume:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-yaml" data-lang="yaml"><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l">v1</span><span class="w">
</span><span class="w"></span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">PersistentVolume</span><span class="w">
</span><span class="w"></span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">pv-example</span><span class="w">
</span><span class="w">  </span><span class="nt">labels</span><span class="p">:</span><span class="w">
</span><span class="w">    </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l">example</span><span class="w">
</span><span class="w"></span><span class="nt">spec</span><span class="p">:</span><span class="w">
</span><span class="w">  </span><span class="nt">storageClassName</span><span class="p">:</span><span class="w"> </span><span class="l">manual</span><span class="w">
</span><span class="w">  </span><span class="nt">capacity</span><span class="p">:</span><span class="w">
</span><span class="w">    </span><span class="nt">storage</span><span class="p">:</span><span class="w"> </span><span class="l">10Gi</span><span class="w">
</span><span class="w">  </span><span class="nt">accessModes</span><span class="p">:</span><span class="w">
</span><span class="w">    </span>- <span class="l">ReadWriteOnce</span><span class="w">
</span><span class="w">  </span><span class="nt">hostPath</span><span class="p">:</span><span class="w">
</span><span class="w">    </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;/var/lib/data&#34;</span><span class="w">
</span></code></pre></td></tr></table>
</div>
</div><ul>
<li><code>kubectl</code> create persistent volume <code>pv-example</code> with labels <code>app:example</code></li>
<li><code>kubectl</code> defines the storage class name <code>manual</code></li>
<li><code>kubetcl</code> specifies a size of 10 gibibytes and access modes is <code>ReadWriteOnce</code> which means the volume can be mounted as read-write by a single node.</li>
<li><code>kubectl</code> specifies that the volume is at <code>/var/lib/data</code> on the cluster node.</li>
</ul>
<p>Create a persistent volume</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">kubectl apply -f pv-example.yaml
</code></pre></td></tr></table>
</div>
</div><p>Get PersistentVolume was created</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">kubectl get pv pv-example
</code></pre></td></tr></table>
</div>
</div><p>We should get an output</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">NAME         CAPACITY   ACCESS MODES   RECLAIM POLICY   STATUS      CLAIM   STORAGECLASS   REASON   AGE
pv-example   10Gi       RWO            Retain           Available           manual                  7s
</code></pre></td></tr></table>
</div>
</div><a class="post-dummy-target" id="create-a-persistent-volume-claim"></a><h3>Create a Persistent Volume Claim</h3>
<p>Pods use PersistentVolumeClaims to request physical storage. In this exercise, you create a PersistentVolumeClaim that requests a volume of at least three gibibytes that can provide read-write access for at least one Node.</p>
<p>Create a <code>pvc-example.yaml</code> configuration file and fill with following code :</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-yaml" data-lang="yaml"><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l">v1</span><span class="w">
</span><span class="w"></span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">PersistentVolumeClaim</span><span class="w">
</span><span class="w"></span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">pv-claim-example</span><span class="w">
</span><span class="w">  </span><span class="nt">labels</span><span class="p">:</span><span class="w">
</span><span class="w">    </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l">example</span><span class="w">
</span><span class="w"></span><span class="nt">spec</span><span class="p">:</span><span class="w">
</span><span class="w">  </span><span class="nt">storageClassName</span><span class="p">:</span><span class="w"> </span><span class="l">manual</span><span class="w">
</span><span class="w">  </span><span class="nt">accessModes</span><span class="p">:</span><span class="w">
</span><span class="w">    </span>- <span class="l">ReadWriteOnce</span><span class="w">
</span><span class="w">  </span><span class="nt">resources</span><span class="p">:</span><span class="w">
</span><span class="w">    </span><span class="nt">requests</span><span class="p">:</span><span class="w">
</span><span class="w">      </span><span class="nt">storage</span><span class="p">:</span><span class="w"> </span><span class="l">10Gi</span><span class="w">
</span></code></pre></td></tr></table>
</div>
</div><p>Create a persistent volume claim</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">kubectl apply -f pvc-example.yaml
</code></pre></td></tr></table>
</div>
</div><p>Get PersistentVolume was created</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">kubectl get pvc pv-claim-example
</code></pre></td></tr></table>
</div>
</div><p>We should get an output</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">NAME               STATUS   VOLUME       CAPACITY   ACCESS MODES   STORAGECLASS   AGE
pv-claim-example   Bound    pv-example   10Gi       RWO            manual         12s
</code></pre></td></tr></table>
</div>
</div><p>Check if persistent volume was claimed</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">kubectl get pv pv-example
</code></pre></td></tr></table>
</div>
</div><p>We should get an output shows a <code>STATUS</code> of <code>Bound</code> and <code>CLAIM</code> of <code>default/pv-claim-example</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">NAME         CAPACITY   ACCESS MODES   RECLAIM POLICY   STATUS   CLAIM                      STORAGECLASS   REASON   AGE
pv-example   10Gi       RWO            Retain           Bound    default/pv-claim-example   manual                  9m21s
</code></pre></td></tr></table>
</div>
</div><a class="post-dummy-target" id="create-a-pod"></a><h3>Create a Pod</h3>
<p>Create a pod <code>pod-uses-pvc-example.yaml</code> configuration file that uses the PersistentVolumeClaim as a volume</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-yaml" data-lang="yaml"><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l">v1</span><span class="w">
</span><span class="w"></span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">Pod</span><span class="w">
</span><span class="w"></span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">pv-example-pod</span><span class="w">
</span><span class="w"></span><span class="nt">spec</span><span class="p">:</span><span class="w">
</span><span class="w">  </span><span class="nt">volumes</span><span class="p">:</span><span class="w">
</span><span class="w">    </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">pv-storage-example</span><span class="w">
</span><span class="w">      </span><span class="nt">persistentVolumeClaim</span><span class="p">:</span><span class="w">
</span><span class="w">        </span><span class="nt">claimName</span><span class="p">:</span><span class="w"> </span><span class="l">pv-claim-example</span><span class="w">
</span><span class="w">  </span><span class="nt">containers</span><span class="p">:</span><span class="w">
</span><span class="w">    </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">pv-example-container</span><span class="w">
</span><span class="w">      </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">nginx</span><span class="w">
</span><span class="w">      </span><span class="nt">ports</span><span class="p">:</span><span class="w">
</span><span class="w">        </span>- <span class="nt">containerPort</span><span class="p">:</span><span class="w"> </span><span class="m">80</span><span class="w">
</span><span class="w">          </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;http-server&#34;</span><span class="w">
</span><span class="w">      </span><span class="nt">volumeMounts</span><span class="p">:</span><span class="w">
</span><span class="w">        </span>- <span class="nt">mountPath</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;/usr/share/nginx/html&#34;</span><span class="w">
</span><span class="w">          </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">pv-storage-example</span><span class="w">
</span></code></pre></td></tr></table>
</div>
</div><p>Create the pod</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">kubectl apply -f pod-uses-pvc-example.yaml
</code></pre></td></tr></table>
</div>
</div><p>Check pod is running</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">kubectl get pods pv-example-pod
</code></pre></td></tr></table>
</div>
</div><p>Get cluster where pods is running</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">kubectl describe pods pv-example-pod
</code></pre></td></tr></table>
</div>
</div><p>We should get an output</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">Events:
  Type    Reason     Age   From               Message
  ----    ------     ----  ----               -------
  Normal  Scheduled  10m   default-scheduler  Successfully assigned default/pv-example-pod to gke-rattlesnake-cluster-default-pool-5da13591-6wb4
  Normal  Pulling    10m   kubelet            Pulling image <span class="s2">&#34;nginx&#34;</span>
  Normal  Pulled     10m   kubelet            Successfully pulled image <span class="s2">&#34;nginx&#34;</span> in 2.156978426s
  Normal  Created    10m   kubelet            Created container pv-example-container
  Normal  Started    10m   kubelet            Started container pv-example-container
</code></pre></td></tr></table>
</div>
</div><p>Get external IP for <code>gke-rattlesnake-cluster-default-pool-5da13591-6wb4</code> node pool</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">kubectl get nodes gke-rattlesnake-cluster-default-pool-5da13591-6wb4 --output wide
</code></pre></td></tr></table>
</div>
</div><p>Then, ssh into cluster node, then create directory <code>/var/lib/data</code> and create file <code>index.html</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">sudo mkdir /var/lib/data/ <span class="o">&amp;&amp;</span> sudo sh -c <span class="s2">&#34;echo &#39;Hello from Kubernetes storage&#39; &gt; /var/lib/data/index.html&#34;</span>
</code></pre></td></tr></table>
</div>
</div><p>Go to a shell to the container running in your Pod :</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">kubectl <span class="nb">exec</span> -it pv-example-pod  -- /bin/bash
</code></pre></td></tr></table>
</div>
</div><p>In your shell, verify that nginx is serving the index.html file from the hostPath volume :</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">curl http://localhost/
</code></pre></td></tr></table>
</div>
</div><p>We should get an output <code>Hello from Kubernetes storage</code></p>
<a class="post-dummy-target" id="implement-node-app-web-service-and-database-using-mysql-with-persistent-volume"></a><h3>Implement Node App Web Service and Database using MySQL with Persistent Volume</h3>
<p>We continue from <a href="https://blog.piinalpin.com/2021/05/why-should-learn-kubernetes/">Learning Kubernetes</a> with example Node.js app with MySQL database.</p>
<p>Create configuration file <code>app-and-database.yml</code> then fill code like following below :</p>
<ul>
<li>Create Persistent Volume and Persistent Volume Claim</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-yaml" data-lang="yaml"><span class="nn">---</span><span class="w">
</span><span class="w"></span><span class="c"># DB PERSISTENCE VOLUME</span><span class="w">
</span><span class="w"></span><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l">v1</span><span class="w">
</span><span class="w"></span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">PersistentVolume</span><span class="w">
</span><span class="w"></span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">pv-learn-nodejs</span><span class="w">
</span><span class="w">  </span><span class="nt">labels</span><span class="p">:</span><span class="w">
</span><span class="w">    </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l">mysql</span><span class="w">
</span><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">local</span><span class="w">
</span><span class="w"></span><span class="nt">spec</span><span class="p">:</span><span class="w">
</span><span class="w">  </span><span class="nt">storageClassName</span><span class="p">:</span><span class="w"> </span><span class="l">manual</span><span class="w">
</span><span class="w">  </span><span class="nt">capacity</span><span class="p">:</span><span class="w">
</span><span class="w">    </span><span class="nt">storage</span><span class="p">:</span><span class="w"> </span><span class="l">20Gi</span><span class="w">
</span><span class="w">  </span><span class="nt">accessModes</span><span class="p">:</span><span class="w">
</span><span class="w">    </span>- <span class="l">ReadWriteOnce</span><span class="w">
</span><span class="w">  </span><span class="nt">hostPath</span><span class="p">:</span><span class="w">
</span><span class="w">    </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;/var/lib/data&#34;</span><span class="w">
</span><span class="w"></span><span class="nn">---</span><span class="w">
</span><span class="w"></span><span class="c"># DB PERSISTENCE VOLUME CLAIM</span><span class="w">
</span><span class="w"></span><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l">v1</span><span class="w">
</span><span class="w"></span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">PersistentVolumeClaim</span><span class="w">
</span><span class="w"></span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">pv-claim-learn-nodejs</span><span class="w">
</span><span class="w">  </span><span class="nt">labels</span><span class="p">:</span><span class="w">
</span><span class="w">    </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l">mysql</span><span class="w">
</span><span class="w"></span><span class="nt">spec</span><span class="p">:</span><span class="w">
</span><span class="w">  </span><span class="nt">storageClassName</span><span class="p">:</span><span class="w"> </span><span class="l">manual</span><span class="w">
</span><span class="w">  </span><span class="nt">accessModes</span><span class="p">:</span><span class="w">
</span><span class="w">    </span>- <span class="l">ReadWriteOnce</span><span class="w">
</span><span class="w">  </span><span class="nt">resources</span><span class="p">:</span><span class="w">
</span><span class="w">    </span><span class="nt">requests</span><span class="p">:</span><span class="w">
</span><span class="w">      </span><span class="nt">storage</span><span class="p">:</span><span class="w"> </span><span class="l">20Gi</span><span class="w">
</span><span class="w"></span><span class="nn">---</span><span class="w">
</span></code></pre></td></tr></table>
</div>
</div><ul>
<li>Create Node.js app deployment</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-yaml" data-lang="yaml"><span class="nn">---</span><span class="w">
</span><span class="w"></span><span class="c"># APP DEPLOYMENT</span><span class="w">
</span><span class="w"></span><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l">apps/v1</span><span class="w">
</span><span class="w"></span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">Deployment</span><span class="w">
</span><span class="w"></span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">app-learn-nodejs</span><span class="w">
</span><span class="w">  </span><span class="nt">labels</span><span class="p">:</span><span class="w">
</span><span class="w">    </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l">app</span><span class="w">
</span><span class="w">    </span><span class="nt">tier</span><span class="p">:</span><span class="w"> </span><span class="l">learn-nodejs</span><span class="w">
</span><span class="w"></span><span class="nt">spec</span><span class="p">:</span><span class="w">
</span><span class="w">  </span><span class="nt">replicas</span><span class="p">:</span><span class="w"> </span><span class="m">3</span><span class="w">
</span><span class="w">  </span><span class="nt">selector</span><span class="p">:</span><span class="w">
</span><span class="w">    </span><span class="nt">matchLabels</span><span class="p">:</span><span class="w">
</span><span class="w">      </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l">app</span><span class="w">
</span><span class="w">      </span><span class="nt">tier</span><span class="p">:</span><span class="w"> </span><span class="l">learn-nodejs</span><span class="w">
</span><span class="w">  </span><span class="nt">template</span><span class="p">:</span><span class="w">
</span><span class="w">    </span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span><span class="w">      </span><span class="nt">labels</span><span class="p">:</span><span class="w">
</span><span class="w">        </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l">app</span><span class="w">
</span><span class="w">        </span><span class="nt">tier</span><span class="p">:</span><span class="w"> </span><span class="l">learn-nodejs</span><span class="w">
</span><span class="w">    </span><span class="nt">spec</span><span class="p">:</span><span class="w">
</span><span class="w">      </span><span class="nt">containers</span><span class="p">:</span><span class="w">
</span><span class="w">        </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">learn-nodejs</span><span class="w">
</span><span class="w">          </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">piinalpin/learn-nodejs</span><span class="w">
</span><span class="w">          </span><span class="nt">env</span><span class="p">:</span><span class="w">
</span><span class="w">          </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;PORT&#34;</span><span class="w">
</span><span class="w">            </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;8080&#34;</span><span class="w">
</span><span class="w">          </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;DB_HOST&#34;</span><span class="w">
</span><span class="w">            </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;db-learn-nodejs-svc&#34;</span><span class="w">
</span><span class="w">          </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;DB_USERNAME&#34;</span><span class="w">
</span><span class="w">            </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;root&#34;</span><span class="w">
</span><span class="w">          </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;DB_PASSWORD&#34;</span><span class="w">
</span><span class="w">            </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;p@s5w0rD&#34;</span><span class="w">
</span><span class="w">          </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;DB_NAME&#34;</span><span class="w">
</span><span class="w">            </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;learn_nodejs&#34;</span><span class="w">
</span><span class="w">          </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;DB_PORT&#34;</span><span class="w">
</span><span class="w">            </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;3306&#34;</span><span class="w">
</span><span class="w"></span><span class="nn">---</span><span class="w">
</span></code></pre></td></tr></table>
</div>
</div><ul>
<li>Create database MySQL deployment with PersistentVolumeClaim</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-yaml" data-lang="yaml"><span class="nn">---</span><span class="w">
</span><span class="w"></span><span class="c"># DB DEPLOYMENT</span><span class="w">
</span><span class="w"></span><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l">apps/v1</span><span class="w">
</span><span class="w"></span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">Deployment</span><span class="w">
</span><span class="w"></span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">db-learn-nodejs</span><span class="w">
</span><span class="w">  </span><span class="nt">labels</span><span class="p">:</span><span class="w">
</span><span class="w">    </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l">db</span><span class="w">
</span><span class="w">    </span><span class="nt">tier</span><span class="p">:</span><span class="w"> </span><span class="l">learn-nodejs</span><span class="w">
</span><span class="w"></span><span class="nt">spec</span><span class="p">:</span><span class="w">
</span><span class="w">  </span><span class="nt">selector</span><span class="p">:</span><span class="w">
</span><span class="w">    </span><span class="nt">matchLabels</span><span class="p">:</span><span class="w">
</span><span class="w">      </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l">db</span><span class="w">
</span><span class="w">      </span><span class="nt">tier</span><span class="p">:</span><span class="w"> </span><span class="l">learn-nodejs</span><span class="w">
</span><span class="w">  </span><span class="nt">strategy</span><span class="p">:</span><span class="w">
</span><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">Recreate</span><span class="w">
</span><span class="w">  </span><span class="nt">template</span><span class="p">:</span><span class="w">
</span><span class="w">    </span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span><span class="w">      </span><span class="nt">labels</span><span class="p">:</span><span class="w">
</span><span class="w">        </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l">db</span><span class="w">
</span><span class="w">        </span><span class="nt">tier</span><span class="p">:</span><span class="w"> </span><span class="l">learn-nodejs</span><span class="w">
</span><span class="w">    </span><span class="nt">spec</span><span class="p">:</span><span class="w">
</span><span class="w">      </span><span class="nt">containers</span><span class="p">:</span><span class="w">
</span><span class="w">      </span>- <span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">mysql:latest</span><span class="w">
</span><span class="w">        </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">mysql</span><span class="w">
</span><span class="w">        </span><span class="nt">env</span><span class="p">:</span><span class="w">
</span><span class="w">        </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">MYSQL_ROOT_PASSWORD</span><span class="w">
</span><span class="w">          </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l">p@s5w0rD</span><span class="w">
</span><span class="w">        </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;PORT&#34;</span><span class="w">
</span><span class="w">          </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;3306&#34;</span><span class="w">
</span><span class="w">        </span><span class="nt">volumeMounts</span><span class="p">:</span><span class="w">
</span><span class="w">        </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">pv-learn-nodejs</span><span class="w">
</span><span class="w">          </span><span class="nt">mountPath</span><span class="p">:</span><span class="w"> </span><span class="l">/var/lib/mysql</span><span class="w">
</span><span class="w">      </span><span class="nt">volumes</span><span class="p">:</span><span class="w">
</span><span class="w">      </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">pv-learn-nodejs</span><span class="w">
</span><span class="w">        </span><span class="nt">persistentVolumeClaim</span><span class="p">:</span><span class="w">
</span><span class="w">          </span><span class="nt">claimName</span><span class="p">:</span><span class="w"> </span><span class="l">pv-claim-learn-nodejs</span><span class="w">
</span><span class="w"></span><span class="nn">---</span><span class="w">
</span></code></pre></td></tr></table>
</div>
</div><ul>
<li>Expose App and DB with Service</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-yaml" data-lang="yaml"><span class="nn">---</span><span class="w">
</span><span class="w"></span><span class="c"># APP SERVICE</span><span class="w">
</span><span class="w"></span><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l">v1</span><span class="w">
</span><span class="w"></span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">Service</span><span class="w">
</span><span class="w"></span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">app-learn-nodejs-svc</span><span class="w">
</span><span class="w">  </span><span class="nt">labels</span><span class="p">:</span><span class="w">
</span><span class="w">    </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l">app</span><span class="w">
</span><span class="w">    </span><span class="nt">tier</span><span class="p">:</span><span class="w"> </span><span class="l">learn-nodejs</span><span class="w">
</span><span class="w"></span><span class="nt">spec</span><span class="p">:</span><span class="w">
</span><span class="w">  </span><span class="nt">selector</span><span class="p">:</span><span class="w">
</span><span class="w">    </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l">app</span><span class="w">
</span><span class="w">    </span><span class="nt">tier</span><span class="p">:</span><span class="w"> </span><span class="l">learn-nodejs</span><span class="w">
</span><span class="w">  </span><span class="nt">ports</span><span class="p">:</span><span class="w">
</span><span class="w">    </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">app-port</span><span class="w">
</span><span class="w">      </span><span class="nt">protocol</span><span class="p">:</span><span class="w"> </span><span class="l">TCP</span><span class="w">
</span><span class="w">      </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="m">8001</span><span class="w">
</span><span class="w">      </span><span class="nt">targetPort</span><span class="p">:</span><span class="w"> </span><span class="m">8080</span><span class="w">
</span><span class="w">  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">LoadBalancer</span><span class="w">
</span><span class="w"></span><span class="nn">---</span><span class="w">
</span><span class="w"></span><span class="c"># DB SERVICE</span><span class="w">
</span><span class="w"></span><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l">v1</span><span class="w">
</span><span class="w"></span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">Service</span><span class="w">
</span><span class="w"></span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">db-learn-nodejs-svc</span><span class="w">
</span><span class="w">  </span><span class="nt">labels</span><span class="p">:</span><span class="w">
</span><span class="w">    </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l">db</span><span class="w">
</span><span class="w">    </span><span class="nt">tier</span><span class="p">:</span><span class="w"> </span><span class="l">learn-nodejs</span><span class="w">
</span><span class="w"></span><span class="nt">spec</span><span class="p">:</span><span class="w">
</span><span class="w">  </span><span class="nt">selector</span><span class="p">:</span><span class="w">
</span><span class="w">    </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l">db</span><span class="w">
</span><span class="w">    </span><span class="nt">tier</span><span class="p">:</span><span class="w"> </span><span class="l">learn-nodejs</span><span class="w">
</span><span class="w">  </span><span class="nt">ports</span><span class="p">:</span><span class="w">
</span><span class="w">    </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">db-port</span><span class="w">
</span><span class="w">      </span><span class="nt">protocol</span><span class="p">:</span><span class="w"> </span><span class="l">TCP</span><span class="w">
</span><span class="w">      </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="m">3306</span><span class="w">
</span><span class="w">      </span><span class="nt">targetPort</span><span class="p">:</span><span class="w"> </span><span class="m">3306</span><span class="w">
</span><span class="w">  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">LoadBalancer</span><span class="w">
</span><span class="w"></span><span class="nn">---</span><span class="w">
</span></code></pre></td></tr></table>
</div>
</div><ul>
<li>Create Ingress for App</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-yaml" data-lang="yaml"><span class="nn">---</span><span class="w">
</span><span class="w"></span><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l">networking.k8s.io/v1</span><span class="w">
</span><span class="w"></span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">Ingress</span><span class="w">
</span><span class="w"></span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">app-learn-nodejs-ingress</span><span class="w">
</span><span class="w"></span><span class="nt">spec</span><span class="p">:</span><span class="w">
</span><span class="w">  </span><span class="nt">rules</span><span class="p">:</span><span class="w">
</span><span class="w">    </span>- <span class="nt">http</span><span class="p">:</span><span class="w">
</span><span class="w">        </span><span class="nt">paths</span><span class="p">:</span><span class="w">
</span><span class="w">        </span>- <span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l">/programming-languages</span><span class="w">
</span><span class="w">          </span><span class="nt">pathType</span><span class="p">:</span><span class="w"> </span><span class="l">Prefix</span><span class="w">
</span><span class="w">          </span><span class="nt">backend</span><span class="p">:</span><span class="w">
</span><span class="w">            </span><span class="nt">service</span><span class="p">:</span><span class="w">
</span><span class="w">              </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">app-learn-nodejs-svc</span><span class="w">
</span><span class="w">              </span><span class="nt">port</span><span class="p">:</span><span class="w"> 
</span><span class="w">                </span><span class="nt">number</span><span class="p">:</span><span class="w"> </span><span class="m">8001</span><span class="w">
</span></code></pre></td></tr></table>
</div>
</div><p>Apply configuration file</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">kubectl apply -f app-and-database.yaml
</code></pre></td></tr></table>
</div>
</div><p><strong>Create database and table on running container</strong></p>
<p>Run container with creating a pod</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">kubectl run -it --rm --image<span class="o">=</span>mysql:latest --restart<span class="o">=</span>Never mysql-client -- mysql -h &lt;DB_SVC_NAME&gt; -p&lt;YOUR_MYSQL_PASSWORD&gt;
</code></pre></td></tr></table>
</div>
</div><p>Create database, table and insert value</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-sql" data-lang="sql"><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="o">`</span><span class="n">programming_languages</span><span class="o">`</span><span class="w">
</span><span class="w"></span><span class="p">(</span><span class="w">
</span><span class="w">  </span><span class="o">`</span><span class="n">id</span><span class="o">`</span><span class="w">            </span><span class="nb">INT</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="w"> </span><span class="n">auto_increment</span><span class="w"> </span><span class="p">,</span><span class="w">
</span><span class="w">  </span><span class="o">`</span><span class="n">name</span><span class="o">`</span><span class="w">          </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">255</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="w"> </span><span class="p">,</span><span class="w">
</span><span class="w">  </span><span class="o">`</span><span class="n">released_year</span><span class="o">`</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="w"> </span><span class="p">,</span><span class="w">
</span><span class="w">  </span><span class="o">`</span><span class="n">github_rank</span><span class="o">`</span><span class="w">   </span><span class="nb">INT</span><span class="w"> </span><span class="k">NULL</span><span class="w"> </span><span class="p">,</span><span class="w">
</span><span class="w">  </span><span class="o">`</span><span class="n">pypl_rank</span><span class="o">`</span><span class="w">     </span><span class="nb">INT</span><span class="w"> </span><span class="k">NULL</span><span class="w"> </span><span class="p">,</span><span class="w">
</span><span class="w">  </span><span class="o">`</span><span class="n">tiobe_rank</span><span class="o">`</span><span class="w">    </span><span class="nb">INT</span><span class="w"> </span><span class="k">NULL</span><span class="w"> </span><span class="p">,</span><span class="w">
</span><span class="w">  </span><span class="o">`</span><span class="n">created_at</span><span class="o">`</span><span class="w">    </span><span class="n">DATETIME</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="k">CURRENT_TIMESTAMP</span><span class="w"> </span><span class="p">,</span><span class="w">
</span><span class="w">  </span><span class="o">`</span><span class="n">updated_at</span><span class="o">`</span><span class="w">    </span><span class="n">DATETIME</span><span class="w"> </span><span class="k">on</span><span class="w"> </span><span class="k">UPDATE</span><span class="w"> </span><span class="k">CURRENT_TIMESTAMP</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="k">CURRENT_TIMESTAMP</span><span class="w"> </span><span class="p">,</span><span class="w">
</span><span class="w">  </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="o">`</span><span class="n">id</span><span class="o">`</span><span class="p">),</span><span class="w">
</span><span class="w">  </span><span class="k">UNIQUE</span><span class="w"> </span><span class="o">`</span><span class="n">idx_name_unique</span><span class="o">`</span><span class="w"> </span><span class="p">(</span><span class="o">`</span><span class="n">name</span><span class="o">`</span><span class="p">(</span><span class="mi">255</span><span class="p">))</span><span class="w">
</span><span class="w"></span><span class="p">)</span><span class="w">
</span><span class="w"></span><span class="n">engine</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">innodb</span><span class="w"> </span><span class="n">charset</span><span class="o">=</span><span class="n">utf8mb4</span><span class="w"> </span><span class="k">COLLATE</span><span class="w"> </span><span class="n">utf8mb4_general_ci</span><span class="p">;</span><span class="w">
</span><span class="w">
</span><span class="w"></span><span class="c1">---------------------------------
</span><span class="c1"></span><span class="w">
</span><span class="w"></span><span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">programming_languages</span><span class="p">(</span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">released_year</span><span class="p">,</span><span class="w"> </span><span class="n">github_rank</span><span class="p">,</span><span class="w"> </span><span class="n">pypl_rank</span><span class="p">,</span><span class="w"> </span><span class="n">tiobe_rank</span><span class="p">)</span><span class="w"> 
</span><span class="w"></span><span class="k">VALUES</span><span class="w"> 
</span><span class="w"></span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;JavaScript&#39;</span><span class="p">,</span><span class="mi">1995</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">7</span><span class="p">),</span><span class="w">
</span><span class="w"></span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;Python&#39;</span><span class="p">,</span><span class="mi">1991</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="w">
</span><span class="w"></span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="s1">&#39;Java&#39;</span><span class="p">,</span><span class="mi">1995</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="w">
</span><span class="w"></span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="s1">&#39;TypeScript&#39;</span><span class="p">,</span><span class="mi">2012</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">42</span><span class="p">),</span><span class="w">
</span><span class="w"></span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="s1">&#39;C#&#39;</span><span class="p">,</span><span class="mi">2000</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span><span class="w">
</span><span class="w"></span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;PHP&#39;</span><span class="p">,</span><span class="mi">1995</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">8</span><span class="p">),</span><span class="w">
</span><span class="w"></span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="s1">&#39;C++&#39;</span><span class="p">,</span><span class="mi">1985</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span><span class="w">
</span><span class="w"></span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="s1">&#39;C&#39;</span><span class="p">,</span><span class="mi">1972</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="w">
</span><span class="w"></span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="s1">&#39;Ruby&#39;</span><span class="p">,</span><span class="mi">1995</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">15</span><span class="p">),</span><span class="w">
</span><span class="w"></span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="s1">&#39;R&#39;</span><span class="p">,</span><span class="mi">1993</span><span class="p">,</span><span class="mi">33</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">9</span><span class="p">),</span><span class="w">
</span><span class="w"></span><span class="p">(</span><span class="mi">11</span><span class="p">,</span><span class="s1">&#39;Objective-C&#39;</span><span class="p">,</span><span class="mi">1984</span><span class="p">,</span><span class="mi">18</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">18</span><span class="p">),</span><span class="w">
</span><span class="w"></span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="s1">&#39;Swift&#39;</span><span class="p">,</span><span class="mi">2015</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">13</span><span class="p">),</span><span class="w">
</span><span class="w"></span><span class="p">(</span><span class="mi">13</span><span class="p">,</span><span class="s1">&#39;Kotlin&#39;</span><span class="p">,</span><span class="mi">2011</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">40</span><span class="p">),</span><span class="w">
</span><span class="w"></span><span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="s1">&#39;Go&#39;</span><span class="p">,</span><span class="mi">2009</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">13</span><span class="p">,</span><span class="mi">14</span><span class="p">),</span><span class="w">
</span><span class="w"></span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="s1">&#39;Rust&#39;</span><span class="p">,</span><span class="mi">2010</span><span class="p">,</span><span class="mi">14</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="mi">26</span><span class="p">),</span><span class="w">
</span><span class="w"></span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="s1">&#39;Scala&#39;</span><span class="p">,</span><span class="mi">2004</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">17</span><span class="p">,</span><span class="mi">34</span><span class="p">);</span><span class="w">
</span></code></pre></td></tr></table>
</div>
</div><p>Get exposed address <code>Ingress</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">kubectl get ingress
</code></pre></td></tr></table>
</div>
</div><p>We should get an output</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">NAME                       CLASS    HOSTS   ADDRESS          PORTS   AGE
app-learn-nodejs-ingress   &lt;none&gt;   *       XXX.XXX.XXX.XXX    <span class="m">80</span>      26h
</code></pre></td></tr></table>
</div>
</div><p>Test deployment by hitting with <code>curl</code> to ingress address</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">curl &lt;INGRESS_ADDRESS&gt;/programming-languages
</code></pre></td></tr></table>
</div>
</div><p>We should get an output</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[{</span><span class="s2">&#34;id&#34;</span>:1,<span class="s2">&#34;name&#34;</span>:<span class="s2">&#34;JavaScript&#34;</span>,<span class="s2">&#34;releasedYear&#34;</span>:1995,<span class="s2">&#34;githutRank&#34;</span>:1,<span class="s2">&#34;pyplRank&#34;</span>:3,<span class="s2">&#34;tiobeRank&#34;</span>:7,<span class="s2">&#34;createdAt&#34;</span>:<span class="s2">&#34;2021-05-27T02:15:37.000Z&#34;</span>,<span class="s2">&#34;updatedAt&#34;</span>:<span class="s2">&#34;2021-05-27T02:15:37.000Z&#34;</span><span class="o">}</span>,<span class="o">{</span><span class="s2">&#34;id&#34;</span>:2,<span class="s2">&#34;name&#34;</span>:<span class="s2">&#34;Python&#34;</span>,<span class="s2">&#34;releasedYear&#34;</span>:1991,<span class="s2">&#34;githutRank&#34;</span>:2,<span class="s2">&#34;pyplRank&#34;</span>:1,<span class="s2">&#34;tiobeRank&#34;</span>:3,<span class="s2">&#34;createdAt&#34;</span>:<span class="s2">&#34;2021-05-27T02:15:37.000Z&#34;</span>,<span class="s2">&#34;updatedAt&#34;</span>:<span class="s2">&#34;2021-05-27T02:15:37.000Z&#34;</span><span class="o">}</span>,<span class="o">{</span><span class="s2">&#34;id&#34;</span>:3,<span class="s2">&#34;name&#34;</span>:<span class="s2">&#34;Java&#34;</span>,<span class="s2">&#34;releasedYear&#34;</span>:1995,<span class="s2">&#34;githutRank&#34;</span>:3,<span class="s2">&#34;pyplRank&#34;</span>:2,<span class="s2">&#34;tiobeRank&#34;</span>:2,<span class="s2">&#34;createdAt&#34;</span>:<span class="s2">&#34;2021-05-27T02:15:37.000Z&#34;</span>,<span class="s2">&#34;updatedAt&#34;</span>:<span class="s2">&#34;2021-05-27T02:15:37.000Z&#34;</span><span class="o">}</span>,<span class="o">{</span><span class="s2">&#34;id&#34;</span>:4,<span class="s2">&#34;name&#34;</span>:<span class="s2">&#34;TypeScript&#34;</span>,<span class="s2">&#34;releasedYear&#34;</span>:2012,<span class="s2">&#34;githutRank&#34;</span>:7,<span class="s2">&#34;pyplRank&#34;</span>:10,<span class="s2">&#34;tiobeRank&#34;</span>:42,<span class="s2">&#34;createdAt&#34;</span>:<span class="s2">&#34;2021-05-27T02:15:37.000Z&#34;</span>,<span class="s2">&#34;updatedAt&#34;</span>:<span class="s2">&#34;2021-05-27T02:15:37.000Z&#34;</span><span class="o">}</span>,<span class="o">{</span><span class="s2">&#34;id&#34;</span>:5,<span class="s2">&#34;name&#34;</span>:<span class="s2">&#34;C#&#34;</span>,<span class="s2">&#34;releasedYear&#34;</span>:2000,<span class="s2">&#34;githutRank&#34;</span>:9,<span class="s2">&#34;pyplRank&#34;</span>:4,<span class="s2">&#34;tiobeRank&#34;</span>:5,<span class="s2">&#34;createdAt&#34;</span>:<span class="s2">&#34;2021-05-27T02:15:37.000Z&#34;</span>,<span class="s2">&#34;updatedAt&#34;</span>:<span class="s2">&#34;2021-05-27T02:15:37.000Z&#34;</span><span class="o">}</span>,<span class="o">{</span><span class="s2">&#34;id&#34;</span>:6,<span class="s2">&#34;name&#34;</span>:<span class="s2">&#34;PHP&#34;</span>,<span class="s2">&#34;releasedYear&#34;</span>:1995,<span class="s2">&#34;githutRank&#34;</span>:8,<span class="s2">&#34;pyplRank&#34;</span>:6,<span class="s2">&#34;tiobeRank&#34;</span>:8,<span class="s2">&#34;createdAt&#34;</span>:<span class="s2">&#34;2021-05-27T02:15:37.000Z&#34;</span>,<span class="s2">&#34;updatedAt&#34;</span>:<span class="s2">&#34;2021-05-27T02:15:37.000Z&#34;</span><span class="o">}</span>,<span class="o">{</span><span class="s2">&#34;id&#34;</span>:7,<span class="s2">&#34;name&#34;</span>:<span class="s2">&#34;C++&#34;</span>,<span class="s2">&#34;releasedYear&#34;</span>:1985,<span class="s2">&#34;githutRank&#34;</span>:5,<span class="s2">&#34;pyplRank&#34;</span>:5,<span class="s2">&#34;tiobeRank&#34;</span>:4,<span class="s2">&#34;createdAt&#34;</span>:<span class="s2">&#34;2021-05-27T02:15:37.000Z&#34;</span>,<span class="s2">&#34;updatedAt&#34;</span>:<span class="s2">&#34;2021-05-27T02:15:37.000Z&#34;</span><span class="o">}</span>,<span class="o">{</span><span class="s2">&#34;id&#34;</span>:8,<span class="s2">&#34;name&#34;</span>:<span class="s2">&#34;C&#34;</span>,<span class="s2">&#34;releasedYear&#34;</span>:1972,<span class="s2">&#34;githutRank&#34;</span>:10,<span class="s2">&#34;pyplRank&#34;</span>:5,<span class="s2">&#34;tiobeRank&#34;</span>:1,<span class="s2">&#34;createdAt&#34;</span>:<span class="s2">&#34;2021-05-27T02:15:37.000Z&#34;</span>,<span class="s2">&#34;updatedAt&#34;</span>:<span class="s2">&#34;2021-05-27T02:15:37.000Z&#34;</span><span class="o">}</span>,<span class="o">{</span><span class="s2">&#34;id&#34;</span>:9,<span class="s2">&#34;name&#34;</span>:<span class="s2">&#34;Ruby&#34;</span>,<span class="s2">&#34;releasedYear&#34;</span>:1995,<span class="s2">&#34;githutRank&#34;</span>:6,<span class="s2">&#34;pyplRank&#34;</span>:15,<span class="s2">&#34;tiobeRank&#34;</span>:15,<span class="s2">&#34;createdAt&#34;</span>:<span class="s2">&#34;2021-05-27T02:15:37.000Z&#34;</span>,<span class="s2">&#34;updatedAt&#34;</span>:<span class="s2">&#34;2021-05-27T02:15:37.000Z&#34;</span><span class="o">}</span>,<span class="o">{</span><span class="s2">&#34;id&#34;</span>:10,<span class="s2">&#34;name&#34;</span>:<span class="s2">&#34;R&#34;</span>,<span class="s2">&#34;releasedYear&#34;</span>:1993,<span class="s2">&#34;githutRank&#34;</span>:33,<span class="s2">&#34;pyplRank&#34;</span>:7,<span class="s2">&#34;tiobeRank&#34;</span>:9,<span class="s2">&#34;createdAt&#34;</span>:<span class="s2">&#34;2021-05-27T02:15:37.000Z&#34;</span>,<span class="s2">&#34;updatedAt&#34;</span>:<span class="s2">&#34;2021-05-27T02:15:37.000Z&#34;</span><span class="o">}</span>,<span class="o">{</span><span class="s2">&#34;id&#34;</span>:11,<span class="s2">&#34;name&#34;</span>:<span class="s2">&#34;Objective-C&#34;</span>,<span class="s2">&#34;releasedYear&#34;</span>:1984,<span class="s2">&#34;githutRank&#34;</span>:18,<span class="s2">&#34;pyplRank&#34;</span>:8,<span class="s2">&#34;tiobeRank&#34;</span>:18,<span class="s2">&#34;createdAt&#34;</span>:<span class="s2">&#34;2021-05-27T02:15:37.000Z&#34;</span>,<span class="s2">&#34;updatedAt&#34;</span>:<span class="s2">&#34;2021-05-27T02:15:37.000Z&#34;</span><span class="o">}</span>,<span class="o">{</span><span class="s2">&#34;id&#34;</span>:12,<span class="s2">&#34;name&#34;</span>:<span class="s2">&#34;Swift&#34;</span>,<span class="s2">&#34;releasedYear&#34;</span>:2015,<span class="s2">&#34;githutRank&#34;</span>:16,<span class="s2">&#34;pyplRank&#34;</span>:9,<span class="s2">&#34;tiobeRank&#34;</span>:13,<span class="s2">&#34;createdAt&#34;</span>:<span class="s2">&#34;2021-05-27T02:15:37.000Z&#34;</span>,<span class="s2">&#34;updatedAt&#34;</span>:<span class="s2">&#34;2021-05-27T02:15:37.000Z&#34;</span><span class="o">}</span>,<span class="o">{</span><span class="s2">&#34;id&#34;</span>:13,<span class="s2">&#34;name&#34;</span>:<span class="s2">&#34;Kotlin&#34;</span>,<span class="s2">&#34;releasedYear&#34;</span>:2011,<span class="s2">&#34;githutRank&#34;</span>:15,<span class="s2">&#34;pyplRank&#34;</span>:12,<span class="s2">&#34;tiobeRank&#34;</span>:40,<span class="s2">&#34;createdAt&#34;</span>:<span class="s2">&#34;2021-05-27T02:15:37.000Z&#34;</span>,<span class="s2">&#34;updatedAt&#34;</span>:<span class="s2">&#34;2021-05-27T02:15:37.000Z&#34;</span><span class="o">}</span>,<span class="o">{</span><span class="s2">&#34;id&#34;</span>:14,<span class="s2">&#34;name&#34;</span>:<span class="s2">&#34;Go&#34;</span>,<span class="s2">&#34;releasedYear&#34;</span>:2009,<span class="s2">&#34;githutRank&#34;</span>:4,<span class="s2">&#34;pyplRank&#34;</span>:13,<span class="s2">&#34;tiobeRank&#34;</span>:14,<span class="s2">&#34;createdAt&#34;</span>:<span class="s2">&#34;2021-05-27T02:15:37.000Z&#34;</span>,<span class="s2">&#34;updatedAt&#34;</span>:<span class="s2">&#34;2021-05-27T02:15:37.000Z&#34;</span><span class="o">}</span>,<span class="o">{</span><span class="s2">&#34;id&#34;</span>:15,<span class="s2">&#34;name&#34;</span>:<span class="s2">&#34;Rust&#34;</span>,<span class="s2">&#34;releasedYear&#34;</span>:2010,<span class="s2">&#34;githutRank&#34;</span>:14,<span class="s2">&#34;pyplRank&#34;</span>:16,<span class="s2">&#34;tiobeRank&#34;</span>:26,<span class="s2">&#34;createdAt&#34;</span>:<span class="s2">&#34;2021-05-27T02:15:37.000Z&#34;</span>,<span class="s2">&#34;updatedAt&#34;</span>:<span class="s2">&#34;2021-05-27T02:15:37.000Z&#34;</span><span class="o">}</span>,<span class="o">{</span><span class="s2">&#34;id&#34;</span>:16,<span class="s2">&#34;name&#34;</span>:<span class="s2">&#34;Scala&#34;</span>,<span class="s2">&#34;releasedYear&#34;</span>:2004,<span class="s2">&#34;githutRank&#34;</span>:11,<span class="s2">&#34;pyplRank&#34;</span>:17,<span class="s2">&#34;tiobeRank&#34;</span>:34,<span class="s2">&#34;createdAt&#34;</span>:<span class="s2">&#34;2021-05-27T02:15:37.000Z&#34;</span>,<span class="s2">&#34;updatedAt&#34;</span>:<span class="s2">&#34;2021-05-27T02:15:37.000Z&#34;</span><span class="o">}]</span>
</code></pre></td></tr></table>
</div>
</div><a class="post-dummy-target" id="full-example-code"></a><h3>Full Example Code</h3>
<p>You can see my example here</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">https://github.com/piinalpin/learning-kubernetes.git
</code></pre></td></tr></table>
</div>
</div><a class="post-dummy-target" id="thankyou"></a><h3>Thankyou</h3>
<p><a href="https://blog.logrocket.com/node-js-express-js-mysql-rest-api-example/">LogRocket</a> - Node.js, Express.js, and MySQL: A step-by-step REST API example</p>
<p><a href="https://www.sqlshack.com/sql-database-on-kubernetes-considerations-and-best-practices/">SQLHack</a> - SQL Database on Kubernetes: Considerations and Best Practices</p>
<p><a href="https://kubernetes.io/docs/concepts/storage/persistent-volumes/">kubernetes.io</a> - Persistent Volumes</p>
<p><a href="https://kubernetes.io/docs/tasks/configure-pod-container/configure-persistent-volume-storage/">kubernetes.io</a> - Configure a Pod to Use a PersistentVolume for Storage</p>
        </div>

        <div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>This article is updated with 2021-05-28</span>
            </div>
            <div class="post-info-license">
                
            </div>
        </div>
        <div class="post-info-line">
            <div class="post-info-md">
                
                    
                        <span><a class="link-to-markdown" href="https://blog.piinalpin.com/2021/05/why-should-learn-kubernetes-pv-and-pvc/index.md" target="_blank"></a></span>
                    
                
            </div>
            <div class="post-info-share">
                
                    <span>
    
        <a href="//twitter.com/share?url=https%3a%2f%2fblog.piinalpin.com%2f2021%2f05%2fwhy-should-learn-kubernetes-pv-and-pvc%2f&amp;text=Persistent%20Volume%20and%20Persistent%20Volume%20Claim%20in%20Kubernetes&amp;via=piinalpin" target="_blank" title="Share on Twitter">
            <i class="fab fa-twitter fa-fw"></i>
        </a>
    
    
        <a href="//www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fblog.piinalpin.com%2f2021%2f05%2fwhy-should-learn-kubernetes-pv-and-pvc%2f" target="_blank" title="Share on Facebook">
            <i class="fab fa-facebook-square fa-fw"></i>
        </a>
    
    
        <a href="//reddit.com/submit?url=https%3a%2f%2fblog.piinalpin.com%2f2021%2f05%2fwhy-should-learn-kubernetes-pv-and-pvc%2f&amp;title=Persistent%20Volume%20and%20Persistent%20Volume%20Claim%20in%20Kubernetes" target="_blank" title="Share on Reddit">
            <i class="fab fa-reddit fa-fw"></i>
        </a>
    
    
    
    
    
    
    
    
</span>
                
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section>
            
                
                    <span class="tag">
                        <a href="https://blog.piinalpin.com/tags/kubernetes/"><i class="fas fa-tag fa-fw"></i>Kubernetes</a>
                    </span>
                
                    <span class="tag">
                        <a href="https://blog.piinalpin.com/tags/deployment/"><i class="fas fa-tag fa-fw"></i>Deployment</a>
                    </span>
                
                    <span class="tag">
                        <a href="https://blog.piinalpin.com/tags/devops/"><i class="fas fa-tag fa-fw"></i>DevOps</a>
                    </span>
                
                    <span class="tag">
                        <a href="https://blog.piinalpin.com/tags/container/"><i class="fas fa-tag fa-fw"></i>Container</a>
                    </span>
                
                    <span class="tag">
                        <a href="https://blog.piinalpin.com/tags/cluster/"><i class="fas fa-tag fa-fw"></i>Cluster</a>
                    </span>
                
                    <span class="tag">
                        <a href="https://blog.piinalpin.com/tags/nodes/"><i class="fas fa-tag fa-fw"></i>Nodes</a>
                    </span>
                
                    <span class="tag">
                        <a href="https://blog.piinalpin.com/tags/pods/"><i class="fas fa-tag fa-fw"></i>Pods</a>
                    </span>
                
                    <span class="tag">
                        <a href="https://blog.piinalpin.com/tags/k8s/"><i class="fas fa-tag fa-fw"></i>K8s</a>
                    </span>
                
                    <span class="tag">
                        <a href="https://blog.piinalpin.com/tags/cloud-computing/"><i class="fas fa-tag fa-fw"></i>Cloud Computing</a>
                    </span>
                
                    <span class="tag">
                        <a href="https://blog.piinalpin.com/tags/persistence-volume/"><i class="fas fa-tag fa-fw"></i>Persistence Volume</a>
                    </span>
                
                    <span class="tag">
                        <a href="https://blog.piinalpin.com/tags/persistence-volume-claim/"><i class="fas fa-tag fa-fw"></i>Persistence Volume Claim</a>
                    </span>
                
            
        </section>
        <section>
            <span><a href="javascript:window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="https://blog.piinalpin.com/">Home</a></span>
        </section>
    </div>

    <div class="post-nav">
        
            <a href="https://blog.piinalpin.com/2021/05/why-should-learn-kubernetes/" class="prev" rel="prev" title="Learning Kubernetes"><i class="fas fa-angle-left fa-fw"></i>Learning Kubernetes</a>
        
        
    </div>
</div>

        <div class="post-comment">
            
            

            
        </div>
    </article></div>
            </main>
            <footer class="footer">
    <div class="copyright">
        <div class="copyright-line">
            Powered by <a href="https://gohugo.io/" target="_blank" rel="external nofollow noopener noreffer">Hugo</a>&nbsp;|&nbsp;Theme - <a href="https://github.com/dillonzq/LoveIt" target="_blank" rel="external nofollow noopener noreffer">LoveIt<i class="far fa-heart fa-fw"></i></a>
        </div>
        <div class="copyright-line">
            <i class="far fa-copyright fa-fw"></i><span itemprop="copyrightYear">2019 - 2021</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="https://blog.piinalpin.com/">piinalpin</a></span><span class="license">&nbsp;|&nbsp;<a rel="license external nofollow noopener noreffer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span></div>
    </div>
</footer>


    
    




    
    




    
    





    
    



    
    



    
    





    
    





    
    



    
    





    
    




    
    




    
    



    
    





    
    


<script src="/js/lib/jquery/jquery.slim.min.min.js"></script>
<script src="/js/lib/lazysizes/lazysizes.min.min.js"></script>
<script src="/js/lib/smooth-scroll/smooth-scroll.polyfills.min.min.js"></script><script>window.scroll = new SmoothScroll('[data-scroll]', {speed: 300, speedAsDuration: true});</script>


    
    

    

    
        <link rel="stylesheet" href="/css/lib/katex/katex.min.min.css"><script src="/js/lib/katex/katex.min.min.js"></script><script defer src="/js/lib/katex/auto-render.min.min.js" onload="renderMathInElement(document.body);"></script>
    

    

    






<script src="/js/blog.min.js"></script>


    
</div>
        <a href="#" class="dynamic-to-top" id="dynamic-to-top" data-scroll><span>&nbsp;</span></a>
    </body>
</html>