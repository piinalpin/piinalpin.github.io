<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>Learning Kubernetes | PiinAlpin</title><meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="robots" content="noodp" />
<meta name="Description" content="Kubernetes, also known as K8s, is an open-source system for automating deployment, scaling, and management of containerized applications.">
<link rel="prev" href="https://blog.piinalpin.com/2021/05/why-should-learn-docker/" />
<link rel="next" href="https://blog.piinalpin.com/2021/05/why-should-learn-kubernetes-pv-and-pvc/" />
<link rel="canonical" href="https://blog.piinalpin.com/2021/05/why-should-learn-kubernetes/" />
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Learning Kubernetes"/>
<meta name="twitter:description" content="Kubernetes, also known as K8s, is an open-source system for automating deployment, scaling, and management of containerized applications."/>
<script type="application/ld+json">
    {
    "@context": "http://schema.org",
    "@type": "BlogPosting",
    "headline": "Learning Kubernetes",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "https:\/\/blog.piinalpin.com\/2021\/05\/why-should-learn-kubernetes\/"
    },
    
        "image": {
            "@type": "ImageObject",
            "url": "https:\/\/blog.piinalpin.com\/cover.png",
            "width":  800 ,
            "height":  600 
        },
    
    "genre": "posts",
    
        "keywords": "Kubernetes, Deployment, DevOps, Container, Cluster, Nodes, Pods, K8s, Cloud Computing",
    
    "wordcount":  1941 ,
    "url": "https:\/\/blog.piinalpin.com\/2021\/05\/why-should-learn-kubernetes\/",
    
        "datePublished": "2021-05-24T09:19:24\u002b07:00",
    
    
        "dateModified": "2021-05-24T09:19:24\u002b07:00",
    
    
        "license": "This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.",
    
    
        "publisher": {
            "@type": "Organization",
            "name": "Alvinditya Saputra",
            "logo": {
            "@type": "ImageObject",
            "url": "https:\/\/blog.piinalpin.com\/logo.png",
            "width":  127 ,
            "height":  40 
            }
        },
    
    
    "description": "Kubernetes, also known as K8s, is an open-source system for automating deployment, scaling, and management of containerized applications."
    }
    </script>
<link rel="stylesheet" href="/css/style.min.css">
<link rel="stylesheet" href="/css/lib/fontawesome-free/all.min.min.css">

<link rel="stylesheet" href="/css/lib/animate/animate.min.min.css">


<script>
  if('serviceWorker' in navigator) {
      navigator.serviceWorker
          .register('/service-worker.js', { scope: '/' })
          .then(function(registration) {
              
          });

      navigator.serviceWorker
          .ready
          .then(function(registration) {
              
          });
  }
</script>
    </head>
    <body>
        <script>
            window.localStorage.getItem('theme') === 'dark';
            document.body.classList.add('dark-theme');
        </script>
        <div class="wrapper">
            <nav class="navbar">
    <div class="navbar-container">
        <div class="navbar-header animated bounceIn">
            <a href="https://blog.piinalpin.com/">PiinAlpin</a>
        </div>
        <div class="navbar-menu">
            
            
                <a class="menu-item" href="https://blog.piinalpin.com/posts" title="">Posts</a>
            
                <a class="menu-item" href="https://blog.piinalpin.com/tags" title="">Tags</a>
            
                <a class="menu-item" href="https://blog.piinalpin.com/categories" title="">Categories</a>
            
                <a class="menu-item" href="https://blog.piinalpin.com/about" title="">About</a>
            
        </div>
    </div>
</nav>
<nav class="navbar-mobile">
     <div class="navbar-container">
        <div class="navbar-header">
            <div class="navbar-header-title animated bounceIn">
                <a href="https://blog.piinalpin.com/">PiinAlpin</a>
            </div>
            <div class="menu-toggle" id="menu-toggle">
                <span></span><span></span><span></span>
            </div>
        </div>
    </div>
</nav><main class="main">
                <div class="container">
                    
    
    
    

    <article class="post-warp">
        <h1 class="post-title animated flipInX">Learning Kubernetes</h1>

        <div class="post-meta">
            <div class="post-meta-main">
                <a class="author" href="https://blog.piinalpin.com/" rel="author"><i class="fas fa-user-circle fa-fw"></i>piinalpin&nbsp;</a>
                <span class="post-category">
                        included in
                        <i class="far fa-folder fa-fw"></i><a href="https://blog.piinalpin.com/categories/documentation/">Documentation</a>
                            
                    </span>
            </div>
            <div class="post-meta-other">
                <i class="far fa-calendar-alt fa-fw"></i><time datetime=2021-05-24>2021-05-24</time>&nbsp;
                <i class="fas fa-pencil-alt fa-fw"></i>about 1941 words&nbsp;
                <i class="far fa-clock fa-fw"></i>10 min&nbsp;</div>
        </div>

        

        <div class="post-toc" id="post-toc">
                <h2 class="post-toc-title">Table of Contents</h2>
                <div class="post-toc-content">
                    <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#what-is-kubernetes">What is Kubernetes?</a></li>
        <li><a href="#why-we-need-kubernetes">Why we need Kubernetes</a></li>
        <li><a href="#start-using-kubernetes">Start using Kubernetes</a></li>
        <li><a href="#thankyou">Thankyou</a></li>
      </ul>
    </li>
  </ul>
</nav>
                </div>
            </div>
            <div class="post-toc-mobile" id="post-toc-mobile">
                <details>
                    <summary><div class="post-toc-title"><span>Table of Contents</span><span><i class="details icon fas fa-angle-down"></i></span></div></summary>
                    <div class="post-toc-content">
                        
                        
                        <nav id="TableOfContentsMobile">
  <ul>
    <li>
      <ul>
        <li><a href="#what-is-kubernetes">What is Kubernetes?</a></li>
        <li><a href="#why-we-need-kubernetes">Why we need Kubernetes</a></li>
        <li><a href="#start-using-kubernetes">Start using Kubernetes</a></li>
        <li><a href="#thankyou">Thankyou</a></li>
      </ul>
    </li>
  </ul>
</nav>
                    </div>
                </details>
            </div>

        <div class="post-content">
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            <a class="post-dummy-target" id="what-is-kubernetes"></a><h3>What is Kubernetes?</h3>
<p><img src="/images/k8s.svg" alt="Kubernetes"></p>
<p>Kubernetes is a portable, extensible, open-source platform for managing containerized workloads and services, that facilitates both declarative configuration and automation. It has a large, rapidly growing ecosystem. Kubernetes services, support, and tools are widely available.</p>
<p>More information, please follow this link <a href="https://kubernetes.io/docs/concepts/overview/what-is-kubernetes/">Kubernetes Overview</a>.</p>
<a class="post-dummy-target" id="why-we-need-kubernetes"></a><h3>Why we need Kubernetes</h3>
<p>Containers are a good way to bundle and run your applications. In a production environment, you need to manage the containers that run the applications and ensure that there is no downtime. For example, if a container goes down, another container needs to start. Wouldn&rsquo;t it be easier if this behavior was handled by a system?</p>
<p>That&rsquo;s how Kubernetes comes to the rescue! Kubernetes provides you with a framework to run distributed systems resiliently. It takes care of scaling and failover for your application, provides deployment patterns, and more. For example, Kubernetes can easily manage a canary deployment for your system.</p>
<p>Kubernetes can provide with :</p>
<ul>
<li>Service discovery and load balancing</li>
<li>Storage orchestration</li>
<li>Automated rollouts and rollbacks</li>
<li>Automatic bin packing</li>
<li>Self healing</li>
<li>Secret and configuratio management</li>
</ul>
<p>For more information please follow this link <a href="https://kubernetes.io/docs/concepts/overview/what-is-kubernetes/#why-you-need-kubernetes-and-what-can-it-do">Why you Need Kubernetes</a>.</p>
<a class="post-dummy-target" id="start-using-kubernetes"></a><h3>Start using Kubernetes</h3>
<p><strong>Getting Start with Kubernetes on Docker Desktop</strong></p>
<p><a href="https://www.docker.com/products/docker-desktop">Docker Desktop</a> is the easiest way to run Kubernetes on your local machine - it gives you a fully certified Kubernetes cluster and manages all the components for you.</p>
<p>In this lab youâ€™ll learn how to set up Kubernetes on Docker Desktop and run a simple demo app. Youâ€™ll gain experience of working with Kubernetes and comparing the app definition syntax to Docker Compose.</p>
<p>Install Docker Desktop from official website, please follow this link <a href="https://www.docker.com/products/docker-desktop">Install Docker Desktop</a>. Docker Desktop is freely available in a community edition, for Windows and Mac.</p>
<p><strong>Enable Kubernetes</strong></p>
<p><img src="/images/enable-k8s.png" alt="Enable Kubernetes"></p>
<p>Kubernetes itself runs in containers. When you deploy a Kubenetes cluster you first install Docker (or another container runtime like <a href="https://containerd.io">containerd</a>) and then use tools like <a href="https://kubernetes.io/docs/reference/setup-tools/kubeadm/">kubeadm</a> which starts all the Kubernetes components in containers. Docker Desktop does all that for you.</p>
<p><strong>Verify Kubernetes Cluster</strong></p>
<p>If youâ€™ve worked with Docker before, youâ€™re used to managing containers with the <code>docker</code> and <code>docker-compose</code> command lines. Kubernetes uses a different tool called <code>kubectl</code> to manage apps - Docker Desktop installs <code>kubectl</code> for you too.</p>
<p>The cluster can be interacted with using the kubectl CLI. This is the main approach used for managing Kubernetes and the applications running on top of the cluster.</p>
<p>Details of the cluster and its health status is.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">kubectl cluster-info
</code></pre></td></tr></table>
</div>
</div><p>We should get an output</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">Kubernetes control plane is running at https://kubernetes.docker.internal:6443
KubeDNS is running at https://kubernetes.docker.internal:6443/api/v1/namespaces/kube-system/services/kube-dns:dns/proxy

To further debug and diagnose cluster problems, use <span class="s1">&#39;kubectl cluster-info dump&#39;</span>.
</code></pre></td></tr></table>
</div>
</div><p>To view the nodes in the cluster with.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">kubectl get nodes
</code></pre></td></tr></table>
</div>
</div><p>We shoulkd get an output</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">NAME             STATUS   ROLES    AGE     VERSION
docker-desktop   Ready    master   4d22h   v1.19.7
</code></pre></td></tr></table>
</div>
</div><p>If the node is marked as NotReady then it is still starting the components.</p>
<p>This command shows all nodes that can be used to host our applications. Now we have only one node, and we can see that itâ€™s status is ready (it is ready to accept applications for deployment).</p>
<p><strong>Deploy Container</strong></p>
<p>With a running Kubernetes cluster, containers can now be deployed.</p>
<p>Using <code>kubectl run</code>, it allows containers to be deployed onto the cluster.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">kubectl create deployment hello-world --image<span class="o">=</span>piinalpin/sample-node-web-app
</code></pre></td></tr></table>
</div>
</div><p>To check status of the deployment.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">kubectl get pods
</code></pre></td></tr></table>
</div>
</div><p>We should get an output</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">NAME                           READY   STATUS    RESTARTS   AGE
hello-world-6b64556c5b-9pzrp   1/1     Running   <span class="m">0</span>          88s
</code></pre></td></tr></table>
</div>
</div><p>Once the container is running it can be exposed via different networking options, depending on requirements. One possible solution is NodePort, that provides a dynamic port to a container.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">kubectl expose deployment hello-world --port<span class="o">=</span><span class="m">8080</span> --type<span class="o">=</span>NodePort
</code></pre></td></tr></table>
</div>
</div><p>The command below finds the allocated port and executes a HTTP request.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="nb">export</span> <span class="nv">NODE_PORT</span><span class="o">=</span><span class="k">$(</span>kubectl get svc hello-world -o go-template<span class="o">=</span><span class="s1">&#39;{{range.spec.ports}}{{if .nodePort}}{{.nodePort}}{{&#34;\n&#34;}}{{end}}{{end}}&#39;</span><span class="k">)</span> 
<span class="nb">echo</span> <span class="s2">&#34;Accessing http://localhost:</span><span class="nv">$NODE_PORT</span><span class="s2">&#34;</span>  
curl http://localhost:<span class="nv">$NODE_PORT</span>
</code></pre></td></tr></table>
</div>
</div><p>We should get an output</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">{</span><span class="s2">&#34;status&#34;</span>:<span class="s2">&#34;success&#34;</span>,<span class="s2">&#34;message&#34;</span>:<span class="s2">&#34;Hello World! This api from Node.js&#34;</span><span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>Kubernetes Dashboard</strong></p>
<p>Deploy latest kubernetes dashboard, you can deploy the dashboard itself with the following single command.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">kubectl apply -f https://raw.githubusercontent.com/kubernetes/dashboard/v2.0.0/aio/deploy/recommended.yaml   
</code></pre></td></tr></table>
</div>
</div><p>If your cluster is working correctly, you should see an output confirming the creation of a bunch of Kubernetes components like in the example below.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">namespace/kubernetes-dashboard created
serviceaccount/kubernetes-dashboard created
service/kubernetes-dashboard created
secret/kubernetes-dashboard-certs created
secret/kubernetes-dashboard-csrf created
secret/kubernetes-dashboard-key-holder created
configmap/kubernetes-dashboard-settings created
role.rbac.authorization.k8s.io/kubernetes-dashboard created
clusterrole.rbac.authorization.k8s.io/kubernetes-dashboard created
rolebinding.rbac.authorization.k8s.io/kubernetes-dashboard created
clusterrolebinding.rbac.authorization.k8s.io/kubernetes-dashboard created
deployment.apps/kubernetes-dashboard created
service/dashboard-metrics-scraper created
deployment.apps/dashboard-metrics-scraper created
</code></pre></td></tr></table>
</div>
</div><p>Afterwards, you should have two new pods running on your cluster.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">kubectl get pods -A
</code></pre></td></tr></table>
</div>
</div><p>We should get an output</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">NAMESPACE              NAME                                         READY   STATUS    RESTARTS   AGE
...
kubernetes-dashboard   dashboard-metrics-scraper-7b59f7d4df-qkztd   1/1     Running   <span class="m">0</span>          30s
kubernetes-dashboard   kubernetes-dashboard-74d688b6bc-s4595        1/1     Running   <span class="m">0</span>          30s
</code></pre></td></tr></table>
</div>
</div><p>Running <code>kubectl proxy</code> to accessing the dashbooard, then access this link <code>http://localhost:8001/api/v1/namespaces/kubernetes-dashboard/services/https:kubernetes-dashboard:/proxy/</code>.</p>
<p>If we get an output</p>
<p><img src="/images/k8s-dashboard-auth.png" alt="Kubernetes Dashboard Auth"></p>
<p>Get token to access dashboard page and paste on authentication page.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">kubectl get secret -n kubernetes-dashboard <span class="k">$(</span>kubectl get serviceaccount default -n kubernetes-dashboard -o <span class="nv">jsonpath</span><span class="o">=</span><span class="s2">&#34;{.secrets[0].name}&#34;</span><span class="k">)</span> -o <span class="nv">jsonpath</span><span class="o">=</span><span class="s2">&#34;{.data.token}&#34;</span> <span class="p">|</span> base64 --decode
</code></pre></td></tr></table>
</div>
</div><p><img src="/images/k8s-dashboard.png" alt="Kubernetes Dashboard"></p>
<p>Detail information dashboard please follow <a href="https://kubernetes.io/id/docs/tasks/access-application-cluster/web-ui-dashboard/">Kubernetes.io</a></p>
<p>Stopping Kubernetes, by type following script</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">kubectl delete -f https://raw.githubusercontent.com/kubernetes/dashboard/v2.0.0/aio/deploy/recommended.yaml
</code></pre></td></tr></table>
</div>
</div><p>We should get an output</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">namespace <span class="s2">&#34;kubernetes-dashboard&#34;</span> deleted
serviceaccount <span class="s2">&#34;kubernetes-dashboard&#34;</span> deleted
service <span class="s2">&#34;kubernetes-dashboard&#34;</span> deleted
secret <span class="s2">&#34;kubernetes-dashboard-certs&#34;</span> deleted
secret <span class="s2">&#34;kubernetes-dashboard-csrf&#34;</span> deleted
secret <span class="s2">&#34;kubernetes-dashboard-key-holder&#34;</span> deleted
configmap <span class="s2">&#34;kubernetes-dashboard-settings&#34;</span> deleted
role.rbac.authorization.k8s.io <span class="s2">&#34;kubernetes-dashboard&#34;</span> deleted
clusterrole.rbac.authorization.k8s.io <span class="s2">&#34;kubernetes-dashboard&#34;</span> deleted
rolebinding.rbac.authorization.k8s.io <span class="s2">&#34;kubernetes-dashboard&#34;</span> deleted
clusterrolebinding.rbac.authorization.k8s.io <span class="s2">&#34;kubernetes-dashboard&#34;</span> deleted
deployment.apps <span class="s2">&#34;kubernetes-dashboard&#34;</span> deleted
service <span class="s2">&#34;dashboard-metrics-scraper&#34;</span> deleted
deployment.apps <span class="s2">&#34;dashboard-metrics-scraper&#34;</span> deleted
</code></pre></td></tr></table>
</div>
</div><p><strong>Setting Management Script</strong></p>
<p>The steps to deploy or delete the dashboard are not complicated but they can be further simplified.</p>
<p>The following script can be used to start, stop or check the dashboard status.</p>
<p>Create file <code>kubernetes-dashboard.sh</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">nano ~/kubernetes-dashboard.sh
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="cp">#!/bin/bash
</span><span class="cp"></span><span class="nv">showtoken</span><span class="o">=</span><span class="m">1</span>
<span class="nv">cmd</span><span class="o">=</span><span class="s2">&#34;kubectl proxy&#34;</span>
<span class="nv">count</span><span class="o">=</span><span class="sb">`</span>ps aux <span class="p">|</span> grep -v <span class="s2">&#34;grep&#34;</span> <span class="p">|</span> grep -c <span class="s2">&#34;</span><span class="nv">$cmd</span><span class="s2">&#34;</span><span class="sb">`</span>
<span class="nv">dashboard_yaml</span><span class="o">=</span><span class="s2">&#34;https://raw.githubusercontent.com/kubernetes/dashboard/v2.0.0/aio/deploy/recommended.yaml&#34;</span>
<span class="nv">msgstarted</span><span class="o">=</span><span class="s2">&#34;-e Kubernetes Dashboard \e[92mstarted\e[0m&#34;</span>
<span class="nv">msgstopped</span><span class="o">=</span><span class="s2">&#34;Kubernetes Dashboard stopped&#34;</span>

<span class="k">case</span> <span class="nv">$1</span> in
start<span class="o">)</span>
   kubectl apply -f <span class="nv">$dashboard_yaml</span> &gt;/dev/null 2&gt;<span class="p">&amp;</span><span class="m">1</span>

   <span class="k">if</span> <span class="o">[</span> <span class="nv">$count</span> <span class="o">=</span> <span class="m">0</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
      nohup <span class="nv">$cmd</span> &gt;/dev/null 2&gt;<span class="p">&amp;</span><span class="m">1</span> <span class="p">&amp;</span>
      <span class="nb">echo</span> <span class="nv">$msgstarted</span>
   <span class="k">else</span>
      <span class="nb">echo</span> <span class="s2">&#34;Kubernetes Dashboard already running&#34;</span>
   <span class="k">fi</span>
   <span class="p">;;</span>

stop<span class="o">)</span>
   <span class="nv">showtoken</span><span class="o">=</span><span class="m">0</span>
   <span class="k">if</span> <span class="o">[</span> <span class="nv">$count</span> -gt <span class="m">0</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
      <span class="nb">kill</span> -9 <span class="k">$(</span>pgrep -f <span class="s2">&#34;</span><span class="nv">$cmd</span><span class="s2">&#34;</span><span class="k">)</span>
   <span class="k">fi</span>
   kubectl delete -f <span class="nv">$dashboard_yaml</span> &gt;/dev/null 2&gt;<span class="p">&amp;</span><span class="m">1</span>
   <span class="nb">echo</span> <span class="nv">$msgstopped</span>
   <span class="p">;;</span>

status<span class="o">)</span>
   <span class="nv">found</span><span class="o">=</span><span class="sb">`</span>kubectl get serviceaccount default -n kubernetes-dashboard 2&gt;/dev/null<span class="sb">`</span>
   <span class="k">if</span> <span class="o">[[</span> <span class="nv">$count</span> <span class="o">=</span> <span class="m">0</span> <span class="o">]]</span> <span class="o">||</span> <span class="o">[[</span> <span class="nv">$found</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
      <span class="nv">showtoken</span><span class="o">=</span><span class="m">0</span>
      <span class="nb">echo</span> <span class="nv">$msgstopped</span>
   <span class="k">else</span>
      <span class="nv">found</span><span class="o">=</span><span class="sb">`</span>kubectl get clusterrolebinding default -n kubernetes-dashboard 2&gt;/dev/null<span class="sb">`</span>
      <span class="k">if</span> <span class="o">[[</span> <span class="nv">$found</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
         <span class="nv">nopermission</span><span class="o">=</span><span class="s2">&#34; but user has no permissions.&#34;</span>
         <span class="nb">echo</span> <span class="nv">$msgstarted$nopermission</span>
         <span class="nb">echo</span> <span class="s1">&#39;Run &#34;dashboard start&#34; to fix it.&#39;</span>
      <span class="k">else</span>
         <span class="nb">echo</span> <span class="nv">$msgstarted</span>
      <span class="k">fi</span>
   <span class="k">fi</span>
   <span class="p">;;</span>
<span class="k">esac</span>

<span class="c1"># Show full command line # ps -wfC &#34;$cmd&#34;</span>
<span class="k">if</span> <span class="o">[</span> <span class="nv">$showtoken</span> -gt <span class="m">0</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
   <span class="c1"># Show token</span>
   <span class="nb">echo</span> <span class="s2">&#34;Admin token:&#34;</span>
   kubectl get secret -n kubernetes-dashboard <span class="k">$(</span>kubectl get serviceaccount default -n kubernetes-dashboard -o <span class="nv">jsonpath</span><span class="o">=</span><span class="s2">&#34;{.secrets[0].name}&#34;</span><span class="k">)</span> -o <span class="nv">jsonpath</span><span class="o">=</span><span class="s2">&#34;{.data.token}&#34;</span> <span class="p">|</span> base64 --decode
   <span class="nb">echo</span>
   <span class="nb">echo</span> <span class="s2">&#34;Go to:&#34;</span>
   <span class="nb">echo</span> <span class="s2">&#34;http://localhost:8001/api/v1/namespaces/kubernetes-dashboard/services/https:kubernetes-dashboard:/proxy/&#34;</span>
<span class="k">fi</span>
</code></pre></td></tr></table>
</div>
</div><p>Make this script executable</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">chmod +x ~/kubernetes-dashboard.sh
</code></pre></td></tr></table>
</div>
</div><p>Start the dashboard</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">./kubernetes-dashboard.sh start 
</code></pre></td></tr></table>
</div>
</div><p>Check whether the dashboard is running or not and output the tokens if currently set.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">./kubernetes-dashboard.sh status
</code></pre></td></tr></table>
</div>
</div><p>Stop the dashboard</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">./kubernetes-dashboard.sh stop
</code></pre></td></tr></table>
</div>
</div><p><strong>Deploy Container using YAML</strong></p>
<p>Create a kubernetes deployment YAML to tell kubernetes to manage a set of replicas of that Pod â€” literally, a ReplicaSet â€” to make sure that a certain number of them are always available.  So we might start our Kubernetes Deployment manifest definition YAML <code>deployment.yaml</code> like this:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-yaml" data-lang="yaml"><span class="nn">---</span><span class="w">
</span><span class="w"></span><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l">apps/v1</span><span class="w">
</span><span class="w"></span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">Deployment</span><span class="w">
</span><span class="w"></span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">hello-world</span><span class="w">
</span><span class="w">  </span><span class="nt">labels</span><span class="p">:</span><span class="w">
</span><span class="w">    </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l">web</span><span class="w">
</span><span class="w"></span><span class="nt">spec</span><span class="p">:</span><span class="w">
</span><span class="w">  </span><span class="nt">replicas</span><span class="p">:</span><span class="w"> </span><span class="m">3</span><span class="w">
</span><span class="w">  </span><span class="nt">selector</span><span class="p">:</span><span class="w">
</span><span class="w">    </span><span class="nt">matchLabels</span><span class="p">:</span><span class="w">
</span><span class="w">      </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l">web</span><span class="w">
</span><span class="w">  </span><span class="nt">template</span><span class="p">:</span><span class="w">
</span><span class="w">    </span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span><span class="w">      </span><span class="nt">labels</span><span class="p">:</span><span class="w">
</span><span class="w">        </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l">web</span><span class="w">
</span><span class="w">    </span><span class="nt">spec</span><span class="p">:</span><span class="w">
</span><span class="w">      </span><span class="nt">containers</span><span class="p">:</span><span class="w">
</span><span class="w">        </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">hello-world</span><span class="w">
</span><span class="w">          </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">piinalpin/sample-node-web-app</span><span class="w">
</span><span class="w">          </span><span class="nt">ports</span><span class="p">:</span><span class="w">
</span><span class="w">            </span>- <span class="nt">containerPort</span><span class="p">:</span><span class="w"> </span><span class="m">8080</span><span class="w">
</span></code></pre></td></tr></table>
</div>
</div><ul>
<li><code>kubectl</code> create deployment <code>hello-world</code></li>
<li><code>kubectl</code> create 3 replica pods, you can change how many replicas you want</li>
<li><code>kubectl</code> create deployment container from <code>piinalpin/sample-node-web-app</code> images and expose container port <code>8080</code> to master</li>
</ul>
<p>Run YAML file by type following code</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">kubectl apply -f deployment.yaml
</code></pre></td></tr></table>
</div>
</div><p>Check the deployment list</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">kubectl get deployments
</code></pre></td></tr></table>
</div>
</div><p>We should get an output</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">NAME          READY   UP-TO-DATE   AVAILABLE   AGE
hello-world   3/3     <span class="m">3</span>            <span class="m">3</span>           20s
</code></pre></td></tr></table>
</div>
</div><p>Check pods running</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">kubectl get pods
</code></pre></td></tr></table>
</div>
</div><p>We shoul get an output</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">NAME                          READY   STATUS    RESTARTS   AGE
hello-world-f74567869-lsp74   1/1     Running   <span class="m">0</span>          7m7s
hello-world-f74567869-m5vjd   1/1     Running   <span class="m">0</span>          7m7s
hello-world-f74567869-z7pg7   1/1     Running   <span class="m">0</span>          7m7s
</code></pre></td></tr></table>
</div>
</div><p>There are three replicas created from YAML file.</p>
<p><strong>Create Service using YAML</strong></p>
<p>Create expose deployment YAML file <code>service.yaml</code> like this:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-yaml" data-lang="yaml"><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l">v1</span><span class="w">
</span><span class="w"></span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">Service</span><span class="w">
</span><span class="w"></span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">hello-world</span><span class="w">
</span><span class="w">  </span><span class="nt">labels</span><span class="p">:</span><span class="w">
</span><span class="w">    </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l">web</span><span class="w">
</span><span class="w"></span><span class="nt">spec</span><span class="p">:</span><span class="w">
</span><span class="w">  </span><span class="nt">selector</span><span class="p">:</span><span class="w">
</span><span class="w">    </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l">web</span><span class="w">
</span><span class="w">  </span><span class="nt">ports</span><span class="p">:</span><span class="w">
</span><span class="w">    </span>- <span class="nt">protocol</span><span class="p">:</span><span class="w"> </span><span class="l">TCP</span><span class="w">
</span><span class="w">      </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="m">8080</span><span class="w">
</span><span class="w">  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">NodePort</span><span class="w">
</span></code></pre></td></tr></table>
</div>
</div><ul>
<li><code>kubectl</code> create service name <code>hello-world</code></li>
<li><code>kubectl</code> expose deployment which is labeled web</li>
<li><code>kubectl</code> create connection to port <code>8080</code> with type is <code>NodePort</code></li>
</ul>
<p>Execute service YAML file by type following code</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">kubectl apply -f service.yaml
</code></pre></td></tr></table>
</div>
</div><p>Check service is running</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">kubectl get svc
</code></pre></td></tr></table>
</div>
</div><p>We should get and output</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">NAME          TYPE        CLUSTER-IP       EXTERNAL-IP   PORT<span class="o">(</span>S<span class="o">)</span>          AGE
hello-world   NodePort    10.107.135.246   &lt;none&gt;        8080:31302/TCP   8s
kubernetes    ClusterIP   10.96.0.1        &lt;none&gt;        443/TCP          5d2h
</code></pre></td></tr></table>
</div>
</div><p>Check port is exposed and we can execute http request</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">curl http://localhost:&lt;EXPOSED_PORT&gt;
</code></pre></td></tr></table>
</div>
</div><p>We should get an output</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">{</span><span class="s2">&#34;status&#34;</span>:<span class="s2">&#34;success&#34;</span>,<span class="s2">&#34;message&#34;</span>:<span class="s2">&#34;Hello World! This api from Node.js&#34;</span><span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>To delete service and deployment</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">kubectl delete -f deployment.yaml
kubectl delete -f service.yaml
</code></pre></td></tr></table>
</div>
</div><p><strong>Create Deployment and Service on YAML</strong></p>
<p>Create file <code>hello-world.yaml</code> and fill like this:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-yaml" data-lang="yaml"><span class="nn">---</span><span class="w">
</span><span class="w"></span><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l">apps/v1</span><span class="w">
</span><span class="w"></span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">Deployment</span><span class="w">
</span><span class="w"></span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">hello-world</span><span class="w">
</span><span class="w">  </span><span class="nt">labels</span><span class="p">:</span><span class="w">
</span><span class="w">    </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l">web</span><span class="w">
</span><span class="w"></span><span class="nt">spec</span><span class="p">:</span><span class="w">
</span><span class="w">  </span><span class="nt">replicas</span><span class="p">:</span><span class="w"> </span><span class="m">3</span><span class="w">
</span><span class="w">  </span><span class="nt">selector</span><span class="p">:</span><span class="w">
</span><span class="w">    </span><span class="nt">matchLabels</span><span class="p">:</span><span class="w">
</span><span class="w">      </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l">web</span><span class="w">
</span><span class="w">  </span><span class="nt">template</span><span class="p">:</span><span class="w">
</span><span class="w">    </span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span><span class="w">      </span><span class="nt">labels</span><span class="p">:</span><span class="w">
</span><span class="w">        </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l">web</span><span class="w">
</span><span class="w">    </span><span class="nt">spec</span><span class="p">:</span><span class="w">
</span><span class="w">      </span><span class="nt">containers</span><span class="p">:</span><span class="w">
</span><span class="w">        </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">hello-world</span><span class="w">
</span><span class="w">          </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">piinalpin/sample-node-web-app</span><span class="w">
</span><span class="w">          </span><span class="nt">ports</span><span class="p">:</span><span class="w">
</span><span class="w">            </span>- <span class="nt">containerPort</span><span class="p">:</span><span class="w"> </span><span class="m">8080</span><span class="w">
</span><span class="w"></span><span class="nn">---</span><span class="w">
</span><span class="w"></span><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l">v1</span><span class="w">
</span><span class="w"></span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">Service</span><span class="w">
</span><span class="w"></span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">hello-world</span><span class="w">
</span><span class="w">  </span><span class="nt">labels</span><span class="p">:</span><span class="w">
</span><span class="w">    </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l">web</span><span class="w">
</span><span class="w"></span><span class="nt">spec</span><span class="p">:</span><span class="w">
</span><span class="w">  </span><span class="nt">selector</span><span class="p">:</span><span class="w">
</span><span class="w">    </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l">web</span><span class="w">
</span><span class="w">  </span><span class="nt">ports</span><span class="p">:</span><span class="w">
</span><span class="w">    </span>- <span class="nt">protocol</span><span class="p">:</span><span class="w"> </span><span class="l">TCP</span><span class="w">
</span><span class="w">      </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="m">8080</span><span class="w">
</span><span class="w">  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">NodePort</span><span class="w">
</span></code></pre></td></tr></table>
</div>
</div><p>Execute service YAML file by type following code</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">kubectl apply -f hello-world.yaml
</code></pre></td></tr></table>
</div>
</div><p>We should get an output</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">deployment.apps/hello-world created
service/hello-world created
</code></pre></td></tr></table>
</div>
</div><p>Check deployment and service is running</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">kubectl get deployments
kubectl get pods
kubectl get svc
</code></pre></td></tr></table>
</div>
</div><p>Check exposed port with http request</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">curl http://localhost:&lt;EXPOSED_PORT&gt;
</code></pre></td></tr></table>
</div>
</div><p>We should get an output</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">{</span><span class="s2">&#34;status&#34;</span>:<span class="s2">&#34;success&#34;</span>,<span class="s2">&#34;message&#34;</span>:<span class="s2">&#34;Hello World! This api from Node.js&#34;</span><span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>Create Deployment, Service and Ingress with Load Balancer YAML</strong></p>
<p>Create file <code>my-kubernetes.yaml</code> and fill like this:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-yaml" data-lang="yaml"><span class="nn">---</span><span class="w">
</span><span class="w"></span><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l">apps/v1</span><span class="w">
</span><span class="w"></span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">Deployment</span><span class="w">
</span><span class="w"></span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">hello-deployment</span><span class="w">
</span><span class="w">  </span><span class="nt">labels</span><span class="p">:</span><span class="w">
</span><span class="w">    </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l">web</span><span class="w">
</span><span class="w"></span><span class="nt">spec</span><span class="p">:</span><span class="w">
</span><span class="w">  </span><span class="nt">replicas</span><span class="p">:</span><span class="w"> </span><span class="m">3</span><span class="w">
</span><span class="w">  </span><span class="nt">selector</span><span class="p">:</span><span class="w">
</span><span class="w">    </span><span class="nt">matchLabels</span><span class="p">:</span><span class="w">
</span><span class="w">      </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l">web</span><span class="w">
</span><span class="w">  </span><span class="nt">template</span><span class="p">:</span><span class="w">
</span><span class="w">    </span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span><span class="w">      </span><span class="nt">labels</span><span class="p">:</span><span class="w">
</span><span class="w">        </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l">web</span><span class="w">
</span><span class="w">    </span><span class="nt">spec</span><span class="p">:</span><span class="w">
</span><span class="w">      </span><span class="nt">containers</span><span class="p">:</span><span class="w">
</span><span class="w">        </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">hello-world</span><span class="w">
</span><span class="w">          </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">gcr.io/google-samples/hello-app:2.0</span><span class="w">
</span><span class="w">          </span><span class="nt">env</span><span class="p">:</span><span class="w">
</span><span class="w">          </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;PORT&#34;</span><span class="w">
</span><span class="w">            </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;50000&#34;</span><span class="w">
</span><span class="w">        </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">hello-kubernetes</span><span class="w">
</span><span class="w">          </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">piinalpin/sample-node-web-app</span><span class="w">
</span><span class="w">          </span><span class="nt">env</span><span class="p">:</span><span class="w">
</span><span class="w">          </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;PORT&#34;</span><span class="w">
</span><span class="w">            </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;8080&#34;</span><span class="w">
</span><span class="w"></span><span class="nn">---</span><span class="w">
</span><span class="w"></span><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l">v1</span><span class="w">
</span><span class="w"></span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">Service</span><span class="w">
</span><span class="w"></span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">hello-service</span><span class="w">
</span><span class="w">  </span><span class="nt">labels</span><span class="p">:</span><span class="w">
</span><span class="w">    </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l">web</span><span class="w">
</span><span class="w"></span><span class="nt">spec</span><span class="p">:</span><span class="w">
</span><span class="w">  </span><span class="nt">selector</span><span class="p">:</span><span class="w">
</span><span class="w">    </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l">web</span><span class="w">
</span><span class="w">  </span><span class="nt">ports</span><span class="p">:</span><span class="w">
</span><span class="w">    </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">world-port</span><span class="w">
</span><span class="w">      </span><span class="nt">protocol</span><span class="p">:</span><span class="w"> </span><span class="l">TCP</span><span class="w">
</span><span class="w">      </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="m">8001</span><span class="w">
</span><span class="w">      </span><span class="nt">targetPort</span><span class="p">:</span><span class="w"> </span><span class="m">50000</span><span class="w">
</span><span class="w">    </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">kubernetes-port</span><span class="w">
</span><span class="w">      </span><span class="nt">protocol</span><span class="p">:</span><span class="w"> </span><span class="l">TCP</span><span class="w">
</span><span class="w">      </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="m">8002</span><span class="w">
</span><span class="w">      </span><span class="nt">targetPort</span><span class="p">:</span><span class="w"> </span><span class="m">8080</span><span class="w">
</span><span class="w">  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">LoadBalancer</span><span class="w">
</span><span class="w"></span><span class="nn">---</span><span class="w">
</span><span class="w"></span><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l">networking.k8s.io/v1</span><span class="w">
</span><span class="w"></span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">Ingress</span><span class="w">
</span><span class="w"></span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">hello-world</span><span class="w">
</span><span class="w"></span><span class="nt">spec</span><span class="p">:</span><span class="w">
</span><span class="w">  </span><span class="nt">rules</span><span class="p">:</span><span class="w">
</span><span class="w">    </span>- <span class="nt">http</span><span class="p">:</span><span class="w">
</span><span class="w">        </span><span class="nt">paths</span><span class="p">:</span><span class="w">
</span><span class="w">        </span>- <span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l">/hello-world</span><span class="w">
</span><span class="w">          </span><span class="nt">pathType</span><span class="p">:</span><span class="w"> </span><span class="l">Prefix</span><span class="w">
</span><span class="w">          </span><span class="nt">backend</span><span class="p">:</span><span class="w">
</span><span class="w">            </span><span class="nt">service</span><span class="p">:</span><span class="w">
</span><span class="w">              </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">hello-service</span><span class="w">
</span><span class="w">              </span><span class="nt">port</span><span class="p">:</span><span class="w"> 
</span><span class="w">                </span><span class="nt">number</span><span class="p">:</span><span class="w"> </span><span class="m">8001</span><span class="w">
</span><span class="w">        </span>- <span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l">/hello-kubernetes</span><span class="w">
</span><span class="w">          </span><span class="nt">pathType</span><span class="p">:</span><span class="w"> </span><span class="l">Prefix</span><span class="w">
</span><span class="w">          </span><span class="nt">backend</span><span class="p">:</span><span class="w">
</span><span class="w">            </span><span class="nt">service</span><span class="p">:</span><span class="w">
</span><span class="w">              </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">hello-service</span><span class="w">
</span><span class="w">              </span><span class="nt">port</span><span class="p">:</span><span class="w"> 
</span><span class="w">                </span><span class="nt">number</span><span class="p">:</span><span class="w"> </span><span class="m">8002</span><span class="w">
</span></code></pre></td></tr></table>
</div>
</div><ul>
<li><code>kubectl</code> create deployment <code>hello-deployment</code></li>
<li><code>kubectl</code> create 3 replica pods, you can change how many replicas you want</li>
<li><code>kubectl</code> create deployment container from <code>gcr.io/google-samples/hello-app:2.0</code> images and expose container port <code>50000</code> to master</li>
<li><code>kubectl</code> create deployment container from <code>piinalpin/sample-node-web-app</code> images and expose container port <code>8080</code> to master</li>
<li><code>kubectl</code> create service name <code>hello-service</code></li>
<li><code>kubectl</code> expose deployment which is labeled web</li>
<li><code>kubectl</code> create port name <code>world-port</code> expose port <code>50000</code> to <code>8001</code></li>
<li><code>kubectl</code> create port name <code>kubernetes-port</code> expose port <code>8080</code> to <code>8002</code></li>
<li><code>kubectl</code> create type <code>Load Balancer</code></li>
<li><code>kubectl</code> create <code>Ingress</code> named <code>hello-world</code></li>
<li><code>kubectl</code> expose external IP <code>localhost</code></li>
<li><code>kubectl</code> create path <code>/hello-world</code> on port <code>8001</code></li>
<li><code>kubectl</code> create path <code>/hello-kubernetes</code> on port <code>8002</code></li>
</ul>
<a class="post-dummy-target" id="thankyou"></a><h3>Thankyou</h3>
<p><a href="https://birthday.play-with-docker.com/kubernetes-docker-desktop/">Docker Labs</a> - Getting Started with Kubernetes on Docker Desktop</p>
<p><a href="https://kubernetes.io/docs/concepts/overview/what-is-kubernetes/">kubernetes.io</a> - What is Kubernetes?</p>
<p><a href="https://www.katacoda.com/courses/kubernetes/launch-single-node-cluster">KataCoda</a> - Launch Single Node Kubernetes Cluster</p>
<p><a href="https://www.mirantis.com/blog/introduction-to-yaml-creating-a-kubernetes-deployment/">Mirantis</a> - Introduction to YAML: Creating a Kubernetes deployment</p>
<p><a href="https://www.youtube.com/watch?v=7bA0gTroJjw&amp;t=909s">Network Chuck</a> - you need to learn Kubernetes RIGHT NOW!!</p>
<p><a href="https://kubernetes.io/docs/tutorials/stateless-application/expose-external-ip-address/">kubernetes.io</a> - Exposing an External IP Address to Access an Application in a Cluster
<a href="https://upcloud.com/community/tutorials/deploy-kubernetes-dashboard/">UpCloud</a> - How to deploy Kubernetes Dashboard quickly and easily</p>
        </div>

        <div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>This article is updated with 2021-05-24</span>
            </div>
            <div class="post-info-license">
                
            </div>
        </div>
        <div class="post-info-line">
            <div class="post-info-md">
                
                    
                        <span><a class="link-to-markdown" href="https://blog.piinalpin.com/2021/05/why-should-learn-kubernetes/index.md" target="_blank"></a></span>
                    
                
            </div>
            <div class="post-info-share">
                
                    <span>
    
        <a href="//twitter.com/share?url=https%3a%2f%2fblog.piinalpin.com%2f2021%2f05%2fwhy-should-learn-kubernetes%2f&amp;text=Learning%20Kubernetes&amp;via=piinalpin" target="_blank" title="Share on Twitter">
            <i class="fab fa-twitter fa-fw"></i>
        </a>
    
    
        <a href="//www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fblog.piinalpin.com%2f2021%2f05%2fwhy-should-learn-kubernetes%2f" target="_blank" title="Share on Facebook">
            <i class="fab fa-facebook-square fa-fw"></i>
        </a>
    
    
        <a href="//reddit.com/submit?url=https%3a%2f%2fblog.piinalpin.com%2f2021%2f05%2fwhy-should-learn-kubernetes%2f&amp;title=Learning%20Kubernetes" target="_blank" title="Share on Reddit">
            <i class="fab fa-reddit fa-fw"></i>
        </a>
    
    
        <a href="//www.linkedin.com/shareArticle?url=https%3a%2f%2fblog.piinalpin.com%2f2021%2f05%2fwhy-should-learn-kubernetes%2f&amp;title=Learning%20Kubernetes" target="_blank" title="Share on LinkedIn">
            <i class="fab fa-linkedin fa-fw"></i>
        </a>
    
    
    
    
    
    
    
</span>
                
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section>
            
                
                    <span class="tag">
                        <a href="https://blog.piinalpin.com/tags/kubernetes/"><i class="fas fa-tag fa-fw"></i>Kubernetes</a>
                    </span>
                
                    <span class="tag">
                        <a href="https://blog.piinalpin.com/tags/deployment/"><i class="fas fa-tag fa-fw"></i>Deployment</a>
                    </span>
                
                    <span class="tag">
                        <a href="https://blog.piinalpin.com/tags/devops/"><i class="fas fa-tag fa-fw"></i>DevOps</a>
                    </span>
                
                    <span class="tag">
                        <a href="https://blog.piinalpin.com/tags/container/"><i class="fas fa-tag fa-fw"></i>Container</a>
                    </span>
                
                    <span class="tag">
                        <a href="https://blog.piinalpin.com/tags/cluster/"><i class="fas fa-tag fa-fw"></i>Cluster</a>
                    </span>
                
                    <span class="tag">
                        <a href="https://blog.piinalpin.com/tags/nodes/"><i class="fas fa-tag fa-fw"></i>Nodes</a>
                    </span>
                
                    <span class="tag">
                        <a href="https://blog.piinalpin.com/tags/pods/"><i class="fas fa-tag fa-fw"></i>Pods</a>
                    </span>
                
                    <span class="tag">
                        <a href="https://blog.piinalpin.com/tags/k8s/"><i class="fas fa-tag fa-fw"></i>K8s</a>
                    </span>
                
                    <span class="tag">
                        <a href="https://blog.piinalpin.com/tags/cloud-computing/"><i class="fas fa-tag fa-fw"></i>Cloud Computing</a>
                    </span>
                
            
        </section>
        <section>
            <span><a href="javascript:window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="https://blog.piinalpin.com/">Home</a></span>
        </section>
    </div>

    <div class="post-nav">
        
            <a href="https://blog.piinalpin.com/2021/05/why-should-learn-docker/" class="prev" rel="prev" title="Why Should Learn Docker"><i class="fas fa-angle-left fa-fw"></i>Why Should Learn Docker</a>
        
        
            <a href="https://blog.piinalpin.com/2021/05/why-should-learn-kubernetes-pv-and-pvc/" class="next" rel="next" title="Persistent Volume and Persistent Volume Claim in Kubernetes">Persistent Volume and Persistent Volume Claim in Kubernetes<i class="fas fa-angle-right fa-fw"></i></a>
        
    </div>
</div>

        <div class="post-comment">
            
            

            
        </div>
    </article></div>
            </main>
            <footer class="footer">
    <div class="copyright">
        <div class="copyright-line">
            Powered by <a href="https://gohugo.io/" target="_blank" rel="external nofollow noopener noreffer">Hugo</a>&nbsp;|&nbsp;Theme - <a href="https://github.com/dillonzq/LoveIt" target="_blank" rel="external nofollow noopener noreffer">LoveIt<i class="far fa-heart fa-fw"></i></a>
        </div>
        <div class="copyright-line">
            <i class="far fa-copyright fa-fw"></i><span itemprop="copyrightYear">2019 - 2021</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="https://blog.piinalpin.com/">piinalpin</a></span><span class="license">&nbsp;|&nbsp;<a rel="license external nofollow noopener noreffer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span></div>
    </div>
</footer>


    
    




    
    




    
    





    
    



    
    



    
    





    
    





    
    



    
    





    
    




    
    




    
    



    
    





    
    


<script src="/js/lib/jquery/jquery.slim.min.min.js"></script>
<script src="/js/lib/lazysizes/lazysizes.min.min.js"></script>
<script src="/js/lib/smooth-scroll/smooth-scroll.polyfills.min.min.js"></script><script>window.scroll = new SmoothScroll('[data-scroll]', {speed: 300, speedAsDuration: true});</script>


    
    

    

    
        <link rel="stylesheet" href="/css/lib/katex/katex.min.min.css"><script src="/js/lib/katex/katex.min.min.js"></script><script defer src="/js/lib/katex/auto-render.min.min.js" onload="renderMathInElement(document.body);"></script>
    

    

    






<script src="/js/blog.min.js"></script>


    
</div>
        <a href="#" class="dynamic-to-top" id="dynamic-to-top" data-scroll><span>&nbsp;</span></a>
    </body>
</html>